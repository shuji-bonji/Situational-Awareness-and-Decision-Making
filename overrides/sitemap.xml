<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
{%- for file in pages -%}
    {% if not file.page.is_link and (file.page.abs_url or file.page.canonical_url) %}
    <url>
         <loc>{% if file.page.canonical_url %}{{ file.page.canonical_url|e }}{% else %}{{ file.page.abs_url|e }}{% endif %}</loc>
         {%- if file.page.meta is defined and file.page.meta.git_revision_date_localized_raw_iso_datetime is defined %}
         <lastmod>{{ file.page.meta.git_revision_date_localized_raw_iso_datetime[:10] }}</lastmod>
         {%- elif file.page.meta is defined and file.page.meta.git_revision_date_localized is defined %}
         <lastmod>{{ file.page.meta.git_revision_date_localized }}</lastmod>
         {%- elif file.page.update_date %}
         <lastmod>{{ file.page.update_date }}</lastmod>
         {%- endif %}
    </url>
    {%- endif -%}
{% endfor %}
</urlset>