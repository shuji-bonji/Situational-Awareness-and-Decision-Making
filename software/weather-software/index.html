
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="数値気象予報、レーダー解析、警報配信等、気象災害対策を支えるソフトウェアを解説。高頻度データ処理と予測精度向上のための技術実装方法を紹介します。">
      
      
      
        <link rel="canonical" href="https://shuji-bonji.github.io/Situational-Awareness-and-Decision-Making/software/weather-software/">
      
      
        <link rel="prev" href="../maritime-sa-software/">
      
      
        <link rel="next" href="../medical-sa-software/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>気象関連 - 状況認識と意思決定</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/mermaid-dark.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/mermaid-zoom.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/mkdocs_d2_plugin.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  

  <!-- Meta Keywords (minimal usage) -->
  

  <!-- 日本語サイト向けの言語設定 -->
  <meta name="language" content="ja">
  <meta http-equiv="content-language" content="ja">

  <!-- OpenGraph -->
  <meta property="og:title" content="気象関連 - Situational Awareness and Decision Making">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://shuji-bonji.github.io/Situational-Awareness-and-Decision-Making/assets/images/logo.png">
  <meta property="og:site_name" content="状況認識と意思決定">
  <meta property="og:locale" content="ja_JP">
  <meta property="og:url" content="https://shuji-bonji.github.io/Situational-Awareness-and-Decision-Making/software/weather-software/">
  
    <meta property="og:description" content="数値気象予報、レーダー解析、警報配信等、気象災害対策を支えるソフトウェアを解説。高頻度データ処理と予測精度向上のための技術実装方法を紹介します。">
  

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="気象関連 - Situational Awareness and Decision Making">
  
    <meta name="twitter:description" content="数値気象予報、レーダー解析、警報配信等、気象災害対策を支えるソフトウェアを解説。高頻度データ処理と予測精度向上のための技術実装方法を紹介します。">
  
  <meta name="twitter:image" content="https://shuji-bonji.github.io/Situational-Awareness-and-Decision-Making/assets/images/logo.png">

  
  
  
    <meta name="robots" content="index, follow">
  


  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../.." title="状況認識と意思決定" class="md-header__button md-logo" aria-label="状況認識と意思決定" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            状況認識と意思決定
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              気象関連
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  ホーム

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../basics/" class="md-tabs__link">
          
  
  
  基本概念

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../situational-awareness-guide/" class="md-tabs__link">
          
  
  
  状況認識の理論と実践

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../decision-making-guide/" class="md-tabs__link">
          
  
  
  意思決定の理論と実践

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../applications/" class="md-tabs__link">
          
  
  
  応用

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  ソフトウェア

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ai-and-future/" class="md-tabs__link">
          
  
  
  AIと将来展望

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../case-studies/" class="md-tabs__link">
          
  
  
  ケーススタディ

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="状況認識と意思決定" class="md-nav__button md-logo" aria-label="状況認識と意思決定" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    状況認識と意思決定
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ホーム
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    基本概念
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            基本概念
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/what-is-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識とは
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/endsley-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Endsleyの3レベルモデル
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/decision-making/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定とは
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/ooda-loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OODAループ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    状況認識の理論と実践
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            状況認識の理論と実践
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situational-awareness-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situational-awareness-guide/sa-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識の基本アプローチ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situational-awareness-guide/measuring-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識の測定方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situational-awareness-guide/training-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識トレーニング
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    意思決定の理論と実践
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            意思決定の理論と実践
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/decision-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定モデル
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/cognitive-biases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    認知バイアスと意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/uncertainty/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    不確実性下の意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/team-decision-making/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    チーム意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    現代の意思決定手法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            現代の意思決定手法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/ai-enhanced-ooda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI統合OODAループ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/data-driven-decisions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    データ駆動型意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/collaborative-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    協調型状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decision-making-guide/decision-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定トレーニング
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    応用
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            応用
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    航空分野
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            航空分野
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/aviation-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/aviation-dm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    海事・船舶分野
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            海事・船舶分野
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/maritime-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/maritime-dm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    医療分野
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            医療分野
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/medical-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/medical-dm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    緊急対応・危機管理
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            緊急対応・危機管理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/emergency-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/emergency-dm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    軍事・防衛分野
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            軍事・防衛分野
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/military-sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/military-dm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/industrial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    産業・インフラ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/daily-life/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    日常生活
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    ソフトウェア
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            ソフトウェア
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ソフトウェア比較分析
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            ソフトウェア比較分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa-dm-vs-general-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SA/DM系 vs 一般ソフトウェア
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa-vs-dm-systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識 vs 意思決定システム
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" checked>
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    状況認識支援システム
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            状況認識支援システム
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aviation-sa-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    航空関連
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maritime-sa-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    船舶関連
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    気象関連
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    気象関連
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      気象ソフトウェアの特徴
    </span>
  </a>
  
    <nav class="md-nav" aria-label="気象ソフトウェアの特徴">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      システムアーキテクチャ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      数値気象予報システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数値気象予報システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      全球気象予報モデル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      領域気象予報モデル
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      観測・監視システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="観測・監視システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      地上気象観測システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      気象レーダーシステム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      気象衛星システム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      予報・警報配信システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="予報・警報配信システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      気象警報システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      降水短時間予報（ナウキャスト）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ai" class="md-nav__link">
    <span class="md-ellipsis">
      AI・機械学習活用システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AI・機械学習活用システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ai_1" class="md-nav__link">
    <span class="md-ellipsis">
      気象予測AI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai_2" class="md-nav__link">
    <span class="md-ellipsis">
      異常気象検知AI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      専門分野別システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="専門分野別システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      農業気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      エネルギー気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      交通気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      海洋気象システム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      技術トレンドと将来展望
    </span>
  </a>
  
    <nav class="md-nav" aria-label="技術トレンドと将来展望">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      次世代気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      デジタルツイン技術
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      実装時の考慮事項
    </span>
  </a>
  
    <nav class="md-nav" aria-label="実装時の考慮事項">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      データ品質管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      セキュリティ対策
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      国際標準への対応
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      日本の気象ソフトウェア事例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="日本の気象ソフトウェア事例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      国内主要システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      民間気象サービス
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      防災・緊急対応システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="防災・緊急対応システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      統合防災情報システム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iot" class="md-nav__link">
    <span class="md-ellipsis">
      IoT・センサーネットワーク
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IoT・センサーネットワーク">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      分散センサーシステム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      モバイル・個人向けアプリケーション
    </span>
  </a>
  
    <nav class="md-nav" aria-label="モバイル・個人向けアプリケーション">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    <span class="md-ellipsis">
      次世代気象アプリ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    <span class="md-ellipsis">
      まとめ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    <span class="md-ellipsis">
      開発時の重要ポイント
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    <span class="md-ellipsis">
      今後の展望
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    <span class="md-ellipsis">
      関連リンク
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    <span class="md-ellipsis">
      参考文献
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../medical-sa-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    医療関連
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../emergency-sa-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    緊急対応・危機管理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../military-sa-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    軍事
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    意思決定支援システム
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            意思決定支援システム
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aviation-dm-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    航空関連
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    AIと将来展望
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            AIと将来展望
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/ai-sa-context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AIと状況認識
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/new-context-in-sa-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状況認識とAIの新たな文脈
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/ai-dm-context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AIと意思決定
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    AI技術分野別概要
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            AI技術分野別概要
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/machine-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    機械学習・深層学習
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/natural-language-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    自然言語処理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/computer-vision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    コンピュータビジョン
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/predictive-analytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    予測分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/explainable-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    説明可能なAI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/edge-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    エッジAI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-and-future/future-trends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    将来の動向
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ケーススタディ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            ケーススタディ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/haneda-airport-collision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    羽田空港地上衝突事故(2024/1/2)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      気象ソフトウェアの特徴
    </span>
  </a>
  
    <nav class="md-nav" aria-label="気象ソフトウェアの特徴">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      システムアーキテクチャ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      数値気象予報システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数値気象予報システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      全球気象予報モデル
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      領域気象予報モデル
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      観測・監視システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="観測・監視システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      地上気象観測システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      気象レーダーシステム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      気象衛星システム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      予報・警報配信システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="予報・警報配信システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      気象警報システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      降水短時間予報（ナウキャスト）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ai" class="md-nav__link">
    <span class="md-ellipsis">
      AI・機械学習活用システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AI・機械学習活用システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ai_1" class="md-nav__link">
    <span class="md-ellipsis">
      気象予測AI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai_2" class="md-nav__link">
    <span class="md-ellipsis">
      異常気象検知AI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      専門分野別システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="専門分野別システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      農業気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      エネルギー気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      交通気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      海洋気象システム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      技術トレンドと将来展望
    </span>
  </a>
  
    <nav class="md-nav" aria-label="技術トレンドと将来展望">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      次世代気象システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      デジタルツイン技術
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      実装時の考慮事項
    </span>
  </a>
  
    <nav class="md-nav" aria-label="実装時の考慮事項">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      データ品質管理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      セキュリティ対策
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      国際標準への対応
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      日本の気象ソフトウェア事例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="日本の気象ソフトウェア事例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      国内主要システム
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      民間気象サービス
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      防災・緊急対応システム
    </span>
  </a>
  
    <nav class="md-nav" aria-label="防災・緊急対応システム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      統合防災情報システム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iot" class="md-nav__link">
    <span class="md-ellipsis">
      IoT・センサーネットワーク
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IoT・センサーネットワーク">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      分散センサーシステム
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      モバイル・個人向けアプリケーション
    </span>
  </a>
  
    <nav class="md-nav" aria-label="モバイル・個人向けアプリケーション">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    <span class="md-ellipsis">
      次世代気象アプリ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    <span class="md-ellipsis">
      まとめ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    <span class="md-ellipsis">
      開発時の重要ポイント
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    <span class="md-ellipsis">
      今後の展望
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    <span class="md-ellipsis">
      関連リンク
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    <span class="md-ellipsis">
      参考文献
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="_1">気象関連ソフトウェア<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">このページについて</p>
<p>このページでは、気象分野で使用される状況認識支援ソフトウェアについて詳しく解説します。数値気象予報システムから観測・監視システム、気象情報配信、災害警報まで、気象現象の理解と予測、緊急時の意思決定を支える様々なソフトウェアソリューションを紹介します。</p>
</div>
<h2 id="_2">気象ソフトウェアの特徴<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>気象・防災分野のソフトウェアは、極めて高いリアルタイム性・正確性・冗長性・データ統合性が求められます。以下はその主要要件と技術的背景、メリットです。</p>
<table>
<thead>
<tr>
<th>要件</th>
<th>説明</th>
<th>技術背景・実装</th>
<th>具体例・メリット</th>
</tr>
</thead>
<tbody>
<tr>
<td>高頻度データ処理</td>
<td>分単位～秒単位で大量の観測・予測データをリアルタイムに処理</td>
<td>ストリーミング処理（Kafka, Spark Streaming等）、<br>分散並列処理（HPC/クラウド）、<br>インメモリDB</td>
<td>レーダー5分更新解析で降水急変や竜巻を即検知、避難判断時間を大幅確保</td>
</tr>
<tr>
<td>予測精度</td>
<td>物理モデル・統計解析・AIを組み合わせ高精度予測</td>
<td>数値気象モデル（GSM, IFS等）、<br>アンサンブル予報、<br>深層学習後処理</td>
<td>台風進路や豪雨の精度向上で計画的な避難・減災対策が可能に</td>
</tr>
<tr>
<td>24時間監視</td>
<td>365日24時間の連続監視・自動運用</td>
<td>システム冗長化、<br>監視自動化（監視エージェント）、<br>障害自動復旧</td>
<td>夜間の突発災害も自動で警報発出、ダウンタイム最小化</td>
</tr>
<tr>
<td>多様なデータ統合</td>
<td>衛星・レーダー・地上・船舶・航空機等、多様な観測データを統合処理</td>
<td>データフュージョン、<br>品質管理（QC）、<br>標準フォーマット（NetCDF, BUFR等）</td>
<td>複数観測の融合で局地現象を高精度に監視、盲点の低減</td>
</tr>
</tbody>
</table>
<h3 id="_3">システムアーキテクチャ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>下図は気象ソフトウェアにおける情報処理の全体像です。各要素の役割を簡潔に説明します。</p>
<h4 id="_4">気象データ処理の統合システム<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>graph TD
    A[観測データ源] --&gt; B[データ収集・品質管理]
    B --&gt; C[数値モデル・解析]
    C --&gt; D[予報・警報生成]
    D --&gt; E[配信・可視化]

    A --&gt; A1[気象観測所]
    A --&gt; A2[気象レーダー]
    A --&gt; A3[気象衛星]
    A --&gt; A4[海洋ブイ・船舶]

    B --&gt; B1[データ品質管理]
    B --&gt; B2[データ同化]
    B --&gt; B3[統計処理]

    C --&gt; C1[全球モデル]
    C --&gt; C2[領域モデル]
    C --&gt; C3[アンサンブル予報]

    D --&gt; D1[短期予報]
    D --&gt; D2[警報・注意報]
    D --&gt; D3[特別警報]

    E --&gt; E1[一般向け配信]
    E --&gt; E2[防災機関向け]
    E --&gt; E3[専門機関向け]



</code></pre>
<h4 id="_5">各要素の役割<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>構成</th>
<th>役割</th>
<th>実例</th>
</tr>
</thead>
<tbody>
<tr>
<td>観測データ源</td>
<td>地上・レーダー・衛星・船舶・航空機など多様な観測データの取得</td>
<td>アメダス、気象レーダー、ひまわり衛星、ブイ観測</td>
</tr>
<tr>
<td>データ収集・品質管理</td>
<td>データの自動収集・異常値検出・欠測補完・同化（解析への統合）</td>
<td>QC処理、データ同化、統計的補正</td>
</tr>
<tr>
<td>数値モデル・解析</td>
<td>物理モデルやAIで大気の未来を計算（全球・領域・アンサンブル）</td>
<td>GSM, MSM, IFS, WRF, アンサンブル予報</td>
</tr>
<tr>
<td>予報・警報生成</td>
<td>解析結果から自動で予報文・警報を作成、専門家による最終チェックも</td>
<td>台風進路予測、豪雨警報、短期/長期予報</td>
</tr>
<tr>
<td>配信・可視化</td>
<td>一般・防災・専門機関向けに情報配信・可視化</td>
<td>天気アプリ、防災行政、農業・エネルギー向けAPI</td>
</tr>
</tbody>
</table>
<h2 id="_6">数値気象予報システム<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="_7">全球気象予報モデル<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<h4 id="ecmwf-ifs">ECMWF IFS（統合予報システム）<a class="headerlink" href="#ecmwf-ifs" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>機能</th>
<th>説明</th>
<th>技術仕様・強み</th>
</tr>
</thead>
<tbody>
<tr>
<td>全球数値予報</td>
<td>世界最高レベルの中期（3～10日）予報精度を誇る物理モデル</td>
<td>水平解像度9km、予報期間15日、詳細な大気・海洋・陸面結合モデル</td>
</tr>
<tr>
<td>アンサンブル予報</td>
<td>51メンバーによる確率的予報で不確実性や極端現象を定量化</td>
<td>台風進路や豪雨の発生確率推定が可能</td>
</tr>
<tr>
<td>季節予報</td>
<td>1ヶ月～1年先の気候傾向予報</td>
<td>海洋・雪氷結合、長期変動も考慮</td>
</tr>
<tr>
<td>データ同化</td>
<td>4次元変分法（4D-Var）など高度な観測データ統合</td>
<td>観測網の情報を最大限活用し初期値精度を向上</td>
</tr>
</tbody>
</table>
<h5 id="_8">技術的背景・メリット・導入例<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>ポイント</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>台風進路予測</td>
<td>IFSは台風進路・強度予測に強み。アンサンブルで進路幅や不確実性も算出し、航空・海運・防災で活用</td>
</tr>
<tr>
<td>アンサンブル予報</td>
<td>予測のばらつきを確率化し、「極端現象の発生リスク」を数値で提供。意思決定の根拠強化</td>
</tr>
<tr>
<td>国際比較</td>
<td>気象庁GSM・米国GFS等と定期比較され、WMOの基準モデルでもある</td>
</tr>
<tr>
<td>導入事例</td>
<td>気象庁週間予報、国際航空・船舶運航、欧州各国の防災計画など</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<p>この TypeScript 実装では、ECMWF IFS のデータを取得し、解析を行っています。
グリッドデータのダウンロード、台風進路予測、確率分布の計算などを通じて、気象予報の精度向上を目指しています。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// ECMWF APIクライアントの実装例</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">ECMWFGribData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">step</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">levtype</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">param</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">area?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w"> </span><span class="c1">// North/West/South/East</span>
<span class="w">  </span><span class="nx">grid?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w"> </span><span class="c1">// lat/lon resolution</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">ECMWFClient</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://api.ecmwf.int/v1&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">apiKey</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">apiKey</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">apiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">apiKey</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">retrieveForecast</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">ECMWFGribData</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nb">ArrayBuffer</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="si">}</span><span class="sb">/services/mars/requests`</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;Authorization&#39;</span><span class="o">:</span><span class="w"> </span><span class="sb">`Bearer </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">apiKey</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span>
<span class="w">        </span><span class="kd">class</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;od&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fc&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">stream</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;oper&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="p">...</span><span class="nx">request</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`ECMWF API error: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">arrayBuffer</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// アンサンブル予報データの取得</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">getEnsembleForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">parameter</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">,</span>
<span class="w">    </span><span class="nx">area</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="kt">number</span><span class="p">]</span><span class="w"> </span><span class="c1">// N/W/S/E</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">EnsembleForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ensembleMembers</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastData</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 51メンバーのアンサンブル予報を取得</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">member</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">member</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">50</span><span class="p">;</span><span class="w"> </span><span class="nx">member</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">gribData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">retrieveForecast</span><span class="p">({</span>
<span class="w">        </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">date.toISOString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span>
<span class="w">        </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">step</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;24/to/240/by/24&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">levtype</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;sfc&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">param</span><span class="o">:</span><span class="w"> </span><span class="kt">parameter</span><span class="p">,</span>
<span class="w">        </span><span class="nx">area</span><span class="p">,</span>
<span class="w">        </span><span class="nx">grid</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">],</span><span class="w"> </span><span class="c1">// 0.1度格子</span>
<span class="w">        </span><span class="kt">number</span><span class="o">:</span><span class="w"> </span><span class="nx">member</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="nx">ensembleMembers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">parseGribData</span><span class="p">(</span><span class="nx">gribData</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEnsembleStatistics</span><span class="p">(</span><span class="nx">ensembleMembers</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">parseGribData</span><span class="p">(</span><span class="nx">gribBuffer</span><span class="o">:</span><span class="w"> </span><span class="kt">ArrayBuffer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ForecastData</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// GRIB2データの解析</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">decoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">GribDecoder</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">decoder</span><span class="p">.</span><span class="nx">decode</span><span class="p">(</span><span class="nx">gribBuffer</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// アンサンブル統計の計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateEnsembleStatistics</span><span class="p">(</span><span class="nx">members</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastData</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">EnsembleForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">gridPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">members</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="nx">gridPoints</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="nx">gridPoints</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">probability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float32Array</span><span class="p">(</span><span class="nx">gridPoints</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 各格子点での統計計算</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">gridPoints</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">members</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">m</span><span class="p">.</span><span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>

<span class="w">      </span><span class="c1">// 平均</span>
<span class="w">      </span><span class="nx">mean</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 標準偏差</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">v</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">mean</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">      </span><span class="nx">std</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">variance</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 閾値を超える確率（例：降水1mm以上）</span>
<span class="w">      </span><span class="nx">probability</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">v</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">ensembleMean</span><span class="o">:</span><span class="w"> </span><span class="kt">mean</span><span class="p">,</span>
<span class="w">      </span><span class="nx">ensembleSpread</span><span class="o">:</span><span class="w"> </span><span class="kt">std</span><span class="p">,</span>
<span class="w">      </span><span class="nx">probability</span><span class="p">,</span>
<span class="w">      </span><span class="nx">members</span><span class="o">:</span><span class="w"> </span><span class="kt">members.length</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ForecastData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">values</span><span class="o">:</span><span class="w"> </span><span class="kt">Float32Array</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">parameter</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">validTime</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">    </span><span class="nx">grid</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[],</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">EnsembleForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">ensembleMean</span><span class="o">:</span><span class="w"> </span><span class="kt">Float32Array</span><span class="p">;</span>
<span class="w">  </span><span class="nx">ensembleSpread</span><span class="o">:</span><span class="w"> </span><span class="kt">Float32Array</span><span class="p">;</span>
<span class="w">  </span><span class="nx">probability</span><span class="o">:</span><span class="w"> </span><span class="kt">Float32Array</span><span class="p">;</span>
<span class="w">  </span><span class="nx">members</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 台風進路予測システム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">TyphoonTrackForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">models</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">WeatherModel</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;ECMWF&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ECMWFModel</span><span class="p">());</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;GFS&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">GFSModel</span><span class="p">());</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;JMA&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">JMAModel</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 複数モデルによる台風進路予測</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">predictTyphoonTrack</span><span class="p">(</span>
<span class="w">    </span><span class="nx">typhoonId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">currentPosition</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="nx">forecastHours</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">120</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">TyphoonForecast</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">TyphoonForecast</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">modelName</span><span class="p">,</span><span class="w"> </span><span class="nx">model</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">trackForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">model</span><span class="p">.</span><span class="nx">getTyphoonTrack</span><span class="p">(</span>
<span class="w">          </span><span class="nx">typhoonId</span><span class="p">,</span>
<span class="w">          </span><span class="nx">currentPosition</span><span class="p">,</span>
<span class="w">          </span><span class="nx">forecastHours</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="kt">modelName</span><span class="p">,</span>
<span class="w">          </span><span class="nx">track</span><span class="o">:</span><span class="w"> </span><span class="kt">trackForecast</span><span class="p">,</span>
<span class="w">          </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateConfidence</span><span class="p">(</span><span class="nx">trackForecast</span><span class="p">),</span>
<span class="w">          </span><span class="nx">lastUpdate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">()</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Failed to get forecast from </span><span class="si">${</span><span class="nx">modelName</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateConsensusTrack</span><span class="p">(</span><span class="nx">forecasts</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// コンセンサス進路の生成</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">generateConsensusTrack</span><span class="p">(</span><span class="nx">forecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">TyphoonForecast</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">TyphoonForecast</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecastHours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecasts</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">track</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">consensusTrack</span><span class="o">:</span><span class="w"> </span><span class="kt">TyphoonTrackPoint</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 各予報時刻でのコンセンサス計算</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">forecastHours</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">positions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">f</span><span class="p">.</span><span class="nx">track</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">avgLat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">avgLon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">longitude</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">avgPressure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">centralPressure</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

<span class="w">        </span><span class="nx">consensusTrack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kt">positions</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">time</span><span class="p">,</span>
<span class="w">          </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">avgLat</span><span class="p">,</span>
<span class="w">          </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">avgLon</span><span class="p">,</span>
<span class="w">          </span><span class="nx">centralPressure</span><span class="o">:</span><span class="w"> </span><span class="kt">avgPressure</span><span class="p">,</span>
<span class="w">          </span><span class="nx">maxWindSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.max</span><span class="p">(...</span><span class="nx">positions</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">maxWindSpeed</span><span class="p">)),</span>
<span class="w">          </span><span class="nx">uncertainty</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePositionUncertainty</span><span class="p">(</span><span class="nx">positions</span><span class="p">)</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[{</span>
<span class="w">      </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CONSENSUS&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">track</span><span class="o">:</span><span class="w"> </span><span class="kt">consensusTrack</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateEnsembleConfidence</span><span class="p">(</span><span class="nx">forecasts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">lastUpdate</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">()</span>
<span class="w">    </span><span class="p">}];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculatePositionUncertainty</span><span class="p">(</span><span class="nx">positions</span><span class="o">:</span><span class="w"> </span><span class="kt">TyphoonTrackPoint</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 標準偏差を計算（km単位）</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">avgLat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">avgLon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">longitude</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">distances</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">positions</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateDistance</span><span class="p">(</span><span class="nx">avgLat</span><span class="p">,</span><span class="w"> </span><span class="nx">avgLon</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">longitude</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">distances</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">d</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">distances</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">variance</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateDistance</span><span class="p">(</span><span class="nx">lat1</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">lon1</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">lat2</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">lon2</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6371</span><span class="p">;</span><span class="w"> </span><span class="c1">// 地球の半径 (km)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dLat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">lat2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">lat1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dLon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">lon2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">lon1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">dLat</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">dLat</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">lat1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">lat2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">              </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">dLon</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">dLon</span><span class="o">/</span><span class="mf">2</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">atan2</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="nx">a</span><span class="p">));</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">R</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">c</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TyphoonTrackPoint</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">centralPressure</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// hPa</span>
<span class="w">  </span><span class="nx">maxWindSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">uncertainty?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// km</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TyphoonForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">track</span><span class="o">:</span><span class="w"> </span><span class="kt">TyphoonTrackPoint</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">lastUpdate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h4 id="jma-gsm">JMA-GSM（全球スペクトルモデル）<a class="headerlink" href="#jma-gsm" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>機能</th>
<th>説明</th>
<th>技術的特徴・強み</th>
</tr>
</thead>
<tbody>
<tr>
<td>日本域詳細予報</td>
<td>日本・アジア太平洋域向けに高解像度で予報</td>
<td>水平解像度20km、日本付近の地形・海岸線を詳細に反映</td>
</tr>
<tr>
<td>台風予報</td>
<td>西太平洋～日本への台風進路・強度予測に特化</td>
<td>日本特有の気象現象（梅雨・冬型）にも最適化</td>
</tr>
<tr>
<td>季節・梅雨予報</td>
<td>東アジアの季節現象や梅雨前線位置を高精度予測</td>
<td>地域特有の現象に強い</td>
</tr>
</tbody>
</table>
<h5 id="_9">技術的背景・メリット・導入例<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>ポイント</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>精度</td>
<td>日本周辺の予報精度が極めて高い。地形・海岸線・局地現象に強い</td>
</tr>
<tr>
<td>台風・豪雨対策</td>
<td>台風進路予測・警報発表の基礎。自治体の避難判断や防災計画に不可欠</td>
</tr>
<tr>
<td>比較</td>
<td>ECMWF IFSと比較しつつ、日本域の詳細予報や短期警報に最適化</td>
</tr>
<tr>
<td>導入事例</td>
<td>気象庁の府県予報、警報・注意報、台風情報、消防・自治体の判断支援</td>
</tr>
</tbody>
</table>
<h3 id="_10">領域気象予報モデル<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<h4 id="wrfweather-research-and-forecasting-model">WRF（Weather Research and Forecasting Model）<a class="headerlink" href="#wrfweather-research-and-forecasting-model" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>用途</th>
<th>技術的特徴</th>
<th>導入事例</th>
</tr>
</thead>
<tbody>
<tr>
<td>研究・民間・自治体の局地気象予報</td>
<td>オープンソースで領域・物理過程を柔軟に設定可。高解像度（1km以下）で都市・山岳・沿岸など細密な予報が可能</td>
<td>大学の都市気象・山岳気象研究、風力発電サイトの風況予測、自治体の局地豪雨・土砂災害対策</td>
</tr>
</tbody>
</table>
<h5 id="_11">技術背景・強み<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<ul>
<li>多様な物理・地表面スキームを選択できるため、都市・農業・災害・エネルギーなど分野ごとに最適化が可能</li>
<li>世界中の研究機関・民間気象会社で広く導入</li>
<li>アンサンブルやAIと組み合わせた高度な予報も実装可能</li>
</ul>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<p>この TypeScript 実装では、WRF（Weather Research and Forecasting Model）の設定生成と実行管理を行います。
各地域の高解像度な天気予報のシミュレーションを可能にし、都市・農業・防災向けの精密な気象データを提供します。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// WRF設定ファイルの生成と実行管理</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">WRFNamelist</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timeDomain</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">startYear</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">startMonth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">startDay</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">startHour</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">endYear</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">endMonth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">endDay</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">endHour</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">intervalSeconds</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">domains</span><span class="o">:</span><span class="w"> </span><span class="kt">WRFDomain</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">physics</span><span class="o">:</span><span class="w"> </span><span class="kt">WRFPhysics</span><span class="p">;</span>
<span class="w">  </span><span class="nx">dynamics</span><span class="o">:</span><span class="w"> </span><span class="kt">WRFDynamics</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WRFDomain</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">parentId</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">parentRatio</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">iParentStart</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">jParentStart</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">eWE</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// x方向の格子数</span>
<span class="w">  </span><span class="nx">eSN</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// y方向の格子数</span>
<span class="w">  </span><span class="nx">eVert</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 鉛直方向の格子数</span>
<span class="w">  </span><span class="nx">dx</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// x方向の格子間隔 (m)</span>
<span class="w">  </span><span class="nx">dy</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// y方向の格子間隔 (m)</span>
<span class="w">  </span><span class="nx">mapProj</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// 地図投影法</span>
<span class="w">  </span><span class="nx">refLat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">refLon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">truelat1</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">truelat2</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">standLon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WRFPhysics</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">microphysics</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 雲物理過程</span>
<span class="w">  </span><span class="nx">convection</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 積雲対流パラメタリゼーション</span>
<span class="w">  </span><span class="nx">pbl</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 境界層スキーム</span>
<span class="w">  </span><span class="nx">surface</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 地表面スキーム</span>
<span class="w">  </span><span class="nx">radiation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">longwave</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">shortwave</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WRFDynamics</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timeStep</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 積分時間間隔</span>
<span class="w">  </span><span class="nx">epssm</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 数値安定化フィルター強度</span>
<span class="w">  </span><span class="nx">nonHydrostatic</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w"> </span><span class="c1">// 非静力学近似</span>
<span class="w">  </span><span class="nx">moistAdv</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 水蒸気移流スキーム</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">WRFModelManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">configPath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">workingDirectory</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">isRunning</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">workingDir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">workingDirectory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">workingDir</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">configPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">workingDir</span><span class="si">}</span><span class="sb">/namelist.wps`</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// WPS（前処理）の設定生成</span>
<span class="w">  </span><span class="nx">generateWPSNamelist</span><span class="p">(</span><span class="nx">domain</span><span class="o">:</span><span class="w"> </span><span class="kt">WRFDomain</span><span class="p">,</span><span class="w"> </span><span class="nx">startDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">,</span><span class="w"> </span><span class="nx">endDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">namelistContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">&amp;share</span>
<span class="sb">wrf_core = &#39;ARW&#39;,</span>
<span class="sb">max_dom = 1,</span>
<span class="sb">start_date = &#39;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">startDate</span><span class="p">)</span><span class="si">}</span><span class="sb">&#39;,</span>
<span class="sb">end_date = &#39;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">endDate</span><span class="p">)</span><span class="si">}</span><span class="sb">&#39;,</span>
<span class="sb">interval_seconds = 21600,</span>
<span class="sb">io_form_geogrid = 2,</span>
<span class="sb">/</span>

<span class="sb">&amp;geogrid</span>
<span class="sb">parent_id = 1,</span>
<span class="sb">parent_grid_ratio = 1,</span>
<span class="sb">i_parent_start = 1,</span>
<span class="sb">j_parent_start = 1,</span>
<span class="sb">e_we = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">eWE</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">e_sn = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">eSN</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">dx = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">dx</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">dy = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">dy</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">map_proj = &#39;</span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">mapProj</span><span class="si">}</span><span class="sb">&#39;,</span>
<span class="sb">ref_lat = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">refLat</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">ref_lon = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">refLon</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">truelat1 = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">truelat1</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">truelat2 = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">truelat2</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">stand_lon = </span><span class="si">${</span><span class="nx">domain</span><span class="p">.</span><span class="nx">standLon</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">geog_data_path = &#39;/path/to/geog/&#39;</span>
<span class="sb">/</span>

<span class="sb">&amp;ungrib</span>
<span class="sb">out_format = &#39;WPS&#39;,</span>
<span class="sb">prefix = &#39;FILE&#39;,</span>
<span class="sb">/</span>

<span class="sb">&amp;metgrid</span>
<span class="sb">fg_name = &#39;FILE&#39;,</span>
<span class="sb">io_form_metgrid = 2,</span>
<span class="sb">/</span>
<span class="sb">    `</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">namelistContent</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// WRF本体の設定生成（詳細な物理過程設定）</span>
<span class="w">  </span><span class="nx">generateWRFNamelist</span><span class="p">(</span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="kt">WRFNamelist</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">startDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startYear</span><span class="p">,</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startMonth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startDay</span><span class="p">,</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startHour</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">endDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endYear</span><span class="p">,</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endMonth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endDay</span><span class="p">,</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endHour</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">runHours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">endDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="p">));</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">namelistContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">&amp;time_control</span>
<span class="sb">run_days = 0,</span>
<span class="sb">run_hours = </span><span class="si">${</span><span class="nx">runHours</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">run_minutes = 0,</span>
<span class="sb">run_seconds = 0,</span>
<span class="sb">start_year = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startYear</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">start_month = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startMonth</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">start_day = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startDay</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">start_hour = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">startHour</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">start_minute = 0,</span>
<span class="sb">start_second = 0,</span>
<span class="sb">end_year = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endYear</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">end_month = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endMonth</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">end_day = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endDay</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">end_hour = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">endHour</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">end_minute = 0,</span>
<span class="sb">end_second = 0,</span>
<span class="sb">interval_seconds = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">timeDomain</span><span class="p">.</span><span class="nx">intervalSeconds</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">input_from_file = .true.,</span>
<span class="sb">history_interval = 60,</span>
<span class="sb">frames_per_outfile = 1,</span>
<span class="sb">restart = .false.,</span>
<span class="sb">restart_interval = 5000,</span>
<span class="sb">io_form_history = 2,</span>
<span class="sb">io_form_restart = 2,</span>
<span class="sb">io_form_input = 2,</span>
<span class="sb">io_form_boundary = 2,</span>
<span class="sb">debug_level = 0,</span>
<span class="sb">/</span>

<span class="sb">&amp;domains</span>
<span class="sb">time_step = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">dynamics</span><span class="p">.</span><span class="nx">timeStep</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">time_step_fract_num = 0,</span>
<span class="sb">time_step_fract_den = 1,</span>
<span class="sb">max_dom = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">e_we = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">eWE</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">e_sn = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">eSN</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">e_vert = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">eVert</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">p_top_requested = 5000,</span>
<span class="sb">num_metgrid_levels = 40,</span>
<span class="sb">num_metgrid_soil_levels = 4,</span>
<span class="sb">dx = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dx</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">dy = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">dy</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">grid_id = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">parent_id = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">parentId</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">i_parent_start = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">iParentStart</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">j_parent_start = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">jParentStart</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">parent_grid_ratio = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">parentRatio</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">parent_time_step_ratio = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">domains</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">d</span><span class="p">.</span><span class="nx">parentRatio</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">feedback = 1,</span>
<span class="sb">smooth_option = 0,</span>
<span class="sb">/</span>

<span class="sb">&amp;physics</span>
<span class="sb">mp_physics = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">microphysics</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">ra_lw_physics = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">radiation</span><span class="p">.</span><span class="nx">longwave</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">ra_sw_physics = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">radiation</span><span class="p">.</span><span class="nx">shortwave</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">radt = 30,</span>
<span class="sb">sf_sfclay_physics = 1,</span>
<span class="sb">sf_surface_physics = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">surface</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">bl_pbl_physics = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">pbl</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">bldt = 0,</span>
<span class="sb">cu_physics = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">convection</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">cudt = 5,</span>
<span class="sb">isfflx = 1,</span>
<span class="sb">ifsnow = 1,</span>
<span class="sb">icloud = 1,</span>
<span class="sb">surface_input_source = 1,</span>
<span class="sb">num_soil_layers = 4,</span>
<span class="sb">sf_urban_physics = 0,</span>
<span class="sb">/</span>

<span class="sb">&amp;fdda</span>
<span class="sb">/</span>

<span class="sb">&amp;dynamics</span>
<span class="sb">w_damping = 0,</span>
<span class="sb">diff_opt = 1,</span>
<span class="sb">km_opt = 4,</span>
<span class="sb">diff_6th_opt = 0,</span>
<span class="sb">diff_6th_factor = 0.12,</span>
<span class="sb">base_temp = 290.,</span>
<span class="sb">damp_opt = 0,</span>
<span class="sb">zdamp = 5000.,</span>
<span class="sb">dampcoef = 0.2,</span>
<span class="sb">khdif = 0,</span>
<span class="sb">kvdif = 0,</span>
<span class="sb">non_hydrostatic = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">dynamics</span><span class="p">.</span><span class="nx">nonHydrostatic</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;.true.&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;.false.&#39;</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">moist_adv_opt = </span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">dynamics</span><span class="p">.</span><span class="nx">moistAdv</span><span class="si">}</span><span class="sb">,</span>
<span class="sb">scalar_adv_opt = 1,</span>
<span class="sb">/</span>

<span class="sb">&amp;bdy_control</span>
<span class="sb">spec_bdy_width = 5,</span>
<span class="sb">spec_zone = 1,</span>
<span class="sb">relax_zone = 4,</span>
<span class="sb">specified = .true.,</span>
<span class="sb">nested = .false.,</span>
<span class="sb">/</span>

<span class="sb">&amp;grib2</span>
<span class="sb">/</span>

<span class="sb">&amp;namelist_quilt</span>
<span class="sb">nio_tasks_per_group = 0,</span>
<span class="sb">nio_groups = 1,</span>
<span class="sb">/</span>
<span class="sb">    `</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">namelistContent</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// WRF実行の管理</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">runWRF</span><span class="p">(</span><span class="nx">namelist</span><span class="o">:</span><span class="w"> </span><span class="kt">WRFNamelist</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WRFRunResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isRunning</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;WRF is already running&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">isRunning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 設定ファイル出力</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">writeNamelistFile</span><span class="p">(</span><span class="nx">namelist</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 前処理実行（WPS）</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="s1">&#39;geogrid.exe&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="s1">&#39;ungrib.exe&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="s1">&#39;metgrid.exe&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 初期化・境界条件生成</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="s1">&#39;real.exe&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// WRF本体実行</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="s1">&#39;wrf.exe&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 結果ファイルの確認</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">outputFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">checkOutputFiles</span><span class="p">();</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">executionTimeMs</span><span class="o">:</span><span class="w"> </span><span class="kt">endTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">,</span>
<span class="w">        </span><span class="nx">outputFiles</span><span class="p">,</span>
<span class="w">        </span><span class="nx">logFiles</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getLogFiles</span><span class="p">()</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">error.message</span><span class="p">,</span>
<span class="w">        </span><span class="nx">logFiles</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getLogFiles</span><span class="p">()</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">isRunning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 結果データの解析</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">analyzeResults</span><span class="p">(</span><span class="nx">outputFile</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WRFAnalysisResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// NetCDFファイルの読み込み</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">netcdfData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">readNetCDF</span><span class="p">(</span><span class="nx">outputFile</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 基本統計量の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">precipitation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">netcdfData</span><span class="p">.</span><span class="nx">variables</span><span class="p">[</span><span class="s1">&#39;RAINC&#39;</span><span class="p">].</span><span class="nx">add</span><span class="p">(</span><span class="nx">netcdfData</span><span class="p">.</span><span class="nx">variables</span><span class="p">[</span><span class="s1">&#39;RAINNC&#39;</span><span class="p">]);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">netcdfData</span><span class="p">.</span><span class="nx">variables</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">].</span><span class="nx">subtract</span><span class="p">(</span><span class="mf">273.15</span><span class="p">);</span><span class="w"> </span><span class="c1">// K → ℃</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">windU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">netcdfData</span><span class="p">.</span><span class="nx">variables</span><span class="p">[</span><span class="s1">&#39;U10&#39;</span><span class="p">];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">windV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">netcdfData</span><span class="p">.</span><span class="nx">variables</span><span class="p">[</span><span class="s1">&#39;V10&#39;</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// 最大・最小値の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxPrecip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">precipitation</span><span class="p">.</span><span class="nx">max</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">minTemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">temperature</span><span class="p">.</span><span class="nx">min</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxTemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">temperature</span><span class="p">.</span><span class="nx">max</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxWind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">windU</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">windV</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">2</span><span class="p">)).</span><span class="nx">sqrt</span><span class="p">().</span><span class="nx">max</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 予報検証指標の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">verification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateVerificationScores</span><span class="p">(</span><span class="nx">netcdfData</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">timeRange</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">netcdfData.dimensions.Time.start</span><span class="p">,</span>
<span class="w">        </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">netcdfData.dimensions.Time.end</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">statistics</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">maxPrecip</span><span class="p">,</span>
<span class="w">          </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">precipitation.sum</span><span class="p">(),</span>
<span class="w">          </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">precipitation.mean</span><span class="p">()</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">temperature</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">min</span><span class="o">:</span><span class="w"> </span><span class="kt">minTemp</span><span class="p">,</span>
<span class="w">          </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">maxTemp</span><span class="p">,</span>
<span class="w">          </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">temperature.mean</span><span class="p">()</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">maxWind</span><span class="p">,</span>
<span class="w">          </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">windU.pow</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">windV</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">2</span><span class="p">)).</span><span class="nx">sqrt</span><span class="p">().</span><span class="nx">mean</span><span class="p">()</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">verification</span><span class="p">,</span>
<span class="w">      </span><span class="nx">gridInfo</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">dimensions</span><span class="o">:</span><span class="w"> </span><span class="kt">netcdfData.dimensions</span><span class="p">,</span>
<span class="w">        </span><span class="nx">resolution</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">dx</span><span class="o">:</span><span class="w"> </span><span class="kt">netcdfData.globalAttributes.DX</span><span class="p">,</span>
<span class="w">          </span><span class="nx">dy</span><span class="o">:</span><span class="w"> </span><span class="kt">netcdfData.globalAttributes.DY</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">date</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[-:]/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">executeCommand</span><span class="p">(</span><span class="nx">command</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">exec</span><span class="p">(</span>
<span class="w">        </span><span class="nx">command</span><span class="p">,</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">cwd</span><span class="o">:</span><span class="w"> </span><span class="kt">this.workingDirectory</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">(</span><span class="nx">error</span><span class="p">,</span><span class="w"> </span><span class="nx">stdout</span><span class="p">,</span><span class="w"> </span><span class="nx">stderr</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Command failed: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">));</span>
<span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">resolve</span><span class="p">();</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// リアルタイム進捗監視</span>
<span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[</span><span class="si">${</span><span class="nx">command</span><span class="si">}</span><span class="sb">] </span><span class="si">${</span><span class="nx">data</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="nx">process</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[</span><span class="si">${</span><span class="nx">command</span><span class="si">}</span><span class="sb">] ERROR: </span><span class="si">${</span><span class="nx">data</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WRFRunResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">executionTimeMs?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">outputFiles?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">logFiles?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">error?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WRFAnalysisResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timeRange</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">    </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">statistics</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">      </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">      </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">temperature</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">min</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">      </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">      </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">      </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">verification</span><span class="o">:</span><span class="w"> </span><span class="kt">VerificationScores</span><span class="p">;</span>
<span class="w">  </span><span class="nx">gridInfo</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">dimensions</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
<span class="w">    </span><span class="nx">resolution</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">dx</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">      </span><span class="nx">dy</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">VerificationScores</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">bias</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">rmse</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">correlation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">threat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// Threat Score</span>
<span class="w">  </span><span class="nx">ets</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// Equitable Threat Score</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="_12">観測・監視システム<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<h3 id="_13">地上気象観測システム<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<h4 id="amedas">AMeDAS（地域気象観測システム）<a class="headerlink" href="#amedas" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>機能</th>
<th>説明・技術的特徴</th>
<th>導入例・メリット</th>
</tr>
</thead>
<tbody>
<tr>
<td>自動気象観測</td>
<td>全国約1,300地点で無人観測・10分毎データ・即時伝送</td>
<td>高密度網で局地気象も把握・災害監視に強み</td>
</tr>
<tr>
<td>品質管理</td>
<td>異常値自動検出・時空間一貫性チェック・欠測補完</td>
<td>高信頼な観測データを安定供給</td>
</tr>
<tr>
<td>データ配信</td>
<td>XML/CSV/バイナリ等でリアルタイム配信</td>
<td>天気予報・防災・農業・電力分野で活用</td>
</tr>
</tbody>
</table>
<h5 id="medas">MeDASの強み<a class="headerlink" href="#medas" title="Permanent link">&para;</a></h5>
<p>・高密度・高頻度観測で局地的な豪雨や気温変化も迅速検知<br />
・自動品質管理により常に信頼性の高いデータを提供<br />
・防災本部・農業・産業の判断材料として不可欠</p>
<h3 id="_14">気象レーダーシステム<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<h4 id="_15">気象レーダーネットワーク<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>用途</th>
<th>技術的強み</th>
<th>導入事例</th>
</tr>
</thead>
<tbody>
<tr>
<td>降水・竜巻・突風監視、短時間予報</td>
<td>5分毎の高頻度観測・高解像度反射強度・ドップラー風速・多パラメータ化</td>
<td>降水ナウキャスト、河川洪水警報、自治体避難判断、空港運航判断</td>
</tr>
</tbody>
</table>
<h5 id="_16">技術背景<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h5>
<ul>
<li>反射強度・ドップラー風速・偏波情報で降水量や竜巻・ダウンバーストもリアルタイム検知  </li>
<li>全国ネットワークで局地現象も見逃さず、洪水・突風災害の早期警報を実現</li>
</ul>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<p>この TypeScript 実装では、気象レーダーデータの収集と解析を行います。
降水分布や風速の計測、竜巻やメソサイクロンの検出をリアルタイムで行い、災害警報を発信する機能を持っています。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 気象レーダーデータ処理システム</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">RadarScan</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 仰角</span>
<span class="w">  </span><span class="nx">azimuth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w"> </span><span class="c1">// 方位角配列</span>
<span class="w">  </span><span class="nx">range</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w"> </span><span class="c1">// 距離配列</span>
<span class="w">  </span><span class="nx">reflectivity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span><span class="w"> </span><span class="c1">// 反射強度 (dBZ)</span>
<span class="w">  </span><span class="nx">velocity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span><span class="w"> </span><span class="c1">// ドップラー速度 (m/s)</span>
<span class="w">  </span><span class="nx">spectrumWidth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span><span class="w"> </span><span class="c1">// スペクトル幅</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">radarId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">RadarVolume</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">radarLocation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">altitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">volumeTimestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">WeatherRadarProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">REFLECTIVITY_THRESHOLD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">15</span><span class="p">;</span><span class="w"> </span><span class="c1">// dBZ</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">VELOCITY_THRESHOLD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">15</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>

<span class="w">  </span><span class="c1">// レーダーボリュームデータの処理</span>
<span class="w">  </span><span class="nx">processRadarVolume</span><span class="p">(</span><span class="nx">volume</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarVolume</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">RadarProducts</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">ppi</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generatePPI</span><span class="p">(</span><span class="nx">volume</span><span class="p">.</span><span class="nx">scans</span><span class="p">),</span>
<span class="w">      </span><span class="nx">cappi</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateCAPPI</span><span class="p">(</span><span class="nx">volume</span><span class="p">.</span><span class="nx">scans</span><span class="p">),</span>
<span class="w">      </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">this.estimatePrecipitation</span><span class="p">(</span><span class="nx">volume</span><span class="p">.</span><span class="nx">scans</span><span class="p">),</span>
<span class="w">      </span><span class="nx">windShear</span><span class="o">:</span><span class="w"> </span><span class="kt">this.detectWindShear</span><span class="p">(</span><span class="nx">volume</span><span class="p">.</span><span class="nx">scans</span><span class="p">),</span>
<span class="w">      </span><span class="nx">mesocyclone</span><span class="o">:</span><span class="w"> </span><span class="kt">this.detectMesocyclone</span><span class="p">(</span><span class="nx">volume</span><span class="p">.</span><span class="nx">scans</span><span class="p">),</span>
<span class="w">      </span><span class="nx">tornado</span><span class="o">:</span><span class="w"> </span><span class="kt">this.detectTornadoVortexSignature</span><span class="p">(</span><span class="nx">volume</span><span class="p">.</span><span class="nx">scans</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// PPI（Plan Position Indicator）生成</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">generatePPI</span><span class="p">(</span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">PPIProduct</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">scans</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">scan</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.elevation</span><span class="p">,</span>
<span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.timestamp</span><span class="p">,</span>
<span class="w">      </span><span class="nx">reflectivityField</span><span class="o">:</span><span class="w"> </span><span class="kt">this.interpolateRadialData</span><span class="p">(</span>
<span class="w">        </span><span class="nx">scan</span><span class="p">.</span><span class="nx">azimuth</span><span class="p">,</span>
<span class="w">        </span><span class="nx">scan</span><span class="p">.</span><span class="nx">range</span><span class="p">,</span>
<span class="w">        </span><span class="nx">scan</span><span class="p">.</span><span class="nx">reflectivity</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nx">velocityField</span><span class="o">:</span><span class="w"> </span><span class="kt">this.interpolateRadialData</span><span class="p">(</span>
<span class="w">        </span><span class="nx">scan</span><span class="p">.</span><span class="nx">azimuth</span><span class="p">,</span>
<span class="w">        </span><span class="nx">scan</span><span class="p">.</span><span class="nx">range</span><span class="p">,</span>
<span class="w">        </span><span class="nx">scan</span><span class="p">.</span><span class="nx">velocity</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">}));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// CAPPI（Constant Altitude PPI）生成</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">generateCAPPI</span><span class="p">(</span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">CAPPIProduct</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">altitudes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1000</span><span class="p">,</span><span class="w"> </span><span class="mf">2000</span><span class="p">,</span><span class="w"> </span><span class="mf">3000</span><span class="p">,</span><span class="w"> </span><span class="mf">5000</span><span class="p">];</span><span class="w"> </span><span class="c1">// 高度 (m)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cappiProducts</span><span class="o">:</span><span class="w"> </span><span class="kt">CAPPIProduct</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">altitude</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">altitudes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">cappiData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractConstantAltitude</span><span class="p">(</span><span class="nx">scans</span><span class="p">,</span><span class="w"> </span><span class="nx">altitude</span><span class="p">);</span>
<span class="w">      </span><span class="nx">cappiProducts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">altitude</span><span class="p">,</span>
<span class="w">        </span><span class="nx">reflectivityField</span><span class="o">:</span><span class="w"> </span><span class="kt">cappiData.reflectivity</span><span class="p">,</span>
<span class="w">        </span><span class="nx">velocityField</span><span class="o">:</span><span class="w"> </span><span class="kt">cappiData.velocity</span><span class="p">,</span>
<span class="w">        </span><span class="nx">coverage</span><span class="o">:</span><span class="w"> </span><span class="kt">cappiData.coverage</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">cappiProducts</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 定量的降水量推定</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">estimatePrecipitation</span><span class="p">(</span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">PrecipitationProduct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">surfaceScan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">scans</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">elevation</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">scans</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">rainRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">reflectivityToRainRate</span><span class="p">(</span><span class="nx">surfaceScan</span><span class="p">.</span><span class="nx">reflectivity</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 雨粒粒径分布補正</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">correctedRainRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">correctDropSizeDistribution</span><span class="p">(</span><span class="nx">rainRate</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 地形クラッター除去</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filteredRainRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">removeGroundClutter</span><span class="p">(</span><span class="nx">correctedRainRate</span><span class="p">,</span><span class="w"> </span><span class="nx">surfaceScan</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">instantaneousRainRate</span><span class="o">:</span><span class="w"> </span><span class="kt">filteredRainRate</span><span class="p">,</span>
<span class="w">      </span><span class="nx">accumulatedPrecipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateAccumulation</span><span class="p">(</span><span class="nx">filteredRainRate</span><span class="p">),</span>
<span class="w">      </span><span class="nx">qualityIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateQualityIndex</span><span class="p">(</span><span class="nx">surfaceScan</span><span class="p">),</span>
<span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">surfaceScan.timestamp</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Z-R関係式による降水量推定</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">reflectivityToRainRate</span><span class="p">(</span><span class="nx">reflectivity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">reflectivity</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">row</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">      </span><span class="nx">row</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">z</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">REFLECTIVITY_THRESHOLD</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Z = aR^b (a=200, b=1.6)</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">linearZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">linearZ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1.6</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 風のシアー検出（ダウンバースト検出）</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">detectWindShear</span><span class="p">(</span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">WindShearProduct</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">WindShearProduct</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">scans</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">windShearAreas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">identifyDivergenceConvergence</span><span class="p">(</span><span class="nx">scan</span><span class="p">);</span>

<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">area</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">windShearAreas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">shearValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateWindShearMagnitude</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">shearValue</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">20</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 20 m/s のシアー</span>
<span class="w">          </span><span class="nx">products</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">            </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">area.center</span><span class="p">,</span>
<span class="w">            </span><span class="nx">intensity</span><span class="o">:</span><span class="w"> </span><span class="kt">shearValue</span><span class="p">,</span>
<span class="w">            </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">area</span><span class="p">.</span><span class="kr">type</span><span class="p">,</span><span class="w"> </span><span class="c1">// &#39;convergence&#39; | &#39;divergence&#39;</span>
<span class="w">            </span><span class="nx">areaKm2</span><span class="o">:</span><span class="w"> </span><span class="kt">area.areaKm2</span><span class="p">,</span>
<span class="w">            </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateShearConfidence</span><span class="p">(</span><span class="nx">area</span><span class="p">),</span>
<span class="w">            </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.elevation</span><span class="p">,</span>
<span class="w">            </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.timestamp</span>
<span class="w">          </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// メソサイクロン検出</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">detectMesocyclone</span><span class="p">(</span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">MesocycloneProduct</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">MesocycloneProduct</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">scans</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">vortexCandidates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">findVortexSignatures</span><span class="p">(</span><span class="nx">scan</span><span class="p">);</span>

<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">candidate</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">vortexCandidates</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">rotationalVelocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateRotationalVelocity</span><span class="p">(</span><span class="nx">candidate</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">shear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateRadialShear</span><span class="p">(</span><span class="nx">candidate</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// メソサイクロン判定基準</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">rotationalVelocity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">shear</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">10e-3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">products</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">            </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">candidate.center</span><span class="p">,</span>
<span class="w">            </span><span class="nx">rotationalVelocity</span><span class="p">,</span>
<span class="w">            </span><span class="nx">shear</span><span class="p">,</span>
<span class="w">            </span><span class="nx">diameter</span><span class="o">:</span><span class="w"> </span><span class="kt">candidate.diameterKm</span><span class="p">,</span>
<span class="w">            </span><span class="nx">depth</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateVerticalExtent</span><span class="p">(</span><span class="nx">scans</span><span class="p">,</span><span class="w"> </span><span class="nx">candidate</span><span class="p">),</span>
<span class="w">            </span><span class="nx">strength</span><span class="o">:</span><span class="w"> </span><span class="kt">this.categorizeMesocyclone</span><span class="p">(</span><span class="nx">rotationalVelocity</span><span class="p">,</span><span class="w"> </span><span class="nx">shear</span><span class="p">),</span>
<span class="w">            </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.elevation</span><span class="p">,</span>
<span class="w">            </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.timestamp</span>
<span class="w">          </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 竜巻渦シグネチャ（TVS）検出</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">detectTornadoVortexSignature</span><span class="p">(</span><span class="nx">scans</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarScan</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">TornadoProduct</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">TornadoProduct</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">scans</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">scan</span><span class="p">.</span><span class="nx">elevation</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span><span class="w"> </span><span class="c1">// 低仰角のみ</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">tvsSignatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">findTVSSignatures</span><span class="p">(</span><span class="nx">scan</span><span class="p">);</span>

<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">signature</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">tvsSignatures</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">deltaV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateVelocityDifference</span><span class="p">(</span><span class="nx">signature</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSignatureDistance</span><span class="p">(</span><span class="nx">signature</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// TVS判定基準（δV &gt; 30 m/s, 距離 &lt; 2km）</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">deltaV</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">30</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">distance</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">products</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">            </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">signature.center</span><span class="p">,</span>
<span class="w">            </span><span class="nx">velocityDifference</span><span class="o">:</span><span class="w"> </span><span class="kt">deltaV</span><span class="p">,</span>
<span class="w">            </span><span class="nx">distance</span><span class="p">,</span>
<span class="w">            </span><span class="nx">rotationalVelocity</span><span class="o">:</span><span class="w"> </span><span class="kt">deltaV</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">            </span><span class="nx">lowLevelConvergence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.checkConvergence</span><span class="p">(</span><span class="nx">signature</span><span class="p">),</span>
<span class="w">            </span><span class="nx">associatedMesocyclone</span><span class="o">:</span><span class="w"> </span><span class="kt">this.findAssociatedMesocyclone</span><span class="p">(</span><span class="nx">signature</span><span class="p">,</span><span class="w"> </span><span class="nx">products</span><span class="p">),</span>
<span class="w">            </span><span class="nx">probability</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateTornadoProbability</span><span class="p">(</span><span class="nx">deltaV</span><span class="p">,</span><span class="w"> </span><span class="nx">distance</span><span class="p">),</span>
<span class="w">            </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">scan.timestamp</span>
<span class="w">          </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">products</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイムアラート生成</span>
<span class="w">  </span><span class="nx">generateRealTimeAlerts</span><span class="p">(</span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarProducts</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">WeatherAlert</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">alerts</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherAlert</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 大雨アラート</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">heavyRain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">.</span><span class="nx">instantaneousRainRate</span><span class="p">.</span><span class="nx">flat</span><span class="p">()</span>
<span class="w">      </span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">rate</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span><span class="w"> </span><span class="c1">// 50mm/h以上</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">heavyRain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alerts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HEAVY_RAINFALL&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Heavy rainfall detected: </span><span class="si">${</span><span class="nx">heavyRain</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb">mm/h`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">validUntil</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">30</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="c1">// 30分有効</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 竜巻アラート</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">products</span><span class="p">.</span><span class="nx">tornado</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">tornado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">tornado</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">      </span><span class="nx">alerts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;TORNADO_WARNING&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Tornado signature detected at </span><span class="si">${</span><span class="nx">tornado</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">latitude</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">3</span><span class="p">)</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">tornado</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">longitude</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">3</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">validUntil</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="c1">// 15分有効</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ダウンバーストアラート</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">strongWindShear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">.</span><span class="nx">windShear</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">ws</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ws</span><span class="p">.</span><span class="nx">intensity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">30</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">strongWindShear</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alerts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DOWNBURST_WARNING&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Strong wind shear detected: </span><span class="si">${</span><span class="nx">strongWindShear</span><span class="p">.</span><span class="nx">intensity</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb">m/s`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">validUntil</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="c1">// 20分有効</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">alerts</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">RadarProducts</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">ppi</span><span class="o">:</span><span class="w"> </span><span class="kt">PPIProduct</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">cappi</span><span class="o">:</span><span class="w"> </span><span class="kt">CAPPIProduct</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">PrecipitationProduct</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windShear</span><span class="o">:</span><span class="w"> </span><span class="kt">WindShearProduct</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">mesocyclone</span><span class="o">:</span><span class="w"> </span><span class="kt">MesocycloneProduct</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">tornado</span><span class="o">:</span><span class="w"> </span><span class="kt">TornadoProduct</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">PrecipitationProduct</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">instantaneousRainRate</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span>
<span class="w">  </span><span class="nx">accumulatedPrecipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span>
<span class="w">  </span><span class="nx">qualityIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WindShearProduct</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">intensity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;convergence&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;divergence&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">areaKm2</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">MesocycloneProduct</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">rotationalVelocity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">shear</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// s^-1</span>
<span class="w">  </span><span class="nx">diameter</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// km</span>
<span class="w">  </span><span class="nx">depth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// km</span>
<span class="w">  </span><span class="nx">strength</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;WEAK&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;MODERATE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;STRONG&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TornadoProduct</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">velocityDifference</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">distance</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// km</span>
<span class="w">  </span><span class="nx">rotationalVelocity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">lowLevelConvergence</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">associatedMesocyclone?</span><span class="o">:</span><span class="w"> </span><span class="kt">MesocycloneProduct</span><span class="p">;</span>
<span class="w">  </span><span class="nx">probability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0-1</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherAlert</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HEAVY_RAINFALL&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;TORNADO_WARNING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;DOWNBURST_WARNING&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;LOW&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">validUntil</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="_17">気象衛星システム<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<h4 id="89">ひまわり8号・9号（気象衛星）<a class="headerlink" href="#89" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>用途</th>
<th>技術的強み</th>
<th>導入事例</th>
</tr>
</thead>
<tbody>
<tr>
<td>広域雲・降水監視、台風解析、火山・海洋監視</td>
<td>2.5分間隔の高頻度観測、16バンド多スペクトルで雲・水蒸気・地表面を詳細把握</td>
<td>降水短時間予報、台風進路強度解析、火山噴火監視、農業の日射量推定</td>
</tr>
</tbody>
</table>
<h5 id="_18">技術背景<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<ul>
<li>ひまわり8号は東アジア域で世界最高水準の観測頻度・解像度  </li>
<li>急発達する積乱雲や台風の中心も高精度でトラッキング可能</li>
</ul>
<h2 id="_19">予報・警報配信システム<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<h3 id="_20">気象警報システム<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<h4 id="_21">特別警報・警報・注意報<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム</th>
<th>役割</th>
<th>技術的背景</th>
<th>効果・用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>警報・注意報システム</td>
<td>数値予報・観測データをもとに自動で地域ごとに警報・注意報を発表</td>
<td>閾値判定・段階的警報発表・自動配信（CAP/XML/多言語）</td>
<td>住民・自治体への早期注意喚起、避難準備・減災</td>
</tr>
<tr>
<td>特別警報システム</td>
<td>数十年に一度の極端災害リスクを複合判定で自動通知</td>
<td>過去統計比較・複数要素自動判定</td>
<td>超大型災害の人的被害最小化</td>
</tr>
<tr>
<td>緊急地震速報連携</td>
<td>地震・津波と気象災害の統合警報を一元配信</td>
<td>マルチハザード統合・優先度制御</td>
<td>複合災害時の適切な避難誘導・混乱防止</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<p>この TypeScript 実装では、気象警報システムを実装しています。
台風、豪雨、洪水、竜巻などの気象災害の検知とリアルタイム警報を生成し、緊急時の避難判断を支援します。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 気象警報システムの実装</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherWarning</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">WarningType</span><span class="p">;</span>
<span class="w">  </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">WarningLevel</span><span class="p">;</span>
<span class="w">  </span><span class="nx">targetArea</span><span class="o">:</span><span class="w"> </span><span class="kt">GeographicArea</span><span class="p">;</span>
<span class="w">  </span><span class="nx">phenomenon</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPhenomenon</span><span class="p">;</span>
<span class="w">  </span><span class="nx">criteria</span><span class="o">:</span><span class="w"> </span><span class="kt">WarningCriteria</span><span class="p">;</span>
<span class="w">  </span><span class="nx">validPeriod</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">    </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updatedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cancelledAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">supplement?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">enum</span><span class="w"> </span><span class="nx">WarningType</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">SPECIAL_WARNING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;special_warning&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">WARNING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">ADVISORY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;advisory&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">FORECAST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;forecast&#39;</span>
<span class="p">}</span>

<span class="kd">enum</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">EMERGENCY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w">  </span><span class="c1">// 特別警報</span>
<span class="w">  </span><span class="nx">SEVERE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w">     </span><span class="c1">// 警報</span>
<span class="w">  </span><span class="nx">MODERATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w">   </span><span class="c1">// 注意報</span>
<span class="w">  </span><span class="nx">MINOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w">      </span><span class="c1">// 予報</span>
<span class="w">  </span><span class="nx">INFO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w">        </span><span class="c1">// 情報</span>
<span class="p">}</span>

<span class="kd">enum</span><span class="w"> </span><span class="nx">WeatherPhenomenon</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">HEAVY_RAIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;heavy_rain&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">HEAVY_SNOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;heavy_snow&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">STRONG_WIND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;strong_wind&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">STORM_SURGE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;storm_surge&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">HIGH_WAVES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;high_waves&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">THUNDERSTORM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;thunderstorm&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">TORNADO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tornado&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">FLOODING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;flooding&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">LANDSLIDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;landslide&#39;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">WeatherWarningSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">forecastModels</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">ForecastModel</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">observationNetwork</span><span class="o">:</span><span class="w"> </span><span class="kt">ObservationNetwork</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">warningCriteria</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">WarningCriteriaSet</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">activeWarnings</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">WeatherWarning</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupWarningCriteria</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">observationNetwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ObservationNetwork</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 警報発表基準の設定</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupWarningCriteria</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 大雨警報基準（例：東京都）</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">warningCriteria</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;tokyo_heavy_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">phenomenon</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPhenomenon.HEAVY_RAIN</span><span class="p">,</span>
<span class="w">      </span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rainfall1h</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="p">,</span><span class="w">    </span><span class="c1">// 1時間50mm以上</span>
<span class="w">        </span><span class="nx">rainfall3h</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span><span class="w">   </span><span class="c1">// 3時間100mm以上</span>
<span class="w">        </span><span class="nx">soilMoisture</span><span class="o">:</span><span class="w"> </span><span class="kt">85</span><span class="w">   </span><span class="c1">// 土壌雨量指数85以上</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">advisory</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rainfall1h</span><span class="o">:</span><span class="w"> </span><span class="kt">30</span><span class="p">,</span><span class="w">    </span><span class="c1">// 1時間30mm以上</span>
<span class="w">        </span><span class="nx">rainfall3h</span><span class="o">:</span><span class="w"> </span><span class="kt">60</span><span class="p">,</span><span class="w">    </span><span class="c1">// 3時間60mm以上</span>
<span class="w">        </span><span class="nx">soilMoisture</span><span class="o">:</span><span class="w"> </span><span class="kt">60</span><span class="w">   </span><span class="c1">// 土壌雨量指数60以上</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">specialWarning</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rainfall24h</span><span class="o">:</span><span class="w"> </span><span class="kt">500</span><span class="p">,</span><span class="w">  </span><span class="c1">// 24時間500mm以上</span>
<span class="w">        </span><span class="nx">probabilisticIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">0.9</span><span class="w"> </span><span class="c1">// 確率的指標0.9以上</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 暴風警報基準</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">warningCriteria</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;strong_wind&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">phenomenon</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPhenomenon.STRONG_WIND</span><span class="p">,</span>
<span class="w">      </span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">maxWindSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">25</span><span class="p">,</span><span class="w">     </span><span class="c1">// 最大風速25m/s以上</span>
<span class="w">        </span><span class="nx">maxGustSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">35</span><span class="w">      </span><span class="c1">// 最大瞬間風速35m/s以上</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">advisory</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">maxWindSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">15</span><span class="p">,</span><span class="w">     </span><span class="c1">// 最大風速15m/s以上</span>
<span class="w">        </span><span class="nx">maxGustSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">25</span><span class="w">      </span><span class="c1">// 最大瞬間風速25m/s以上</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイム警報判定</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">evaluateWarnings</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WeatherWarning</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newWarnings</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherWarning</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 最新の予報データを取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getLatestForecast</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">observations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">observationNetwork</span><span class="p">.</span><span class="nx">getLatestObservations</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 各地域・現象について判定</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">region</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTargetRegions</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">phenomenon</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">WeatherPhenomenon</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">criteriaKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">region</span><span class="p">.</span><span class="nx">code</span><span class="si">}</span><span class="sb">_</span><span class="si">${</span><span class="nx">phenomenon</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">criteria</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">warningCriteria</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">criteriaKey</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">criteria</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">evaluation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evaluatePhenomenon</span><span class="p">(</span>
<span class="w">          </span><span class="nx">region</span><span class="p">,</span>
<span class="w">          </span><span class="nx">phenomenon</span><span class="p">,</span>
<span class="w">          </span><span class="nx">criteria</span><span class="p">,</span>
<span class="w">          </span><span class="nx">forecast</span><span class="p">,</span>
<span class="w">          </span><span class="nx">observations</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">evaluation</span><span class="p">.</span><span class="nx">shouldIssue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">warning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createWarning</span><span class="p">(</span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="nx">phenomenon</span><span class="p">,</span><span class="w"> </span><span class="nx">evaluation</span><span class="p">);</span>
<span class="w">          </span><span class="nx">newWarnings</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">warning</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">updateWarnings</span><span class="p">(</span><span class="nx">newWarnings</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 現象評価</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">evaluatePhenomenon</span><span class="p">(</span>
<span class="w">    </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="kt">Region</span><span class="p">,</span>
<span class="w">    </span><span class="nx">phenomenon</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPhenomenon</span><span class="p">,</span>
<span class="w">    </span><span class="nx">criteria</span><span class="o">:</span><span class="w"> </span><span class="kt">WarningCriteriaSet</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastData</span><span class="p">,</span>
<span class="w">    </span><span class="nx">observations</span><span class="o">:</span><span class="w"> </span><span class="kt">ObservationData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WarningEvaluation</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="p">.</span><span class="nx">INFO</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">confidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">phenomenon</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="nx">WeatherPhenomenon.HEAVY_RAIN</span><span class="o">:</span>
<span class="w">        </span><span class="kt">const</span><span class="w"> </span><span class="nx">rainEval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evaluateRainfall</span><span class="p">(</span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="nx">criteria</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">);</span>
<span class="w">        </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rainEval</span><span class="p">.</span><span class="nx">level</span><span class="p">;</span>
<span class="w">        </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rainEval</span><span class="p">.</span><span class="nx">shouldIssue</span><span class="p">;</span>
<span class="w">        </span><span class="nx">confidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rainEval</span><span class="p">.</span><span class="nx">confidence</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="nx">WeatherPhenomenon.STRONG_WIND</span><span class="o">:</span>
<span class="w">        </span><span class="kt">const</span><span class="w"> </span><span class="nx">windEval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evaluateWind</span><span class="p">(</span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="nx">criteria</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">);</span>
<span class="w">        </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">windEval</span><span class="p">.</span><span class="nx">level</span><span class="p">;</span>
<span class="w">        </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">windEval</span><span class="p">.</span><span class="nx">shouldIssue</span><span class="p">;</span>
<span class="w">        </span><span class="nx">confidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">windEval</span><span class="p">.</span><span class="nx">confidence</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// その他の現象...</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">phenomenon</span><span class="p">,</span>
<span class="w">      </span><span class="nx">level</span><span class="p">,</span>
<span class="w">      </span><span class="nx">shouldIssue</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="p">,</span>
<span class="w">      </span><span class="nx">expectedDuration</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateExpectedDuration</span><span class="p">(</span><span class="nx">phenomenon</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">),</span>
<span class="w">      </span><span class="nx">peakTime</span><span class="o">:</span><span class="w"> </span><span class="kt">this.identifyPeakTime</span><span class="p">(</span><span class="nx">phenomenon</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 降水評価</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">evaluateRainfall</span><span class="p">(</span>
<span class="w">    </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="kt">Region</span><span class="p">,</span>
<span class="w">    </span><span class="nx">criteria</span><span class="o">:</span><span class="w"> </span><span class="kt">WarningCriteriaSet</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastData</span><span class="p">,</span>
<span class="w">    </span><span class="nx">observations</span><span class="o">:</span><span class="w"> </span><span class="kt">ObservationData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">RainfallEvaluation</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// 観測による現在状況</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentRain1h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMaxRainfallInRegion</span><span class="p">(</span><span class="nx">observations</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentRain3h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMaxRainfallInRegion</span><span class="p">(</span><span class="nx">observations</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 予報による将来予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast1h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getForecastMaxRainfall</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast3h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getForecastMaxRainfall</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast24h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getForecastMaxRainfall</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">24</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 土壌雨量指数の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">soilMoistureIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSoilMoistureIndex</span><span class="p">(</span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 判定</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="p">.</span><span class="nx">INFO</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 特別警報判定</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">forecast24h</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">specialWarning</span><span class="o">?</span><span class="p">.</span><span class="nx">rainfall24h</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>
<span class="w">        </span><span class="nx">soilMoistureIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">specialWarning</span><span class="o">?</span><span class="p">.</span><span class="nx">soilMoisture</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="p">.</span><span class="nx">EMERGENCY</span><span class="p">;</span>
<span class="w">      </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// 警報判定</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">currentRain1h</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast1h</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">warning</span><span class="p">.</span><span class="nx">rainfall1h</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>
<span class="w">            </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">currentRain3h</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast3h</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">warning</span><span class="p">.</span><span class="nx">rainfall3h</span><span class="w"> </span><span class="o">||</span>
<span class="w">            </span><span class="nx">soilMoistureIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">warning</span><span class="p">.</span><span class="nx">soilMoisture</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="p">.</span><span class="nx">SEVERE</span><span class="p">;</span>
<span class="w">      </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// 注意報判定</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">currentRain1h</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast1h</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">advisory</span><span class="p">.</span><span class="nx">rainfall1h</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>
<span class="w">            </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">currentRain3h</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast3h</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">advisory</span><span class="p">.</span><span class="nx">rainfall3h</span><span class="w"> </span><span class="o">||</span>
<span class="w">            </span><span class="nx">soilMoistureIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">criteria</span><span class="p">.</span><span class="nx">advisory</span><span class="p">.</span><span class="nx">soilMoisture</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="p">.</span><span class="nx">MODERATE</span><span class="p">;</span>
<span class="w">      </span><span class="nx">shouldIssue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 信頼度計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">confidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateRainfallConfidence</span><span class="p">(</span>
<span class="w">      </span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="nx">level</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">level</span><span class="p">,</span><span class="w"> </span><span class="nx">shouldIssue</span><span class="p">,</span><span class="w"> </span><span class="nx">confidence</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 土壌雨量指数の計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateSoilMoistureIndex</span><span class="p">(</span>
<span class="w">    </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="kt">Region</span><span class="p">,</span>
<span class="w">    </span><span class="nx">observations</span><span class="o">:</span><span class="w"> </span><span class="kt">ObservationData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastData</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 過去の降水量から土壌雨量指数を計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">pastRainfall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getRegionalRainfall</span><span class="p">(</span><span class="nx">observations</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">72</span><span class="p">);</span><span class="w"> </span><span class="c1">// 過去72時間</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">futureRainfall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getForecastTotalRainfall</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">,</span><span class="w"> </span><span class="mf">24</span><span class="p">);</span><span class="w"> </span><span class="c1">// 今後24時間</span>

<span class="w">    </span><span class="c1">// タンクモデルによる土壌水分計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tankModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">TankModel</span><span class="p">({</span>
<span class="w">      </span><span class="nx">initialWater</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getInitialSoilMoisture</span><span class="p">(</span><span class="nx">region</span><span class="p">),</span>
<span class="w">      </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getTankParameters</span><span class="p">(</span><span class="nx">region</span><span class="p">)</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 過去の降水を入力</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">rain</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">pastRainfall</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">tankModel</span><span class="p">.</span><span class="nx">input</span><span class="p">(</span><span class="nx">rain</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span><span class="w"> </span><span class="nx">rain</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 将来の降水を入力（予測）</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">rain</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">futureRainfall</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">tankModel</span><span class="p">.</span><span class="nx">input</span><span class="p">(</span><span class="nx">rain</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span><span class="w"> </span><span class="nx">rain</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">tankModel</span><span class="p">.</span><span class="nx">getSoilMoistureIndex</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 警報の更新・配信</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">updateWarnings</span><span class="p">(</span><span class="nx">newWarnings</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherWarning</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">WeatherWarning</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">updatedWarnings</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherWarning</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">warning</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">newWarnings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">existingWarningId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">findExistingWarning</span><span class="p">(</span><span class="nx">warning</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">existingWarningId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 既存警報の更新</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">existing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">activeWarnings</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">existingWarningId</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasSignificantChange</span><span class="p">(</span><span class="nx">existing</span><span class="p">,</span><span class="w"> </span><span class="nx">warning</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">updated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">updateExistingWarning</span><span class="p">(</span><span class="nx">existing</span><span class="p">,</span><span class="w"> </span><span class="nx">warning</span><span class="p">);</span>
<span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">activeWarnings</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">existingWarningId</span><span class="p">,</span><span class="w"> </span><span class="nx">updated</span><span class="p">);</span>
<span class="w">          </span><span class="nx">updatedWarnings</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">updated</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 新規警報発表</span>
<span class="w">        </span><span class="nx">warning</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateWarningId</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">activeWarnings</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">warning</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">warning</span><span class="p">);</span>
<span class="w">        </span><span class="nx">updatedWarnings</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">warning</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 解除チェック</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cancelledWarnings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">checkForCancellations</span><span class="p">();</span>
<span class="w">    </span><span class="nx">updatedWarnings</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nx">cancelledWarnings</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 配信実行</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">distributeWarnings</span><span class="p">(</span><span class="nx">updatedWarnings</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">updatedWarnings</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 多言語対応メッセージ生成</span>
<span class="w">  </span><span class="nx">generateWarningMessage</span><span class="p">(</span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherWarning</span><span class="p">,</span><span class="w"> </span><span class="nx">language</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ja&#39;</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">templates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">ja</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">heavy_rain_warning</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{areaName}に大雨警報が発表されました。{validPeriod}にかけて、1時間に{maxRainfall}ミリの激しい雨が降る見込みです。土砂災害や低い土地の浸水、河川の増水に警戒してください。&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">heavy_rain_special</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{areaName}に大雨特別警報が発表されました。これまでに経験したことのないような大雨となっており、重大な危険が差し迫っています。直ちに命を守る行動をとってください。&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">strong_wind_warning</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{areaName}に暴風警報が発表されました。{validPeriod}にかけて、最大風速{maxWind}メートルの暴風が吹く見込みです。外出は避け、安全な場所に留まってください。&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">en</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">heavy_rain_warning</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Heavy rainfall warning issued for {areaName}. Expect intense rainfall of {maxRainfall}mm per hour until {validPeriod}. Be alert for landslides, flooding in low-lying areas, and rising river levels.&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">heavy_rain_special</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Special heavy rainfall warning issued for {areaName}. Unprecedented heavy rainfall is occurring, posing grave danger. Take immediate action to protect life.&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">strong_wind_warning</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Strong wind warning issued for {areaName}. Expect maximum wind speeds of {maxWind} m/s until {validPeriod}. Avoid going outside and stay in a safe location.&#39;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">templates</span><span class="p">[</span><span class="nx">language</span><span class="p">]</span><span class="o">?</span><span class="p">.[</span><span class="nx">warning</span><span class="p">.</span><span class="nx">phenomenon</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">warning</span><span class="p">.</span><span class="nx">level</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">WarningLevel</span><span class="p">.</span><span class="nx">EMERGENCY</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;special&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="p">)];</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">template</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">warning</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">template</span>
<span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{areaName}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warning</span><span class="p">.</span><span class="nx">targetArea</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{validPeriod}&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">formatDateTime</span><span class="p">(</span><span class="nx">warning</span><span class="p">.</span><span class="nx">validPeriod</span><span class="p">.</span><span class="nx">end</span><span class="p">))</span>
<span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{maxRainfall}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warning</span><span class="p">.</span><span class="nx">criteria</span><span class="o">?</span><span class="p">.</span><span class="nx">maxRainfall</span><span class="o">?</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{maxWind}&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warning</span><span class="p">.</span><span class="nx">criteria</span><span class="o">?</span><span class="p">.</span><span class="nx">maxWind</span><span class="o">?</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// CAP（Common Alerting Protocol）形式での配信</span>
<span class="w">  </span><span class="nx">generateCAPMessage</span><span class="p">(</span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherWarning</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">capMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="sb">&lt;alert xmlns=&quot;urn:oasis:names:tc:emergency:cap:1.2&quot;&gt;</span>
<span class="sb">  &lt;identifier&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">&lt;/identifier&gt;</span>
<span class="sb">  &lt;sender&gt;jma@met.gov.jp&lt;/sender&gt;</span>
<span class="sb">  &lt;sent&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">issuedAt</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">()</span><span class="si">}</span><span class="sb">&lt;/sent&gt;</span>
<span class="sb">  &lt;status&gt;Actual&lt;/status&gt;</span>
<span class="sb">  &lt;msgType&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">updatedAt</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Update&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alert&#39;</span><span class="si">}</span><span class="sb">&lt;/msgType&gt;</span>
<span class="sb">  &lt;scope&gt;Public&lt;/scope&gt;</span>

<span class="sb">  &lt;info&gt;</span>
<span class="sb">    &lt;language&gt;ja-JP&lt;/language&gt;</span>
<span class="sb">    &lt;category&gt;Met&lt;/category&gt;</span>
<span class="sb">    &lt;event&gt;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">phenomenonToEventType</span><span class="p">(</span><span class="nx">warning</span><span class="p">.</span><span class="nx">phenomenon</span><span class="p">)</span><span class="si">}</span><span class="sb">&lt;/event&gt;</span>
<span class="sb">    &lt;urgency&gt;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">levelToUrgency</span><span class="p">(</span><span class="nx">warning</span><span class="p">.</span><span class="nx">level</span><span class="p">)</span><span class="si">}</span><span class="sb">&lt;/urgency&gt;</span>
<span class="sb">    &lt;severity&gt;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">levelToSeverity</span><span class="p">(</span><span class="nx">warning</span><span class="p">.</span><span class="nx">level</span><span class="p">)</span><span class="si">}</span><span class="sb">&lt;/severity&gt;</span>
<span class="sb">    &lt;certainty&gt;Observed&lt;/certainty&gt;</span>
<span class="sb">    &lt;effective&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">validPeriod</span><span class="p">.</span><span class="nx">start</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">()</span><span class="si">}</span><span class="sb">&lt;/effective&gt;</span>
<span class="sb">    &lt;expires&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">validPeriod</span><span class="p">.</span><span class="nx">end</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">()</span><span class="si">}</span><span class="sb">&lt;/expires&gt;</span>
<span class="sb">    &lt;senderName&gt;Japan Meteorological Agency&lt;/senderName&gt;</span>
<span class="sb">    &lt;headline&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">&lt;/headline&gt;</span>
<span class="sb">    &lt;description&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">supplement</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">warning</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">&lt;/description&gt;</span>

<span class="sb">    &lt;area&gt;</span>
<span class="sb">      &lt;areaDesc&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">targetArea</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">&lt;/areaDesc&gt;</span>
<span class="sb">      &lt;geocode&gt;</span>
<span class="sb">        &lt;valueName&gt;JMA_CODE&lt;/valueName&gt;</span>
<span class="sb">        &lt;value&gt;</span><span class="si">${</span><span class="nx">warning</span><span class="p">.</span><span class="nx">targetArea</span><span class="p">.</span><span class="nx">code</span><span class="si">}</span><span class="sb">&lt;/value&gt;</span>
<span class="sb">      &lt;/geocode&gt;</span>
<span class="sb">    &lt;/area&gt;</span>
<span class="sb">  &lt;/info&gt;</span>
<span class="sb">&lt;/alert&gt;`</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">capMessage</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイム配信システム</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">distributeWarnings</span><span class="p">(</span><span class="nx">warnings</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherWarning</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">warning</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">warnings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// CAP形式メッセージ生成</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">capMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateCAPMessage</span><span class="p">(</span><span class="nx">warning</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 各配信チャネルに送信</span>
<span class="w">      </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToJMASystem</span><span class="p">(</span><span class="nx">capMessage</span><span class="p">),</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToLocalGovernments</span><span class="p">(</span><span class="nx">warning</span><span class="p">),</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToMediaOutlets</span><span class="p">(</span><span class="nx">warning</span><span class="p">),</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToMobileCarriers</span><span class="p">(</span><span class="nx">warning</span><span class="p">),</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToWebServices</span><span class="p">(</span><span class="nx">warning</span><span class="p">)</span>
<span class="w">      </span><span class="p">]).</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Warning distribution error:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// 配信失敗時の代替手段実行</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">handleDistributionFailure</span><span class="p">(</span><span class="nx">warning</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// ログ記録</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">logWarningDistribution</span><span class="p">(</span><span class="nx">warning</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WarningCriteriaSet</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">phenomenon</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPhenomenon</span><span class="p">;</span>
<span class="w">  </span><span class="nx">warning</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rainfall1h?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">rainfall3h?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">soilMoisture?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">maxWindSpeed?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">maxGustSpeed?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">advisory</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rainfall1h?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">rainfall3h?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">soilMoisture?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">maxWindSpeed?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">maxGustSpeed?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">specialWarning</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rainfall24h?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">probabilisticIndex?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">soilMoisture?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WarningEvaluation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">phenomenon</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPhenomenon</span><span class="p">;</span>
<span class="w">  </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">WarningLevel</span><span class="p">;</span>
<span class="w">  </span><span class="nx">shouldIssue</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">expectedDuration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// hours</span>
<span class="w">  </span><span class="nx">peakTime</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">RainfallEvaluation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="kt">WarningLevel</span><span class="p">;</span>
<span class="w">  </span><span class="nx">shouldIssue</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// タンクモデル（土壌雨量指数計算用）</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">TankModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">tanks</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span><span class="w"> </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">drainRate</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">water</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">initialWater</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">parameters</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">tanks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span><span class="w"> </span><span class="nx">drainRate</span><span class="o">:</span><span class="w"> </span><span class="kt">0.1</span><span class="p">,</span><span class="w"> </span><span class="nx">water</span><span class="o">:</span><span class="w"> </span><span class="kt">config.initialWater</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.6</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="p">,</span><span class="w"> </span><span class="nx">drainRate</span><span class="o">:</span><span class="w"> </span><span class="kt">0.05</span><span class="p">,</span><span class="w"> </span><span class="nx">water</span><span class="o">:</span><span class="w"> </span><span class="kt">config.initialWater</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">25</span><span class="p">,</span><span class="w"> </span><span class="nx">drainRate</span><span class="o">:</span><span class="w"> </span><span class="kt">0.02</span><span class="p">,</span><span class="w"> </span><span class="nx">water</span><span class="o">:</span><span class="w"> </span><span class="kt">config.initialWater</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">input</span><span class="p">(</span><span class="nx">rainfall</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">remainingRainfall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rainfall</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 上位タンクから順に水を入れる</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">tanks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">tank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">tanks</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">canAdd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">remainingRainfall</span><span class="p">,</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">capacity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="p">);</span>
<span class="w">      </span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">canAdd</span><span class="p">;</span>
<span class="w">      </span><span class="nx">remainingRainfall</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="nx">canAdd</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 次のタンクに流れる量を計算</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">tanks</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">capacity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">overflow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">capacity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">        </span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="nx">overflow</span><span class="p">;</span>
<span class="w">        </span><span class="nx">remainingRainfall</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">overflow</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 蒸発・浸透による減少</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">tank</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">tanks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">drainRate</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">getSoilMoistureIndex</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 各タンクの水位を重み付け合計</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalWater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">tanks</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">tank</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">][</span><span class="nx">index</span><span class="p">];</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tank</span><span class="p">.</span><span class="nx">water</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">weight</span><span class="p">;</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">totalWater</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w"> </span><span class="c1">// 最大値100で正規化</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="_22">降水短時間予報（ナウキャスト）<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>システム</th>
<th>役割・機能</th>
<th>技術的背景</th>
<th>効果・用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>降水ナウキャスト</td>
<td>1時間先まで5分刻みで降水分布を高精度予測</td>
<td>レーダー移動ベクトル解析・機械学習補正</td>
<td>局地大雨の早期把握でイベント中止・避難判断が迅速化</td>
</tr>
<tr>
<td>雷ナウキャスト</td>
<td>雷活動の10分間隔予測・警報</td>
<td>放電位置統計・大気不安定度解析</td>
<td>屋外作業・航空運航・イベント安全管理</td>
</tr>
<tr>
<td>竜巻発生確度ナウキャスト</td>
<td>竜巻発生の可能性をリアルタイム予測・警報</td>
<td>レーダー渦検出・環境場解析・確率予測</td>
<td>竜巻警戒・建設現場の安全確保・人的被害防止</td>
</tr>
</tbody>
</table>
<p><strong>シナリオ例:</strong><br />
・降水ナウキャストで30分後に局地豪雨が予測され、屋外イベントを即中止判断<br />
・竜巻発生確度ナウキャストで建設現場に緊急退避指示</p>
<h2 id="ai">AI・機械学習活用システム<a class="headerlink" href="#ai" title="Permanent link">&para;</a></h2>
<h3 id="ai_1">気象予測AI<a class="headerlink" href="#ai_1" title="Permanent link">&para;</a></h3>
<h4 id="_23">深層学習による予報精度向上<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>用途</th>
<th>技術的強み</th>
<th>導入事例</th>
</tr>
</thead>
<tbody>
<tr>
<td>数値予報の後処理、極端気象・局地現象の予測、アンサンブル統計処理、観測データ品質管理</td>
<td>物理モデルでは困難な非線形・局地現象も学習可能。大規模データからパターン抽出し予測精度を大幅向上</td>
<td>Google DeepMind GraphCast、NVIDIA FourCastNet、気象庁AI予報、民間気象会社AI降水予測</td>
</tr>
</tbody>
</table>
<h5 id="_24">技術背景<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h5>
<ul>
<li>AIは数値モデルの誤差補正や極端現象の早期検知に有効  </li>
<li>アンサンブル予報の統計後処理や観測データの異常検知にも活用  </li>
<li>実装例：GraphCastは物理モデル並みの精度で高速予測が可能</li>
</ul>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<p>この TypeScript 実装では、深層学習を活用した気象予測モデルを実装しています。
衛星データ、レーダーデータ、数値予報モデルを統合し、豪雨や台風の発生予測を高精度に行います。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 機械学習による気象予測システム</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">tf</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@tensorflow/tfjs&#39;</span><span class="p">;</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherDatapoint</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">temperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pressure</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windDirection</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ForecastInput</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">historicalData</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDatapoint</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">numericalForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDatapoint</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">satellite</span><span class="o">:</span><span class="w"> </span><span class="kt">SatelliteData</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">radar</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarData</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">WeatherPredictionAI</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="kt">tf.LayersModel</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">scaler</span><span class="o">:</span><span class="w"> </span><span class="kt">DataScaler</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">featureExtractor</span><span class="o">:</span><span class="w"> </span><span class="kt">FeatureExtractor</span><span class="p">;</span>

<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">initialize</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 事前訓練されたモデルの読み込み</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">tf</span><span class="p">.</span><span class="nx">loadLayersModel</span><span class="p">(</span><span class="s1">&#39;/models/weather-prediction/model.json&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">scaler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DataScaler</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">featureExtractor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">FeatureExtractor</span><span class="p">();</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Weather Prediction AI initialized&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 短期降水予測（1-6時間先）</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">predictPrecipitation</span><span class="p">(</span>
<span class="w">    </span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastInput</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecastHours</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">PrecipitationForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 特徴量抽出</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractFeatures</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// データ正規化</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">normalizedFeatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">scaler</span><span class="p">.</span><span class="nx">normalize</span><span class="p">(</span><span class="nx">features</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 時系列データのテンソル変換</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">inputTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tf</span><span class="p">.</span><span class="nx">tensor3d</span><span class="p">(</span><span class="nx">normalizedFeatures</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">features</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">length</span><span class="p">]);</span>

<span class="w">    </span><span class="c1">// 予測実行</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">prediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">predict</span><span class="p">(</span><span class="nx">inputTensor</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">tf</span><span class="p">.</span><span class="nx">Tensor</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">predictionData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">prediction</span><span class="p">.</span><span class="nx">data</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 結果の後処理</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">postProcessPrediction</span><span class="p">(</span><span class="nx">predictionData</span><span class="p">,</span><span class="w"> </span><span class="nx">forecastHours</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// メモリクリーンアップ</span>
<span class="w">    </span><span class="nx">inputTensor</span><span class="p">.</span><span class="nx">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="nx">prediction</span><span class="p">.</span><span class="nx">dispose</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">forecast</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 特徴量抽出</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">extractFeatures</span><span class="p">(</span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastInput</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">number</span><span class="p">[][]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">features</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 時系列特徴量</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">historicalData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">datapoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">historicalData</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeFeatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">temperature</span><span class="p">,</span>
<span class="w">        </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">humidity</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">        </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">pressure</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1013.25</span><span class="p">,</span>
<span class="w">        </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">windSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">windDirection</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="p">),</span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">windDirection</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="p">),</span>
<span class="w">        </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">,</span>
<span class="w">        </span><span class="c1">// 時間的特徴</span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">24</span><span class="p">),</span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">24</span><span class="p">),</span>
<span class="w">        </span><span class="c1">// 季節的特徴</span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">12</span><span class="p">),</span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">12</span><span class="p">)</span>
<span class="w">      </span><span class="p">];</span>

<span class="w">      </span><span class="c1">// 数値予報との差分特徴量</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">numericalForecast</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">nwpData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">numericalForecast</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">        </span><span class="nx">timeFeatures</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
<span class="w">          </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">temperature</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">nwpData</span><span class="p">.</span><span class="nx">temperature</span><span class="p">,</span>
<span class="w">          </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">humidity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">nwpData</span><span class="p">.</span><span class="nx">humidity</span><span class="p">,</span>
<span class="w">          </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">pressure</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">nwpData</span><span class="p">.</span><span class="nx">pressure</span><span class="p">,</span>
<span class="w">          </span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">precipitation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">nwpData</span><span class="p">.</span><span class="nx">precipitation</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">features</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">timeFeatures</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 衛星・レーダー特徴量</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">satelliteFeatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractSatelliteFeatures</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">satellite</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">radarFeatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractRadarFeatures</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">radar</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 特徴量結合</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">satelliteFeatures</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="nx">radarFeatures</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">features</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 衛星データからの特徴量抽出</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">extractSatelliteFeatures</span><span class="p">(</span><span class="nx">satelliteData</span><span class="o">:</span><span class="w"> </span><span class="kt">SatelliteData</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">satelliteData</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">cloudTopTemperature</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">273.15</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">waterVaporChannel</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">infraredChannel</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">visibleChannel</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">calculateCloudTextureFeatures</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">imageData</span><span class="p">)</span>
<span class="w">    </span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// レーダーデータからの特徴量抽出</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">extractRadarFeatures</span><span class="p">(</span><span class="nx">radarData</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarData</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">radarData</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">maxReflectivity</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">70</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">echoTop</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">20000</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">vil</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="p">.</span><span class="nx">maxVelocity</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">50</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEchoMovementFeatures</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="w">    </span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 雲テクスチャ特徴量の計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateCloudTextureFeatures</span><span class="p">(</span><span class="nx">imageData</span><span class="o">:</span><span class="w"> </span><span class="kt">ImageData</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// グレーレベル共起行列（GLCM）による特徴量計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">glcm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateGLCM</span><span class="p">(</span><span class="nx">imageData</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateContrast</span><span class="p">(</span><span class="nx">glcm</span><span class="p">),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateHomogeneity</span><span class="p">(</span><span class="nx">glcm</span><span class="p">),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEntropy</span><span class="p">(</span><span class="nx">glcm</span><span class="p">),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateMean</span><span class="p">(</span><span class="nx">glcm</span><span class="p">)</span>
<span class="w">    </span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// エコー移動特徴量の計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateEchoMovementFeatures</span><span class="p">(</span><span class="nx">radarData</span><span class="o">:</span><span class="w"> </span><span class="kt">RadarData</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// オプティカルフロー解析によるエコー移動ベクトル</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">movementVectors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateOpticalFlow</span><span class="p">(</span><span class="nx">radarData</span><span class="p">.</span><span class="nx">reflectivityField</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="nx">movementVectors</span><span class="p">.</span><span class="nx">meanSpeed</span><span class="p">,</span>
<span class="w">      </span><span class="nx">movementVectors</span><span class="p">.</span><span class="nx">meanDirection</span><span class="p">,</span>
<span class="w">      </span><span class="nx">movementVectors</span><span class="p">.</span><span class="nx">convergence</span><span class="p">,</span>
<span class="w">      </span><span class="nx">movementVectors</span><span class="p">.</span><span class="nx">vorticity</span>
<span class="w">    </span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 結果の後処理</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">postProcessPrediction</span><span class="p">(</span>
<span class="w">    </span><span class="nx">predictionData</span><span class="o">:</span><span class="w"> </span><span class="kt">Float32Array</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecastHours</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">PrecipitationForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeSteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">predictionData</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">forecastHours</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">PrecipitationTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">forecastHours</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">hourData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">predictionData</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">h</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">timeSteps</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">timeSteps</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 確率的予測の統計値計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hourData</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">hourData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hourData</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">mean</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">hourData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">variance</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 降水確率の計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">precipProbability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hourData</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.1</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">hourData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

<span class="w">      </span><span class="nx">forecast</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">precipitationMean</span><span class="o">:</span><span class="w"> </span><span class="kt">mean</span><span class="p">,</span>
<span class="w">        </span><span class="nx">precipitationStd</span><span class="o">:</span><span class="w"> </span><span class="kt">std</span><span class="p">,</span>
<span class="w">        </span><span class="nx">precipitationProbability</span><span class="o">:</span><span class="w"> </span><span class="kt">precipProbability</span><span class="p">,</span>
<span class="w">        </span><span class="nx">confidenceInterval</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">lower</span><span class="o">:</span><span class="w"> </span><span class="kt">mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.96</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">std</span><span class="p">,</span>
<span class="w">          </span><span class="nx">upper</span><span class="o">:</span><span class="w"> </span><span class="kt">mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.96</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">std</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">validPeriod</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">forecastHours</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">timeSteps</span><span class="o">:</span><span class="w"> </span><span class="kt">forecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">modelConfidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateModelConfidence</span><span class="p">(</span><span class="nx">forecast</span><span class="p">),</span>
<span class="w">      </span><span class="nx">uncertainty</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallUncertainty</span><span class="p">(</span><span class="nx">forecast</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// アンサンブル予測</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">generateEnsembleForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastInput</span><span class="p">,</span>
<span class="w">    </span><span class="nx">ensembleSize</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">EnsembleForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">PrecipitationForecast</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">ensembleSize</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// ノイズ注入によるアンサンブル生成</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">noisyInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">addInputNoise</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictPrecipitation</span><span class="p">(</span><span class="nx">noisyInput</span><span class="p">);</span>
<span class="w">      </span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">forecast</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEnsembleStatistics</span><span class="p">(</span><span class="nx">forecasts</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// アンサンブル統計計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateEnsembleStatistics</span><span class="p">(</span><span class="nx">forecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">PrecipitationForecast</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">EnsembleForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ensembleSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecastHours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecasts</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">timeSteps</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ensembleStats</span><span class="o">:</span><span class="w"> </span><span class="kt">EnsembleTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">forecastHours</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">hourlyValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">f</span><span class="p">.</span><span class="nx">timeSteps</span><span class="p">[</span><span class="nx">h</span><span class="p">].</span><span class="nx">precipitationMean</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">hourlyProbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecasts</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">f</span><span class="p">.</span><span class="nx">timeSteps</span><span class="p">[</span><span class="nx">h</span><span class="p">].</span><span class="nx">precipitationProbability</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 統計値計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hourlyValues</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">ensembleSize</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hourlyValues</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">mean</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">ensembleSize</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">spread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">variance</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 確率分布</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">exceedanceProbabilities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">threshold</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">50</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">exceedanceProbabilities</span><span class="p">[</span><span class="nx">threshold</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">          </span><span class="nx">hourlyValues</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">threshold</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">ensembleSize</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">ensembleStats</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">ensembleMean</span><span class="o">:</span><span class="w"> </span><span class="kt">mean</span><span class="p">,</span>
<span class="w">        </span><span class="nx">ensembleSpread</span><span class="o">:</span><span class="w"> </span><span class="kt">spread</span><span class="p">,</span>
<span class="w">        </span><span class="nx">precipitationProbability</span><span class="o">:</span><span class="w"> </span><span class="kt">hourlyProbs.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">ensembleSize</span><span class="p">,</span>
<span class="w">        </span><span class="nx">exceedanceProbabilities</span><span class="p">,</span>
<span class="w">        </span><span class="nx">percentiles</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">p10</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePercentile</span><span class="p">(</span><span class="nx">hourlyValues</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">),</span>
<span class="w">          </span><span class="nx">p25</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePercentile</span><span class="p">(</span><span class="nx">hourlyValues</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="p">),</span>
<span class="w">          </span><span class="nx">p50</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePercentile</span><span class="p">(</span><span class="nx">hourlyValues</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">),</span>
<span class="w">          </span><span class="nx">p75</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePercentile</span><span class="p">(</span><span class="nx">hourlyValues</span><span class="p">,</span><span class="w"> </span><span class="mf">0.75</span><span class="p">),</span>
<span class="w">          </span><span class="nx">p90</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePercentile</span><span class="p">(</span><span class="nx">hourlyValues</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">ensembleSize</span><span class="p">,</span>
<span class="w">      </span><span class="nx">timeSteps</span><span class="o">:</span><span class="w"> </span><span class="kt">ensembleStats</span><span class="p">,</span>
<span class="w">      </span><span class="nx">reliability</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateEnsembleReliability</span><span class="p">(</span><span class="nx">forecasts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">sharpness</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateEnsembleSharpness</span><span class="p">(</span><span class="nx">ensembleStats</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 降水量分級予測</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">predictPrecipitationCategory</span><span class="p">(</span>
<span class="w">    </span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastInput</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">CategoryForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// カテゴリ別の確率予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">categories</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;no_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">0.1</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;moderate_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">5</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;heavy_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">20</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;very_heavy_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">50</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;extreme_rain&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">];</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractFeatures</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">categoryPredictions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">predict</span><span class="p">(</span><span class="nx">tf</span><span class="p">.</span><span class="nx">tensor3d</span><span class="p">([</span><span class="nx">features</span><span class="p">]));</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">probabilities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="p">(</span><span class="nx">categoryPredictions</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">tf</span><span class="p">.</span><span class="nx">Tensor</span><span class="p">).</span><span class="nx">data</span><span class="p">();</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">categoryForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">CategoryPrediction</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">categories</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">cat</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">cat.name</span><span class="p">,</span>
<span class="w">      </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">cat.threshold</span><span class="p">,</span>
<span class="w">      </span><span class="nx">probability</span><span class="o">:</span><span class="w"> </span><span class="kt">probabilities</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateCategoryConfidence</span><span class="p">(</span><span class="nx">probabilities</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span>
<span class="w">    </span><span class="p">}));</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">categories</span><span class="o">:</span><span class="w"> </span><span class="kt">categoryForecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">mostLikelyCategory</span><span class="o">:</span><span class="w"> </span><span class="kt">categoryForecast.reduce</span><span class="p">((</span><span class="nx">max</span><span class="p">,</span><span class="w"> </span><span class="nx">cat</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="nx">cat</span><span class="p">.</span><span class="nx">probability</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">max</span><span class="p">.</span><span class="nx">probability</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">max</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nx">overallConfidence</span><span class="o">:</span><span class="w"> </span><span class="kt">categoryForecast.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">cat</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">cat</span><span class="p">.</span><span class="nx">confidence</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">categories</span><span class="p">.</span><span class="nx">length</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// モデル性能の評価</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">evaluateModel</span><span class="p">(</span><span class="nx">testData</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDatapoint</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ModelPerformance</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">predictions</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">observations</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">datapoint</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">testData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">prediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictPrecipitation</span><span class="p">({</span>
<span class="w">        </span><span class="nx">historicalData</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">datapoint</span><span class="p">],</span>
<span class="w">        </span><span class="nx">numericalForecast</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">        </span><span class="nx">satellite</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">        </span><span class="nx">radar</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="nx">predictions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">prediction</span><span class="p">.</span><span class="nx">timeSteps</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">precipitationMean</span><span class="p">);</span>
<span class="w">      </span><span class="nx">observations</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">datapoint</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">rmse</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateRMSE</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">      </span><span class="nx">mae</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateMAE</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">      </span><span class="nx">correlation</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateCorrelation</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">      </span><span class="nx">bias</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateBias</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">      </span><span class="nx">skillScore</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateSkillScore</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">      </span><span class="nx">probabilisticScores</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">brier</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateBrierScore</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">        </span><span class="nx">roc</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateROCScore</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">),</span>
<span class="w">        </span><span class="nx">reliability</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateReliabilityScore</span><span class="p">(</span><span class="nx">predictions</span><span class="p">,</span><span class="w"> </span><span class="nx">observations</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// データスケール調整クラス</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">DataScaler</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">scalingParameters</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">std</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>

<span class="w">  </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">normalized</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">normalized</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">scalingParameters</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="p">,</span><span class="w"> </span><span class="nx">std</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="nx">normalized</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">mean</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">std</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">normalized</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">denormalize</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][],</span><span class="w"> </span><span class="nx">featureIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">scalingParameters</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">featureIndex</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">mean</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="p">,</span><span class="w"> </span><span class="nx">std</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">row</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">row</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">std</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">params</span><span class="p">.</span><span class="nx">mean</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">fit</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][])</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">row</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">mean</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">),</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">variance</span><span class="p">);</span>

<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">scalingParameters</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">mean</span><span class="p">,</span><span class="w"> </span><span class="nx">std</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">PrecipitationTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">precipitationMean</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">precipitationStd</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">precipitationProbability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidenceInterval</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">lower</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">upper</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">PrecipitationForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">validPeriod</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">    </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">timeSteps</span><span class="o">:</span><span class="w"> </span><span class="kt">PrecipitationTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">modelConfidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">uncertainty</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">EnsembleTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">ensembleMean</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">ensembleSpread</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">precipitationProbability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">exceedanceProbabilities</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="kt">number</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">percentiles</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">p10</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">p25</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">p50</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">p75</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">p90</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">EnsembleForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">ensembleSize</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timeSteps</span><span class="o">:</span><span class="w"> </span><span class="kt">EnsembleTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">reliability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sharpness</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">CategoryPrediction</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">probability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">CategoryForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">categories</span><span class="o">:</span><span class="w"> </span><span class="kt">CategoryPrediction</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">mostLikelyCategory</span><span class="o">:</span><span class="w"> </span><span class="kt">CategoryPrediction</span><span class="p">;</span>
<span class="w">  </span><span class="nx">overallConfidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ModelPerformance</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">rmse</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">mae</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">correlation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">bias</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">skillScore</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">probabilisticScores</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">brier</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">roc</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">reliability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SatelliteData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cloudTopTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">waterVaporChannel</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">infraredChannel</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">visibleChannel</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">imageData</span><span class="o">:</span><span class="w"> </span><span class="kt">ImageData</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">RadarData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxReflectivity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">echoTop</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">vil</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxVelocity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">reflectivityField</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="ai_2">異常気象検知AI<a class="headerlink" href="#ai_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>用途</th>
<th>技術的強み</th>
<th>導入事例</th>
</tr>
</thead>
<tbody>
<tr>
<td>気象データ異常検知・観測機器故障診断・極端現象早期発見・品質管理自動化</td>
<td>教師なし学習で未知の異常も検知。時系列・空間解析を組み合わせ多次元異常を抽出</td>
<td>気象庁の観測品質自動監視、民間サービスの異常値除去、極端現象の自動アラート</td>
</tr>
</tbody>
</table>
<p><strong>技術背景:</strong><br />
- AIで観測機器の異常や極端気象のシグナルを自動検出<br />
- データ品質の維持・災害早期警戒の強化に貢献</p>
<h2 id="_25">専門分野別システム<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h2>
<h3 id="_26">農業気象システム<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<h4 id="_27">営農支援システム<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム</th>
<th>技術的背景・機能</th>
<th>実運用例・メリット</th>
</tr>
</thead>
<tbody>
<tr>
<td>アグリウェザー</td>
<td>作物モデル連携・病害虫発生予測・生育判定・農業特化気象警報</td>
<td>適期作業判断・防除効率化・収量予測で販売戦略強化</td>
</tr>
<tr>
<td>圃場管理システム</td>
<td>IoTセンサー・衛星データ統合、1km以下高解像度予報</td>
<td>灌水・施肥の最適化、災害対策準備、精密農業実現</td>
</tr>
</tbody>
</table>
<h5 id="_28">技術背景<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h5>
<ul>
<li>作物生育モデルや病害虫リスクモデルと気象データを統合  </li>
<li>IoT・衛星・局所気象予報を組み合わせた圃場単位の最適管理  </li>
<li>収量予測や適期収穫判断など農業経営の高度化に寄与</li>
</ul>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<p>この TypeScript 実装では、農業気象支援やエネルギー分野の気象予測を行います。
作物の生育ステージ管理、病害虫リスク評価、風力・太陽光発電の発電予測などに対応しています。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 農業気象支援システム</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">CropGrowthStage</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">stage</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">gdd</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 積算温度</span>
<span class="w">  </span><span class="nx">daysFromPlanting</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">characteristics</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AgricultureWeatherData</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">WeatherDatapoint</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">soilTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">soilMoisture</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">solarRadiation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// MJ/m²</span>
<span class="w">  </span><span class="nx">evapotranspiration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// mm</span>
<span class="w">  </span><span class="nx">leafWetness</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0-1</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">AgriculturalWeatherSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cropModels</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">CropModel</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">diseaseModels</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">DiseaseModel</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 生育ステージの判定</span>
<span class="w">  </span><span class="nx">determineCropStage</span><span class="p">(</span>
<span class="w">    </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">plantingDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">,</span>
<span class="w">    </span><span class="nx">weatherHistory</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">CropGrowthStage</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cropModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cropModels</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cropType</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cropModel</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Crop model not found: </span><span class="si">${</span><span class="nx">cropType</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 積算温度の計算</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">gdd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">baseTemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">baseTemperature</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">weather</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">weatherHistory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">dailyGDD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">baseTemp</span><span class="p">));</span>
<span class="w">      </span><span class="nx">gdd</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">dailyGDD</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 生育ステージの判定</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">getStageByGDD</span><span class="p">(</span><span class="nx">gdd</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">stage</span><span class="o">:</span><span class="w"> </span><span class="kt">stage.name</span><span class="p">,</span>
<span class="w">      </span><span class="nx">gdd</span><span class="p">,</span>
<span class="w">      </span><span class="nx">daysFromPlanting</span><span class="o">:</span><span class="w"> </span><span class="kt">weatherHistory.length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">characteristics</span><span class="o">:</span><span class="w"> </span><span class="kt">stage.characteristics</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 病害虫発生リスク予測</span>
<span class="w">  </span><span class="nx">predictDiseaseRisk</span><span class="p">(</span>
<span class="w">    </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">diseaseType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">recentWeather</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">DiseaseRiskForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">diseaseModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">diseaseModels</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">diseaseType</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">diseaseModel</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Disease model not found: </span><span class="si">${</span><span class="nx">diseaseType</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 現在のリスク評価</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateCurrentDiseaseRisk</span><span class="p">(</span>
<span class="w">      </span><span class="nx">diseaseModel</span><span class="p">,</span>
<span class="w">      </span><span class="nx">recentWeather</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">7</span><span class="p">)</span><span class="w"> </span><span class="c1">// 過去7日間</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 将来リスク予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">futureRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecast</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">weather</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">      </span><span class="nx">riskLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateDiseaseRisk</span><span class="p">(</span><span class="nx">diseaseModel</span><span class="p">,</span><span class="w"> </span><span class="nx">weather</span><span class="p">),</span>
<span class="w">      </span><span class="nx">environmentalFactors</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">temperature</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.temperature</span><span class="p">,</span>
<span class="w">        </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.humidity</span><span class="p">,</span>
<span class="w">        </span><span class="nx">leafWetness</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.leafWetness</span><span class="p">,</span>
<span class="w">        </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.precipitation</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}));</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">currentRisk</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">futureRisk</span><span class="p">,</span>
<span class="w">      </span><span class="nx">peakRiskDate</span><span class="o">:</span><span class="w"> </span><span class="kt">this.findPeakRiskDate</span><span class="p">(</span><span class="nx">futureRisk</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendedActions</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateDiseaseRecommendations</span><span class="p">(</span><span class="nx">currentRisk</span><span class="p">,</span><span class="w"> </span><span class="nx">futureRisk</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 灌水推奨システム</span>
<span class="w">  </span><span class="nx">calculateIrrigationRecommendation</span><span class="p">(</span>
<span class="w">    </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">soilType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">recentWeather</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">IrrigationRecommendation</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cropModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cropModels</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cropType</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cropModel</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Crop model not found: </span><span class="si">${</span><span class="nx">cropType</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 土壌水分収支計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentSoilMoisture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSoilWaterBalance</span><span class="p">(</span>
<span class="w">      </span><span class="nx">soilType</span><span class="p">,</span>
<span class="w">      </span><span class="nx">recentWeather</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 蒸発散量予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">etForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecast</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">weather</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEvapotranspiration</span><span class="p">(</span><span class="nx">weather</span><span class="p">,</span><span class="w"> </span><span class="nx">cropType</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 土壌水分予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">soilMoistureForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictSoilMoisture</span><span class="p">(</span>
<span class="w">      </span><span class="nx">currentSoilMoisture</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">etForecast</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 灌水判定</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">needsIrrigation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">soilMoistureForecast</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">sm</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">      </span><span class="nx">sm</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">willingPoint</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.8</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">needsIrrigation</span><span class="p">,</span>
<span class="w">      </span><span class="nx">currentSoilMoisture</span><span class="p">,</span>
<span class="w">      </span><span class="nx">soilMoistureForecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">recommendedAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">needsIrrigation</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateIrrigationAmount</span><span class="p">(</span><span class="nx">cropModel</span><span class="p">,</span><span class="w"> </span><span class="nx">soilType</span><span class="p">,</span><span class="w"> </span><span class="nx">soilMoistureForecast</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="w">      </span><span class="nx">optimalTiming</span><span class="o">:</span><span class="w"> </span><span class="kt">needsIrrigation</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">findOptimalIrrigationTiming</span><span class="p">(</span><span class="nx">soilMoistureForecast</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nx">waterStressRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateWaterStressRisk</span><span class="p">(</span><span class="nx">soilMoistureForecast</span><span class="p">,</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 蒸発散量計算（Penman-Monteith式）</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateEvapotranspiration</span><span class="p">(</span>
<span class="w">    </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">,</span>
<span class="w">    </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cropModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cropModels</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cropType</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">Kc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cropModel</span><span class="o">?</span><span class="p">.</span><span class="nx">cropCoefficient</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// 作物係数</span>

<span class="w">    </span><span class="c1">// FAO Penman-Monteith式による基準蒸発散量計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSlopePressureCurve</span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">gamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.665</span><span class="p">;</span><span class="w"> </span><span class="c1">// 乾湿計定数</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">u2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">windSpeed</span><span class="p">;</span><span class="w"> </span><span class="c1">// 2m高度風速</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">es</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSaturationVaporPressure</span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">es</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">humidity</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">Rn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">solarRadiation</span><span class="p">;</span><span class="w"> </span><span class="c1">// 純放射量</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ET0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">0.408</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">delta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">Rn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">900</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">273</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">u2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">es</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">ea</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">                </span><span class="p">(</span><span class="nx">delta</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.34</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">u2</span><span class="p">));</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">ET0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">Kc</span><span class="p">;</span><span class="w"> </span><span class="c1">// 作物蒸発散量</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 収穫適期予測</span>
<span class="w">  </span><span class="nx">predictHarvestTiming</span><span class="p">(</span>
<span class="w">    </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">plantingDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">,</span>
<span class="w">    </span><span class="nx">weatherHistory</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">HarvestTimingForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cropModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cropModels</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cropType</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cropModel</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Crop model not found: </span><span class="si">${</span><span class="nx">cropType</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 現在の積算温度</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentGDD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateGDD</span><span class="p">(</span><span class="nx">weatherHistory</span><span class="p">,</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">baseTemperature</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 成熟までの必要積算温度</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maturityGDD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">maturityGDD</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">remainingGDD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">maturityGDD</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">currentGDD</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 予測積算温度で成熟日を推定</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">forecastGDD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">estimatedMaturityDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">forecast</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">dailyGDD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">temperature</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">baseTemperature</span><span class="p">);</span>
<span class="w">      </span><span class="nx">forecastGDD</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">dailyGDD</span><span class="p">;</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">forecastGDD</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">remainingGDD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">estimatedMaturityDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 品質への影響評価</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">qualityRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessHarvestQualityRisk</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">cropType</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">estimatedMaturityDate</span><span class="p">,</span>
<span class="w">      </span><span class="nx">currentMaturity</span><span class="o">:</span><span class="w"> </span><span class="kt">currentGDD</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">maturityGDD</span><span class="p">,</span>
<span class="w">      </span><span class="nx">remainingDays</span><span class="o">:</span><span class="w"> </span><span class="kt">estimatedMaturityDate</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">estimatedMaturityDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nx">qualityRisk</span><span class="p">,</span>
<span class="w">      </span><span class="nx">optimalHarvestWindow</span><span class="o">:</span><span class="w"> </span><span class="kt">this.findOptimalHarvestWindow</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">qualityRisk</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateHarvestRecommendations</span><span class="p">(</span><span class="nx">qualityRisk</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 気象災害リスク評価</span>
<span class="w">  </span><span class="nx">assessWeatherRisk</span><span class="p">(</span>
<span class="w">    </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">growthStage</span><span class="o">:</span><span class="w"> </span><span class="kt">CropGrowthStage</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">AgricultureWeatherData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">WeatherRiskAssessment</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">risks</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherRisk</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cropModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cropModels</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cropType</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">weather</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">forecast</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 霜害リスク</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">frostThreshold</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">risks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;FROST&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateFrostSeverity</span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="p">,</span><span class="w"> </span><span class="nx">growthStage</span><span class="p">),</span>
<span class="w">          </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.timestamp</span><span class="p">,</span>
<span class="w">          </span><span class="nx">impact</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Potential crop damage from frost&#39;</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 高温障害リスク</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">heatStressThreshold</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">risks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HEAT_STRESS&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateHeatStressSeverity</span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="p">,</span><span class="w"> </span><span class="nx">growthStage</span><span class="p">),</span>
<span class="w">          </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.timestamp</span><span class="p">,</span>
<span class="w">          </span><span class="nx">impact</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reduced yield due to heat stress&#39;</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 強風害リスク</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">windThreshold</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">risks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;WIND_DAMAGE&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateWindDamageSeverity</span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">windSpeed</span><span class="p">,</span><span class="w"> </span><span class="nx">growthStage</span><span class="p">),</span>
<span class="w">          </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.timestamp</span><span class="p">,</span>
<span class="w">          </span><span class="nx">impact</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Physical damage to crops from strong winds&#39;</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 豪雨害リスク</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">precipitation</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">cropModel</span><span class="p">.</span><span class="nx">floodingThreshold</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">risks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;FLOODING&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateFloodingSeverity</span><span class="p">(</span><span class="nx">weather</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">,</span><span class="w"> </span><span class="nx">growthStage</span><span class="p">),</span>
<span class="w">          </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">weather.timestamp</span><span class="p">,</span>
<span class="w">          </span><span class="nx">impact</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Root damage and disease risk from waterlogging&#39;</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallRisk</span><span class="p">(</span><span class="nx">risks</span><span class="p">),</span>
<span class="w">      </span><span class="nx">specificRisks</span><span class="o">:</span><span class="w"> </span><span class="kt">risks</span><span class="p">,</span>
<span class="w">      </span><span class="nx">mitigationMeasures</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateMitigationMeasures</span><span class="p">(</span><span class="nx">risks</span><span class="p">,</span><span class="w"> </span><span class="nx">cropType</span><span class="p">),</span>
<span class="w">      </span><span class="nx">monitoringRecommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateMonitoringRecommendations</span><span class="p">(</span><span class="nx">risks</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">DiseaseRiskForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">currentRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">DiseaseRisk</span><span class="p">;</span>
<span class="w">  </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">    </span><span class="nx">riskLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">environmentalFactors</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">peakRiskDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendedActions</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">IrrigationRecommendation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">needsIrrigation</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">currentSoilMoisture</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">soilMoistureForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">recommendedAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// mm</span>
<span class="w">  </span><span class="nx">optimalTiming</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">waterStressRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">HarvestTimingForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">estimatedMaturityDate</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">currentMaturity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0-1</span>
<span class="w">  </span><span class="nx">remainingDays</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">qualityRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">QualityRisk</span><span class="p">;</span>
<span class="w">  </span><span class="nx">optimalHarvestWindow</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span><span class="w"> </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherRiskAssessment</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">specificRisks</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherRisk</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">mitigationMeasures</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">monitoringRecommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherRisk</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;FROST&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;HEAT_STRESS&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;WIND_DAMAGE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;FLOODING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;DROUGHT&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">impact</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">CropModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">baseTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maturityGDD</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cropCoefficient</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">willingPoint</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">frostThreshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">heatStressThreshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windThreshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">floodingThreshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getStageByGDD</span><span class="p">(</span><span class="nx">gdd</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">characteristics</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">DiseaseModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">temperatureRange</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">min</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">max</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">humidityThreshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">leafWetnessHours</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">incubationPeriod</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="_29">エネルギー気象システム<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<h4 id="_30">再生可能エネルギー予測<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム</th>
<th>対象・技術的背景</th>
<th>効果・導入例</th>
</tr>
</thead>
<tbody>
<tr>
<td>風力発電予測</td>
<td>風況モデル・ウェイク効果・AI補正で発電量を高精度予測</td>
<td>電力需給最適化・系統安定化・O&amp;M効率化</td>
</tr>
<tr>
<td>太陽光発電予測</td>
<td>雲移動・日射量推定・パネル温度計算</td>
<td>需給調整精度向上・蓄電池制御最適化・電力市場競争力強化</td>
</tr>
</tbody>
</table>
<h5 id="_31">技術背景<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h5>
<ul>
<li>高解像度気象モデルとAIで気象変動の影響を精密に予測  </li>
<li>発電計画・需給調整・運用保守計画の最適化に不可欠</li>
</ul>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// 再生可能エネルギー予測システム</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">WindTurbineSpec</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">cutInSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">ratedSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">cutOutSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">ratedPower</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// MW</span>
<span class="w">  </span><span class="nx">hubHeight</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m</span>
<span class="w">  </span><span class="nx">rotorDiameter</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m</span>
<span class="w">  </span><span class="nx">powerCurve</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="p">{</span><span class="w"> </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">power</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SolarPanelSpec</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// MW</span>
<span class="w">  </span><span class="nx">efficiency</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// %</span>
<span class="w">  </span><span class="nx">temperatureCoeff</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// %/°C</span>
<span class="w">  </span><span class="nx">tiltAngle</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// degrees</span>
<span class="w">  </span><span class="nx">azimuthAngle</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// degrees</span>
<span class="w">  </span><span class="nx">area</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m²</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">RenewableEnergyForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 風力発電量予測</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">predictWindPower</span><span class="p">(</span>
<span class="w">    </span><span class="nx">turbineSpecs</span><span class="o">:</span><span class="w"> </span><span class="kt">WindTurbineSpec</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">windForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">WindForecastData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">siteLocation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">altitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WindPowerForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">powerForecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">PowerTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">forecastStep</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">windForecast</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 高度補正（指数法則）</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">hubWindSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">adjustWindSpeedForHeight</span><span class="p">(</span>
<span class="w">        </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">windSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
<span class="w">        </span><span class="nx">turbineSpecs</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">hubHeight</span><span class="p">,</span>
<span class="w">        </span><span class="nx">siteLocation</span><span class="p">.</span><span class="nx">altitude</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 地形補正</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">terrainCorrectedSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">applyTerrainCorrection</span><span class="p">(</span>
<span class="w">        </span><span class="nx">hubWindSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nx">siteLocation</span><span class="p">,</span>
<span class="w">        </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">windDirection</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// ウェイク効果の計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">wakeAdjustedSpeeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateWakeEffects</span><span class="p">(</span>
<span class="w">        </span><span class="nx">terrainCorrectedSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">windDirection</span><span class="p">,</span>
<span class="w">        </span><span class="nx">turbineSpecs</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 各タービンの発電量計算</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">totalPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">turbineSpecs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">turbineWindSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wakeAdjustedSpeeds</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">turbinePower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateTurbinePower</span><span class="p">(</span>
<span class="w">          </span><span class="nx">turbineSpecs</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
<span class="w">          </span><span class="nx">turbineWindSpeed</span><span class="p">,</span>
<span class="w">          </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">airDensity</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="nx">totalPower</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">turbinePower</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 可用率とメンテナンスの考慮</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">availabilityAdjustedPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">totalPower</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAvailabilityFactor</span><span class="p">();</span>

<span class="w">      </span><span class="nx">powerForecasts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">forecastStep.timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">terrainCorrectedSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nx">power</span><span class="o">:</span><span class="w"> </span><span class="kt">availabilityAdjustedPower</span><span class="p">,</span>
<span class="w">        </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">turbineSpecs.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">spec</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">spec</span><span class="p">.</span><span class="nx">ratedPower</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span>
<span class="w">        </span><span class="nx">capacityFactor</span><span class="o">:</span><span class="w"> </span><span class="kt">availabilityAdjustedPower</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">turbineSpecs</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">spec</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">spec</span><span class="p">.</span><span class="nx">ratedPower</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span>
<span class="w">        </span><span class="nx">uncertainty</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateWindUncertainty</span><span class="p">(</span><span class="nx">forecastStep</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">siteId</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateSiteId</span><span class="p">(</span><span class="nx">siteLocation</span><span class="p">),</span>
<span class="w">      </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">powerForecasts</span><span class="p">,</span>
<span class="w">      </span><span class="nx">aggregatedStatistics</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateAggregatedStats</span><span class="p">(</span><span class="nx">powerForecasts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallConfidence</span><span class="p">(</span><span class="nx">powerForecasts</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 風速の高度補正</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">adjustWindSpeedForHeight</span><span class="p">(</span>
<span class="w">    </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">measurementHeight</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">targetHeight</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">surfaceRoughness</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 指数法則による高度補正</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateShearExponent</span><span class="p">(</span><span class="nx">surfaceRoughness</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">targetHeight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">measurementHeight</span><span class="p">,</span><span class="w"> </span><span class="nx">alpha</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ウェイク効果の計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateWakeEffects</span><span class="p">(</span>
<span class="w">    </span><span class="nx">incomingWindSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">windDirection</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">turbineSpecs</span><span class="o">:</span><span class="w"> </span><span class="kt">WindTurbineSpec</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">adjustedSpeeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Array</span><span class="p">(</span><span class="nx">turbineSpecs</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="nx">incomingWindSpeed</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 簡単なウェイクモデル（Jensen/Park model）</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">turbineSpecs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">turbineSpecs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">j</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateTurbineDistance</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">j</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">angleDeviation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateAngleDeviation</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">j</span><span class="p">,</span><span class="w"> </span><span class="nx">windDirection</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 下流タービンのウェイク影響を計算</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isDownwind</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">j</span><span class="p">,</span><span class="w"> </span><span class="nx">windDirection</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">angleDeviation</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">30</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">wakeDeficit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateWakeDeficit</span><span class="p">(</span>
<span class="w">            </span><span class="nx">turbineSpecs</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
<span class="w">            </span><span class="nx">distance</span><span class="p">,</span>
<span class="w">            </span><span class="nx">incomingWindSpeed</span>
<span class="w">          </span><span class="p">);</span>
<span class="w">          </span><span class="nx">adjustedSpeeds</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">wakeDeficit</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">adjustedSpeeds</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// タービン出力計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateTurbinePower</span><span class="p">(</span>
<span class="w">    </span><span class="nx">turbineSpec</span><span class="o">:</span><span class="w"> </span><span class="kt">WindTurbineSpec</span><span class="p">,</span>
<span class="w">    </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">airDensity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.225</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// カットイン・カットアウト速度のチェック</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">turbineSpec</span><span class="p">.</span><span class="nx">cutInSpeed</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">turbineSpec</span><span class="p">.</span><span class="nx">cutOutSpeed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// パワーカーブから発電量を補間</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">power</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">turbineSpec</span><span class="p">.</span><span class="nx">ratedSpeed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">power</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">turbineSpec</span><span class="p">.</span><span class="nx">ratedPower</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">power</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">interpolatePowerCurve</span><span class="p">(</span><span class="nx">turbineSpec</span><span class="p">.</span><span class="nx">powerCurve</span><span class="p">,</span><span class="w"> </span><span class="nx">windSpeed</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 空気密度補正</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">densityRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">airDensity</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1.225</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">power</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">densityRatio</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 太陽光発電量予測</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">predictSolarPower</span><span class="p">(</span>
<span class="w">    </span><span class="nx">panelSpecs</span><span class="o">:</span><span class="w"> </span><span class="kt">SolarPanelSpec</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">solarForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">SolarForecastData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">siteLocation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">altitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SolarPowerForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">powerForecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">PowerTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">forecastStep</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">solarForecast</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 太陽位置の計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">sunPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSunPosition</span><span class="p">(</span>
<span class="w">        </span><span class="nx">siteLocation</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span>
<span class="w">        </span><span class="nx">siteLocation</span><span class="p">.</span><span class="nx">lon</span><span class="p">,</span>
<span class="w">        </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">timestamp</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 各パネルアレイの発電量計算</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">totalPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">panelSpec</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">panelSpecs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 入射角の計算</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">incidenceAngle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateIncidenceAngle</span><span class="p">(</span>
<span class="w">          </span><span class="nx">sunPosition</span><span class="p">,</span>
<span class="w">          </span><span class="nx">panelSpec</span><span class="p">.</span><span class="nx">tiltAngle</span><span class="p">,</span>
<span class="w">          </span><span class="nx">panelSpec</span><span class="p">.</span><span class="nx">azimuthAngle</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 直達・散乱日射の分離</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">directIrradiance</span><span class="p">,</span><span class="w"> </span><span class="nx">diffuseIrradiance</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">decomposeIrradiance</span><span class="p">(</span>
<span class="w">          </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">globalIrradiance</span><span class="p">,</span>
<span class="w">          </span><span class="nx">sunPosition</span><span class="p">.</span><span class="nx">elevation</span><span class="p">,</span>
<span class="w">          </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">clearSkyIndex</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="c1">// パネル面日射量の計算</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">panelIrradiance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculatePanelIrradiance</span><span class="p">(</span>
<span class="w">          </span><span class="nx">directIrradiance</span><span class="p">,</span>
<span class="w">          </span><span class="nx">diffuseIrradiance</span><span class="p">,</span>
<span class="w">          </span><span class="nx">incidenceAngle</span><span class="p">,</span>
<span class="w">          </span><span class="nx">panelSpec</span><span class="p">.</span><span class="nx">tiltAngle</span><span class="p">,</span>
<span class="w">          </span><span class="nx">sunPosition</span><span class="p">.</span><span class="nx">elevation</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 温度効果の計算</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">panelTemperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculatePanelTemperature</span><span class="p">(</span>
<span class="w">          </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">airTemperature</span><span class="p">,</span>
<span class="w">          </span><span class="nx">panelIrradiance</span><span class="p">,</span>
<span class="w">          </span><span class="nx">forecastStep</span><span class="p">.</span><span class="nx">windSpeed</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">temperatureAdjustment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">panelSpec</span><span class="p">.</span><span class="nx">temperatureCoeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">panelTemperature</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">25</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// 発電量計算</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">panelPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">panelSpec</span><span class="p">.</span><span class="nx">capacity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">                          </span><span class="p">(</span><span class="nx">panelIrradiance</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">                          </span><span class="p">(</span><span class="nx">panelSpec</span><span class="p">.</span><span class="nx">efficiency</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">                          </span><span class="nx">temperatureAdjustment</span><span class="w"> </span><span class="o">*</span>
<span class="w">                          </span><span class="k">this</span><span class="p">.</span><span class="nx">getSystemEfficiency</span><span class="p">();</span>

<span class="w">        </span><span class="nx">totalPower</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">panelPower</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">powerForecasts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">forecastStep.timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">solarIrradiance</span><span class="o">:</span><span class="w"> </span><span class="kt">forecastStep.globalIrradiance</span><span class="p">,</span>
<span class="w">        </span><span class="nx">power</span><span class="o">:</span><span class="w"> </span><span class="kt">totalPower</span><span class="p">,</span>
<span class="w">        </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">panelSpecs.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">spec</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">spec</span><span class="p">.</span><span class="nx">capacity</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span>
<span class="w">        </span><span class="nx">capacityFactor</span><span class="o">:</span><span class="w"> </span><span class="kt">totalPower</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">panelSpecs</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">spec</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">spec</span><span class="p">.</span><span class="nx">capacity</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span>
<span class="w">        </span><span class="nx">uncertainty</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateSolarUncertainty</span><span class="p">(</span><span class="nx">forecastStep</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">siteId</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateSiteId</span><span class="p">(</span><span class="nx">siteLocation</span><span class="p">),</span>
<span class="w">      </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">powerForecasts</span><span class="p">,</span>
<span class="w">      </span><span class="nx">aggregatedStatistics</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateAggregatedStats</span><span class="p">(</span><span class="nx">powerForecasts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallConfidence</span><span class="p">(</span><span class="nx">powerForecasts</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 太陽位置計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateSunPosition</span><span class="p">(</span>
<span class="w">    </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">elevation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">azimuth</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">dayOfYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getDayOfYear</span><span class="p">(</span><span class="nx">timestamp</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeZone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTimeZone</span><span class="p">(</span><span class="nx">longitude</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">solarTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSolarTime</span><span class="p">(</span><span class="nx">timestamp</span><span class="p">,</span><span class="w"> </span><span class="nx">longitude</span><span class="p">,</span><span class="w"> </span><span class="nx">timeZone</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 太陽の赤緯</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">declination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">23.45</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">360</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">284</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">dayOfYear</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">365</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// 時角</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">hourAngle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">solarTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">12</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 高度角</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">elevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">asin</span><span class="p">(</span>
<span class="w">      </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">declination</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">latitude</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">declination</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">latitude</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">      </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">hourAngle</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 方位角</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">azimuth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">atan2</span><span class="p">(</span>
<span class="w">      </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">hourAngle</span><span class="p">),</span>
<span class="w">      </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">hourAngle</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">latitude</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="nb">Math</span><span class="p">.</span><span class="nx">tan</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">declination</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">latitude</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">180</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">180</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">elevation</span><span class="p">,</span><span class="w"> </span><span class="nx">azimuth</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 電力系統への影響評価</span>
<span class="w">  </span><span class="nx">assessGridImpact</span><span class="p">(</span>
<span class="w">    </span><span class="nx">renewableForecast</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">WindPowerForecast</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">SolarPowerForecast</span><span class="p">)[],</span>
<span class="w">    </span><span class="nx">gridDemand</span><span class="o">:</span><span class="w"> </span><span class="kt">PowerDemandForecast</span><span class="p">,</span>
<span class="w">    </span><span class="nx">storageCapacity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">GridImpactAssessment</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">impactAnalysis</span><span class="o">:</span><span class="w"> </span><span class="kt">GridImpactTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">gridDemand</span><span class="p">.</span><span class="nx">forecast</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">demand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">gridDemand</span><span class="p">.</span><span class="nx">forecast</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalRenewable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">renewableForecast</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">rf</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">rf</span><span class="p">.</span><span class="nx">forecast</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">power</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span><span class="w"> </span><span class="mf">0</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 需給バランス</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">supplyDemandBalance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">totalRenewable</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">demand</span><span class="p">.</span><span class="nx">power</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 余剰・不足電力</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">surplus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">supplyDemandBalance</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">deficit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nx">supplyDemandBalance</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// ランプ率計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">rampRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
<span class="w">        </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">totalRenewable</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">renewableForecast</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">rf</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">          </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">rf</span><span class="p">.</span><span class="nx">forecast</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">power</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span><span class="w"> </span><span class="mf">0</span><span class="p">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 系統安定度評価</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">stabilityRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateStabilityRisk</span><span class="p">(</span>
<span class="w">        </span><span class="nx">totalRenewable</span><span class="p">,</span>
<span class="w">        </span><span class="nx">demand</span><span class="p">.</span><span class="nx">power</span><span class="p">,</span>
<span class="w">        </span><span class="nx">rampRate</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">impactAnalysis</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">demand.timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">renewableGeneration</span><span class="o">:</span><span class="w"> </span><span class="kt">totalRenewable</span><span class="p">,</span>
<span class="w">        </span><span class="nx">demand</span><span class="o">:</span><span class="w"> </span><span class="kt">demand.power</span><span class="p">,</span>
<span class="w">        </span><span class="nx">surplus</span><span class="p">,</span>
<span class="w">        </span><span class="nx">deficit</span><span class="p">,</span>
<span class="w">        </span><span class="nx">rampRate</span><span class="p">,</span>
<span class="w">        </span><span class="nx">stabilityRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">storageRecommendation</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateStorageRecommendation</span><span class="p">(</span>
<span class="w">          </span><span class="nx">surplus</span><span class="p">,</span>
<span class="w">          </span><span class="nx">deficit</span><span class="p">,</span>
<span class="w">          </span><span class="nx">storageCapacity</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">analysis</span><span class="o">:</span><span class="w"> </span><span class="kt">impactAnalysis</span><span class="p">,</span>
<span class="w">      </span><span class="nx">systemReliability</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateSystemReliability</span><span class="p">(</span><span class="nx">impactAnalysis</span><span class="p">),</span>
<span class="w">      </span><span class="nx">integrationChallenges</span><span class="o">:</span><span class="w"> </span><span class="kt">this.identifyIntegrationChallenges</span><span class="p">(</span><span class="nx">impactAnalysis</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateGridRecommendations</span><span class="p">(</span><span class="nx">impactAnalysis</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WindForecastData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windDirection</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">airDensity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">turbulence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SolarForecastData</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">globalIrradiance</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// W/m²</span>
<span class="w">  </span><span class="nx">directIrradiance</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// W/m²</span>
<span class="w">  </span><span class="nx">diffuseIrradiance</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// W/m²</span>
<span class="w">  </span><span class="nx">airTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// °C</span>
<span class="w">  </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">  </span><span class="nx">clearSkyIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cloudCover</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// %</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">PowerTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">windSpeed?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">solarIrradiance?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">power</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// MW</span>
<span class="w">  </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// MW</span>
<span class="w">  </span><span class="nx">capacityFactor</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">uncertainty</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WindPowerForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">siteId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">PowerTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">aggregatedStatistics</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">totalGeneration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">averageCapacityFactor</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">peakPower</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">variability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SolarPowerForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">siteId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">PowerTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">aggregatedStatistics</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">totalGeneration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">averageCapacityFactor</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">peakPower</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">variability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">GridImpactTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">renewableGeneration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">demand</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">surplus</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">deficit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">rampRate</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">stabilityRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">storageRecommendation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">charge</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">discharge</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">GridImpactAssessment</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">analysis</span><span class="o">:</span><span class="w"> </span><span class="kt">GridImpactTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">systemReliability</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">integrationChallenges</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="_32">交通気象システム<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<h4 id="_33">道路気象情報システム<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム</th>
<th>機能</th>
<th>技術的特徴</th>
<th>導入効果・事例</th>
</tr>
</thead>
<tbody>
<tr>
<td>路面状況監視システム</td>
<td>路面温度・湿度・凍結検知</td>
<td>IoTセンサー、画像解析、機械学習判定</td>
<td>凍結予測による事前凍結防止剤散布、事故件数の減少、除雪作業の効率化</td>
</tr>
<tr>
<td>視程・視界情報システム</td>
<td>濃霧・吹雪による視程障害監視</td>
<td>ライダー、気象カメラ、視程計</td>
<td>高速道路の通行止め判断、速度規制の最適化、ドライバーへのリアルタイム情報提供</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// 交通気象システム</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">RoadWeatherStation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">stationId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">altitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">sensors</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">roadSurfaceTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// °C</span>
<span class="w">    </span><span class="nx">airTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// °C</span>
<span class="w">    </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// %</span>
<span class="w">    </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m/s</span>
<span class="w">    </span><span class="nx">windDirection</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// degrees</span>
<span class="w">    </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// mm/h</span>
<span class="w">    </span><span class="nx">visibility</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// m</span>
<span class="w">    </span><span class="nx">roadSurfaceCondition</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DRY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;WET&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ICY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SNOWY&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">friction</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// μ</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TrafficWeatherAlert</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">alertId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ICE_WARNING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;FOG_WARNING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SNOW_WARNING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;FLOOD_WARNING&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;LOW&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">affectedRoads</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">validUntil</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">RoadWeatherSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">stations</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">RoadWeatherStation</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">alerts</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">TrafficWeatherAlert</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 路面状況の予測</span>
<span class="w">  </span><span class="nx">predictRoadConditions</span><span class="p">(</span>
<span class="w">    </span><span class="nx">stationId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherForecastData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">hoursAhead</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">24</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">RoadConditionForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">station</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">stations</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">stationId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">station</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Station not found: </span><span class="si">${</span><span class="nx">stationId</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">predictions</span><span class="o">:</span><span class="w"> </span><span class="kt">RoadConditionTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">hoursAhead</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">forecast</span><span class="p">[</span><span class="nx">h</span><span class="p">];</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">weatherStep</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 路面温度の予測</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">predictedRoadTemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictRoadSurfaceTemperature</span><span class="p">(</span>
<span class="w">        </span><span class="nx">station</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">h</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 路面状態の判定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">roadCondition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">determineRoadCondition</span><span class="p">(</span>
<span class="w">        </span><span class="nx">predictedRoadTemp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">.</span><span class="nx">airTemperature</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">.</span><span class="nx">precipitationType</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 凍結リスクの評価</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">freezingRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateFreezingRisk</span><span class="p">(</span>
<span class="w">        </span><span class="nx">predictedRoadTemp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">.</span><span class="nx">humidity</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">.</span><span class="nx">windSpeed</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 摩擦係数の推定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">frictionCoefficient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">estimateFrictionCoefficient</span><span class="p">(</span>
<span class="w">        </span><span class="nx">roadCondition</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherStep</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">,</span>
<span class="w">        </span><span class="nx">predictedRoadTemp</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">predictions</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">),</span>
<span class="w">        </span><span class="nx">roadSurfaceTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">predictedRoadTemp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">roadCondition</span><span class="p">,</span>
<span class="w">        </span><span class="nx">freezingRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">frictionCoefficient</span><span class="p">,</span>
<span class="w">        </span><span class="nx">visibility</span><span class="o">:</span><span class="w"> </span><span class="kt">weatherStep.visibility</span><span class="p">,</span>
<span class="w">        </span><span class="nx">recommendedSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateRecommendedSpeed</span><span class="p">(</span><span class="nx">roadCondition</span><span class="p">,</span><span class="w"> </span><span class="nx">frictionCoefficient</span><span class="p">),</span>
<span class="w">        </span><span class="nx">maintenanceAction</span><span class="o">:</span><span class="w"> </span><span class="kt">this.recommendMaintenanceAction</span><span class="p">(</span><span class="nx">roadCondition</span><span class="p">,</span><span class="w"> </span><span class="nx">freezingRisk</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">stationId</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">predictions</span><span class="p">,</span>
<span class="w">      </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallRoadRisk</span><span class="p">(</span><span class="nx">predictions</span><span class="p">),</span>
<span class="w">      </span><span class="nx">alertLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">this.determineAlertLevel</span><span class="p">(</span><span class="nx">predictions</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 路面温度予測モデル</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">predictRoadSurfaceTemperature</span><span class="p">(</span>
<span class="w">    </span><span class="nx">station</span><span class="o">:</span><span class="w"> </span><span class="kt">RoadWeatherStation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherForecastData</span><span class="p">,</span>
<span class="w">    </span><span class="nx">hoursAhead</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentRoadTemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">station</span><span class="p">.</span><span class="nx">sensors</span><span class="p">.</span><span class="nx">roadSurfaceTemperature</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">airTemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">airTemperature</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">solarRadiation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">solarRadiation</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">windSpeed</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cloudCover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">weather</span><span class="p">.</span><span class="nx">cloudCover</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 簡単な熱収支モデル</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">thermalInertia</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 路面の熱慣性</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">solarHeating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">solarRadiation</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cloudCover</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">convectiveHeating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">airTemp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">currentRoadTemp</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">radiativeCooling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">cloudCover</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">temperatureChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thermalInertia</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="nx">solarHeating</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">convectiveHeating</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">radiativeCooling</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">currentRoadTemp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">temperatureChange</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">hoursAhead</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 路面状態判定</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">determineRoadCondition</span><span class="p">(</span>
<span class="w">    </span><span class="nx">roadTemp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">airTemp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">precipType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;RAIN&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SNOW&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SLEET&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;NONE&#39;</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DRY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;WET&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ICY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SNOWY&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">precipitation</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">airTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;ICY&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DRY&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">precipType</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;SNOW&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="nx">precipType</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;RAIN&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;SNOWY&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;WET&#39;</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">precipType</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;SLEET&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;ICY&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;WET&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 凍結リスク計算</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">calculateFreezingRisk</span><span class="p">(</span>
<span class="w">    </span><span class="nx">roadTemp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">risk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 温度リスク</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">risk</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="mf">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// -10°Cで最大</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">roadTemp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">risk</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">roadTemp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 湿度リスク（霜・着氷）</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">humidity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">risk</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">humidity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">80</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 風速の影響（蒸発冷却）</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">risk</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 微風時は放射冷却が強い</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">risk</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 視程障害の監視</span>
<span class="w">  </span><span class="nx">monitorVisibility</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">VisibilityAlert</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">interval</span><span class="p">(</span><span class="mf">60000</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="w"> </span><span class="c1">// 1分間隔</span>
<span class="w">      </span><span class="nx">mergeMap</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">alerts</span><span class="o">:</span><span class="w"> </span><span class="kt">VisibilityAlert</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">stationId</span><span class="p">,</span><span class="w"> </span><span class="nx">station</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">stations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">visibility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">station</span><span class="p">.</span><span class="nx">sensors</span><span class="p">.</span><span class="nx">visibility</span><span class="p">;</span>

<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">visibility</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">50</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 50m未満</span>
<span class="w">            </span><span class="nx">alerts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">              </span><span class="nx">stationId</span><span class="p">,</span>
<span class="w">              </span><span class="nx">alertType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;SEVERE_FOG&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">visibility</span><span class="p">,</span>
<span class="w">              </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">affectedRoads</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getAffectedRoads</span><span class="p">(</span><span class="nx">stationId</span><span class="p">),</span>
<span class="w">              </span><span class="nx">recommendation</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Road closure recommended&#39;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">visibility</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 200m未満</span>
<span class="w">            </span><span class="nx">alerts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">              </span><span class="nx">stationId</span><span class="p">,</span>
<span class="w">              </span><span class="nx">alertType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DENSE_FOG&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">visibility</span><span class="p">,</span>
<span class="w">              </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">affectedRoads</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getAffectedRoads</span><span class="p">(</span><span class="nx">stationId</span><span class="p">),</span>
<span class="w">              </span><span class="nx">recommendation</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reduce speed to 30 km/h&#39;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">visibility</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">500</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 500m未満</span>
<span class="w">            </span><span class="nx">alerts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">              </span><span class="nx">stationId</span><span class="p">,</span>
<span class="w">              </span><span class="nx">alertType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MODERATE_FOG&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">visibility</span><span class="p">,</span>
<span class="w">              </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">affectedRoads</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getAffectedRoads</span><span class="p">(</span><span class="nx">stationId</span><span class="p">),</span>
<span class="w">              </span><span class="nx">recommendation</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reduce speed and increase following distance&#39;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kr">from</span><span class="p">(</span><span class="nx">alerts</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 除雪・凍結防止剤散布の最適化</span>
<span class="w">  </span><span class="nx">optimizeWinterMaintenance</span><span class="p">(</span>
<span class="w">    </span><span class="nx">roadSegments</span><span class="o">:</span><span class="w"> </span><span class="kt">RoadSegment</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">weatherForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherForecastData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">maintenanceResources</span><span class="o">:</span><span class="w"> </span><span class="kt">MaintenanceResource</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">MaintenancePlan</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">MaintenanceTask</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">segment</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">roadSegments</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">conditionForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictRoadConditions</span><span class="p">(</span>
<span class="w">        </span><span class="nx">segment</span><span class="p">.</span><span class="nx">stationId</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherForecast</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 凍結防止剤散布の判定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">saltingNeeded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">conditionForecast</span><span class="p">.</span><span class="nx">forecast</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">step</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="nx">step</span><span class="p">.</span><span class="nx">freezingRisk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">step</span><span class="p">.</span><span class="nx">roadCondition</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;ICY&#39;</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">saltingNeeded</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">saltingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateOptimalSaltingTime</span><span class="p">(</span><span class="nx">conditionForecast</span><span class="p">);</span>
<span class="w">        </span><span class="nx">tasks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;SALTING&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">segment</span><span class="o">:</span><span class="w"> </span><span class="kt">segment.id</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateTaskPriority</span><span class="p">(</span><span class="nx">segment</span><span class="p">,</span><span class="w"> </span><span class="nx">conditionForecast</span><span class="p">),</span>
<span class="w">          </span><span class="nx">scheduledTime</span><span class="o">:</span><span class="w"> </span><span class="kt">saltingTime</span><span class="p">,</span>
<span class="w">          </span><span class="nx">estimatedDuration</span><span class="o">:</span><span class="w"> </span><span class="kt">this.estimateSaltingDuration</span><span class="p">(</span><span class="nx">segment</span><span class="p">),</span>
<span class="w">          </span><span class="nx">resourceRequirement</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">vehicles</span><span class="o">:</span><span class="w"> </span><span class="kt">1</span><span class="p">,</span>
<span class="w">            </span><span class="nx">saltAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateSaltAmount</span><span class="p">(</span><span class="nx">segment</span><span class="p">)</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 除雪作業の判定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">snowAccumulation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSnowAccumulation</span><span class="p">(</span>
<span class="w">        </span><span class="nx">segment</span><span class="p">.</span><span class="nx">stationId</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weatherForecast</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">snowAccumulation</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 5cm以上の積雪予測</span>
<span class="w">        </span><span class="nx">tasks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;SNOW_REMOVAL&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">segment</span><span class="o">:</span><span class="w"> </span><span class="kt">segment.id</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateTaskPriority</span><span class="p">(</span><span class="nx">segment</span><span class="p">,</span><span class="w"> </span><span class="nx">conditionForecast</span><span class="p">),</span>
<span class="w">          </span><span class="nx">scheduledTime</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOptimalPlowingTime</span><span class="p">(</span><span class="nx">weatherForecast</span><span class="p">),</span>
<span class="w">          </span><span class="nx">estimatedDuration</span><span class="o">:</span><span class="w"> </span><span class="kt">this.estimatePlowingDuration</span><span class="p">(</span><span class="nx">segment</span><span class="p">,</span><span class="w"> </span><span class="nx">snowAccumulation</span><span class="p">),</span>
<span class="w">          </span><span class="nx">resourceRequirement</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">vehicles</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateRequiredPlows</span><span class="p">(</span><span class="nx">segment</span><span class="p">,</span><span class="w"> </span><span class="nx">snowAccumulation</span><span class="p">),</span>
<span class="w">            </span><span class="nx">saltAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 作業スケジュールの最適化</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">optimizedSchedule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeMaintenanceSchedule</span><span class="p">(</span>
<span class="w">      </span><span class="nx">tasks</span><span class="p">,</span>
<span class="w">      </span><span class="nx">maintenanceResources</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">optimizedSchedule</span><span class="p">,</span>
<span class="w">      </span><span class="nx">totalCost</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateTotalCost</span><span class="p">(</span><span class="nx">optimizedSchedule</span><span class="p">),</span>
<span class="w">      </span><span class="nx">resourceUtilization</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateResourceUtilization</span><span class="p">(</span><span class="nx">optimizedSchedule</span><span class="p">,</span><span class="w"> </span><span class="nx">maintenanceResources</span><span class="p">),</span>
<span class="w">      </span><span class="nx">expectedEffectiveness</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateExpectedEffectiveness</span><span class="p">(</span><span class="nx">optimizedSchedule</span><span class="p">,</span><span class="w"> </span><span class="nx">roadSegments</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 交通流への影響評価</span>
<span class="w">  </span><span class="nx">assessTrafficImpact</span><span class="p">(</span>
<span class="w">    </span><span class="nx">roadConditions</span><span class="o">:</span><span class="w"> </span><span class="kt">RoadConditionForecast</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">trafficVolume</span><span class="o">:</span><span class="w"> </span><span class="kt">TrafficVolumeData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">historicalAccidents</span><span class="o">:</span><span class="w"> </span><span class="kt">AccidentData</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">TrafficImpactAssessment</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">impactAnalysis</span><span class="o">:</span><span class="w"> </span><span class="kt">TrafficImpactTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">h</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">roadConditions</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">forecast</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="mf">24</span><span class="p">);</span><span class="w"> </span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">hourlyConditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">roadConditions</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">rc</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">rc</span><span class="p">.</span><span class="nx">forecast</span><span class="p">[</span><span class="nx">h</span><span class="p">]);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">hourlyVolume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">trafficVolume</span><span class="p">[</span><span class="nx">h</span><span class="p">];</span>

<span class="w">      </span><span class="c1">// 速度低下の予測</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">speedReduction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSpeedReduction</span><span class="p">(</span><span class="nx">hourlyConditions</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 容量低下の予測</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">capacityReduction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateCapacityReduction</span><span class="p">(</span><span class="nx">hourlyConditions</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 遅延時間の計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectedDelay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateExpectedDelay</span><span class="p">(</span>
<span class="w">        </span><span class="nx">speedReduction</span><span class="p">,</span>
<span class="w">        </span><span class="nx">capacityReduction</span><span class="p">,</span>
<span class="w">        </span><span class="nx">hourlyVolume</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 事故リスクの評価</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">accidentRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateAccidentRisk</span><span class="p">(</span>
<span class="w">        </span><span class="nx">hourlyConditions</span><span class="p">,</span>
<span class="w">        </span><span class="nx">hourlyVolume</span><span class="p">,</span>
<span class="w">        </span><span class="nx">historicalAccidents</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">impactAnalysis</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">speedReduction</span><span class="p">,</span>
<span class="w">        </span><span class="nx">capacityReduction</span><span class="p">,</span>
<span class="w">        </span><span class="nx">expectedDelay</span><span class="p">,</span>
<span class="w">        </span><span class="nx">accidentRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateTrafficRecommendations</span><span class="p">(</span>
<span class="w">          </span><span class="nx">hourlyConditions</span><span class="p">,</span>
<span class="w">          </span><span class="nx">accidentRisk</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">analysis</span><span class="o">:</span><span class="w"> </span><span class="kt">impactAnalysis</span><span class="p">,</span>
<span class="w">      </span><span class="nx">overallImpact</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallTrafficImpact</span><span class="p">(</span><span class="nx">impactAnalysis</span><span class="p">),</span>
<span class="w">      </span><span class="nx">economicCost</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateEconomicCost</span><span class="p">(</span><span class="nx">impactAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">trafficVolume</span><span class="p">),</span>
<span class="w">      </span><span class="nx">mitigationMeasures</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateMitigationMeasures</span><span class="p">(</span><span class="nx">impactAnalysis</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">RoadConditionTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">roadSurfaceTemperature</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">roadCondition</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DRY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;WET&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ICY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SNOWY&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">freezingRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">frictionCoefficient</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">visibility</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendedSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// km/h</span>
<span class="w">  </span><span class="nx">maintenanceAction</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;NONE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SALTING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SANDING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;PLOWING&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">RoadConditionForecast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">stationId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">RoadConditionTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">alertLevel</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;LOW&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">VisibilityAlert</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">stationId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">alertType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MODERATE_FOG&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;DENSE_FOG&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SEVERE_FOG&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">visibility</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">affectedRoads</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">recommendation</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">MaintenanceTask</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;SALTING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SANDING&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;SNOW_REMOVAL&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">segment</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">scheduledTime</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">estimatedDuration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// minutes</span>
<span class="w">  </span><span class="nx">resourceRequirement</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">vehicles</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">saltAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// kg</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">MaintenancePlan</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tasks</span><span class="o">:</span><span class="w"> </span><span class="kt">MaintenanceTask</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">totalCost</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">resourceUtilization</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">expectedEffectiveness</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TrafficImpactTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">speedReduction</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// %</span>
<span class="w">  </span><span class="nx">capacityReduction</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// %</span>
<span class="w">  </span><span class="nx">expectedDelay</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// minutes</span>
<span class="w">  </span><span class="nx">accidentRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0-1</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">TrafficImpactAssessment</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">analysis</span><span class="o">:</span><span class="w"> </span><span class="kt">TrafficImpactTimeStep</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">overallImpact</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">economicCost</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// yen</span>
<span class="w">  </span><span class="nx">mitigationMeasures</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="_34">海洋気象システム<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<h4 id="_35">海況予測システム<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム</th>
<th>対象</th>
<th>技術的特徴</th>
<th>活用例・メリット</th>
</tr>
</thead>
<tbody>
<tr>
<td>波浪予測システム</td>
<td>沿岸・沖合の波高・周期予測</td>
<td>スペクトル波浪モデル、風波・うねりの分離</td>
<td>港湾作業の安全管理、海上輸送の運航計画、マリンレジャーの安全確保</td>
</tr>
<tr>
<td>潮位・高潮予測システム</td>
<td>潮汐・高潮による水位変動予測</td>
<td>調和解析、気象力学モデル結合</td>
<td>港湾施設の浸水対策、漁業作業の最適化、沿岸防災情報の提供</td>
</tr>
</tbody>
</table>
<h2 id="_36">技術トレンドと将来展望<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h2>
<h3 id="_37">次世代気象システム<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<h4 id="_38">クラウド・エッジコンピューティング<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>技術</th>
<th>概要</th>
<th>メリット・効果</th>
<th>実装例</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラウドネイティブ気象システム</td>
<td>コンテナ・マイクロサービス基盤での気象処理</td>
<td>スケーラビリティ向上、運用自動化、コスト最適化</td>
<td>AWS/Azure上での気象データ処理、Kubernetesによる自動スケール</td>
</tr>
<tr>
<td>エッジコンピューティング</td>
<td>観測地点での即座の処理・判断</td>
<td>低遅延、帯域節約、リアルタイム警報</td>
<td>IoT気象センサーでの異常検知、現地での警報生成</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// クラウドネイティブ気象処理システム</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Container</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;inversify&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">observable</span><span class="p">,</span><span class="w"> </span><span class="nx">computed</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;mobx&#39;</span><span class="p">;</span>

<span class="c1">// マイクロサービスアーキテクチャ</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">processData</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDataBatch</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ProcessedWeatherData</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ForecastService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">generateForecast</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">ProcessedWeatherData</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WeatherForecast</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AlertService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">evaluateAlerts</span><span class="p">(</span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherForecast</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WeatherAlert</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// コンテナ化された気象データ処理</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">CloudWeatherProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">container</span><span class="o">:</span><span class="w"> </span><span class="kt">Container</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupDependencyInjection</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupDependencyInjection</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Container</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">bind</span><span class="o">&lt;</span><span class="nx">WeatherService</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;WeatherService&#39;</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="nx">DataProcessingService</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">bind</span><span class="o">&lt;</span><span class="nx">ForecastService</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;ForecastService&#39;</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="nx">ForecastGenerationService</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">bind</span><span class="o">&lt;</span><span class="nx">AlertService</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;AlertService&#39;</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="nx">AlertEvaluationService</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 自動スケーリング対応の処理パイプライン</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processWeatherPipeline</span><span class="p">(</span>
<span class="w">    </span><span class="nx">dataBatch</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDataBatch</span><span class="p">,</span>
<span class="w">    </span><span class="nx">processingConfig</span><span class="o">:</span><span class="w"> </span><span class="kt">ProcessingConfig</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WeatherProcessingResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// サービス取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">get</span><span class="o">&lt;</span><span class="nx">WeatherService</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;WeatherService&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecastService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">get</span><span class="o">&lt;</span><span class="nx">ForecastService</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;ForecastService&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">alertService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">get</span><span class="o">&lt;</span><span class="nx">AlertService</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;AlertService&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 並列処理でスループット向上</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">processingPromises</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dataBatch</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="nx">chunk</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 1. データ処理</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">processedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">weatherService</span><span class="p">.</span><span class="nx">processData</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 2. 予報生成</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">forecastService</span><span class="p">.</span><span class="nx">generateForecast</span><span class="p">(</span><span class="nx">processedData</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 3. 警報評価</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">alerts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">alertService</span><span class="p">.</span><span class="nx">evaluateAlerts</span><span class="p">(</span><span class="nx">forecast</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">processedData</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">alerts</span><span class="w"> </span><span class="p">};</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Processing error:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="nx">error</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">processingPromises</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">succeeded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span>
<span class="w">      </span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">PromiseFulfilledResult</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;fulfilled&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">failed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">results</span>
<span class="w">      </span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">PromiseRejectedResult</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;rejected&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">reason</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">succeeded</span><span class="p">,</span>
<span class="w">      </span><span class="nx">failed</span><span class="p">,</span>
<span class="w">      </span><span class="nx">successRate</span><span class="o">:</span><span class="w"> </span><span class="kt">succeeded.length</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">dataBatch</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">processingTime</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">dataBatch</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Kubernetes HPA (Horizontal Pod Autoscaler) 連携</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">getScalingMetrics</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ScalingMetrics</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">cpuUtilization</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getCPUUtilization</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">memoryUtilization</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getMemoryUtilization</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">queueLength</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getProcessingQueueLength</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">processingLatency</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAverageProcessingLatency</span><span class="p">()</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// エッジコンピューティング対応センサー</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">EdgeWeatherStation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">@observable</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="nx">sensorData</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="kd">@observable</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="nx">localAlerts</span><span class="o">:</span><span class="w"> </span><span class="kt">LocalAlert</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">edgeProcessor</span><span class="o">:</span><span class="w"> </span><span class="kt">EdgeProcessor</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">cloudSyncManager</span><span class="o">:</span><span class="w"> </span><span class="kt">CloudSyncManager</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">stationConfig</span><span class="o">:</span><span class="w"> </span><span class="kt">StationConfig</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">edgeProcessor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">EdgeProcessor</span><span class="p">(</span><span class="nx">stationConfig</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">cloudSyncManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">CloudSyncManager</span><span class="p">(</span><span class="nx">stationConfig</span><span class="p">.</span><span class="nx">cloudEndpoint</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイムデータ処理（エッジ）</span>
<span class="w">  </span><span class="kd">@action</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processRealTimeData</span><span class="p">(</span><span class="nx">reading</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">sensorData</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">reading</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// エッジでの即座の判定</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">localAnalysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">edgeProcessor</span><span class="p">.</span><span class="nx">analyzeReading</span><span class="p">(</span><span class="nx">reading</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 緊急状況の場合は即座にアラート</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">localAnalysis</span><span class="p">.</span><span class="nx">emergencyLevel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateEmergencyAlert</span><span class="p">(</span><span class="nx">reading</span><span class="p">,</span><span class="w"> </span><span class="nx">localAnalysis</span><span class="p">);</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">localAlerts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">alert</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 即座に配信</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">broadcastEmergencyAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 通常データはバッファリングしてクラウドに送信</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">shouldSyncToCloud</span><span class="p">(</span><span class="nx">reading</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cloudSyncManager</span><span class="p">.</span><span class="nx">queueForSync</span><span class="p">(</span><span class="nx">reading</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ローカル機械学習モデル</span>
<span class="w">  </span><span class="kd">@computed</span>
<span class="w">  </span><span class="nx">get</span><span class="w"> </span><span class="nx">anomalyScore</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sensorData</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">10</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">recentData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sensorData</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">10</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">edgeProcessor</span><span class="p">.</span><span class="nx">calculateAnomalyScore</span><span class="p">(</span><span class="nx">recentData</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 通信障害時の自律動作</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">autonomousOperation</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// クラウド接続チェック</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">isConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cloudSyncManager</span><span class="p">.</span><span class="nx">checkConnection</span><span class="p">();</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Operating in autonomous mode&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// ローカルストレージにデータ保存</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">saveDataLocally</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// ローカルモデルによる予測</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">localForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">edgeProcessor</span><span class="p">.</span><span class="nx">generateLocalForecast</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 近隣ステーションとの直接通信</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">communicateWithNearbyStations</span><span class="p">(</span><span class="nx">localForecast</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 5G/エッジクラウド連携</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">syncWithEdgeCloud</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">edgeCloudEndpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cloudSyncManager</span><span class="p">.</span><span class="nx">getEdgeCloudEndpoint</span><span class="p">();</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">edgeCloudEndpoint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// エッジクラウドでの高速処理</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">edgeProcessing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cloudSyncManager</span><span class="p">.</span><span class="nx">sendToEdgeCloud</span><span class="p">({</span>
<span class="w">        </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">this.sensorData</span><span class="p">,</span>
<span class="w">        </span><span class="nx">processingType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;REAL_TIME_ANALYSIS&#39;</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// 結果をローカルキャッシュ</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">cacheEdgeResults</span><span class="p">(</span><span class="nx">edgeProcessing</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// サーバーレス気象関数</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">ServerlessWeatherFunction</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// AWS Lambda / Azure Functions 対応</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">handleWeatherEvent</span><span class="p">(</span><span class="nx">event</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherEvent</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WeatherResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 関数のコールドスタート対策</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isWarm</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">warmUpFunction</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// メイン処理</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">processWeatherEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// メトリクス送信</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendMetrics</span><span class="p">({</span>
<span class="w">        </span><span class="nx">functionName</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;weather-processor&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">,</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">eventType</span><span class="o">:</span><span class="w"> </span><span class="kt">event.type</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendMetrics</span><span class="p">({</span>
<span class="w">        </span><span class="nx">functionName</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;weather-processor&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">,</span>
<span class="w">        </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">error.message</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="nx">error</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ストリーミング処理（Kinesis/Event Hubs）</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">handleDataStream</span><span class="p">(</span><span class="nx">records</span><span class="o">:</span><span class="w"> </span><span class="kt">StreamRecord</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">processedRecords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span>
<span class="w">      </span><span class="nx">records</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">record</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">processStreamRecord</span><span class="p">(</span><span class="nx">record</span><span class="p">))</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// バッチで後続処理へ送信</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToDownstream</span><span class="p">(</span><span class="nx">processedRecords</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// SQS/Service Bus メッセージ処理</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">handleQueueMessage</span><span class="p">(</span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">QueueMessage</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">processedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">processWeatherData</span><span class="p">(</span><span class="nx">weatherData</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 処理結果を別のキューに送信</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendToProcessedQueue</span><span class="p">(</span><span class="nx">processedData</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 元メッセージを削除</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">deleteMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ProcessingConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">parallelism</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">retryPolicy</span><span class="o">:</span><span class="w"> </span><span class="kt">RetryPolicy</span><span class="p">;</span>
<span class="w">  </span><span class="nx">qualityThreshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ScalingMetrics</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">cpuUtilization</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">memoryUtilization</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">queueLength</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">processingLatency</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">LocalAlert</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">;</span>
<span class="w">  </span><span class="nx">broadcastRadius</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// km</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">EdgeProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">analyzeReading</span><span class="p">(</span><span class="nx">reading</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">LocalAnalysis</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">calculateAnomalyScore</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">generateLocalForecast</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">LocalForecast</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">CloudSyncManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">queueForSync</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">checkConnection</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">boolean</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getEdgeCloudEndpoint</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sendToEdgeCloud</span><span class="p">(</span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h4 id="ai_3">AI・機械学習の進化<a class="headerlink" href="#ai_3" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>技術分野</th>
<th>現状→将来</th>
<th>期待される効果</th>
</tr>
</thead>
<tbody>
<tr>
<td>深層学習予測モデル</td>
<td>物理モデル補正→完全AI予測</td>
<td>計算時間1/100短縮、局地現象予測精度向上</td>
</tr>
<tr>
<td>説明可能AI</td>
<td>ブラックボックスAI→解釈可能AI</td>
<td>予報官の信頼性向上、意思決定根拠の明確化</td>
</tr>
<tr>
<td>強化学習</td>
<td>固定アルゴリズム→自律改善</td>
<td>予測精度の継続的向上、最適化の自動化</td>
</tr>
</tbody>
</table>
<h3 id="_39">デジタルツイン技術<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<h4 id="_40">気象デジタルツイン<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h4>
<p>用途・効果・実装例</p>
<table>
<thead>
<tr>
<th>用途</th>
<th>効果</th>
<th>実装例</th>
</tr>
</thead>
<tbody>
<tr>
<td>仮想気象環境での検証・実験、気象モデルの精度向上、極端現象のシミュレーション、政策立案支援</td>
<td>実世界では不可能な大規模実験、リスクゼロでの災害対応訓練、予測モデルの改善加速</td>
<td>NVIDIA Earth-2、欧州のDestination Earth、気象庁の次世代システム検討</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// 気象デジタルツインシステム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">WeatherDigitalTwin</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">physicalWeatherSystems</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">PhysicalWeatherStation</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">virtualEnvironment</span><span class="o">:</span><span class="w"> </span><span class="kt">VirtualWeatherEnvironment</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">syncEngine</span><span class="o">:</span><span class="w"> </span><span class="kt">SynchronizationEngine</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">simulationEngine</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherSimulationEngine</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">physicalWeatherSystems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">VirtualWeatherEnvironment</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">syncEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">SynchronizationEngine</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">simulationEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">WeatherSimulationEngine</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 物理システムとの同期</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">synchronizeWithReality</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SyncResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">physicalData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">collectPhysicalData</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">virtualState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">getCurrentState</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 状態差分の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stateDifference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateStateDifference</span><span class="p">(</span><span class="nx">physicalData</span><span class="p">,</span><span class="w"> </span><span class="nx">virtualState</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 同期精度が閾値を下回る場合はキャリブレーション</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">stateDifference</span><span class="p">.</span><span class="nx">accuracy</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.95</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calibrateVirtualEnvironment</span><span class="p">(</span><span class="nx">physicalData</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 仮想環境の更新</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">updateState</span><span class="p">(</span><span class="nx">physicalData</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">synchronizationTime</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">accuracy</span><span class="o">:</span><span class="w"> </span><span class="kt">stateDifference.accuracy</span><span class="p">,</span>
<span class="w">      </span><span class="nx">calibrated</span><span class="o">:</span><span class="w"> </span><span class="kt">stateDifference.accuracy</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span>
<span class="w">      </span><span class="nx">nextSyncTime</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateNextSyncTime</span><span class="p">(</span><span class="nx">stateDifference</span><span class="p">.</span><span class="nx">accuracy</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// What-ifシナリオ分析</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">runScenarioAnalysis</span><span class="p">(</span><span class="nx">scenarios</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherScenario</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ScenarioResult</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="o">:</span><span class="w"> </span><span class="kt">ScenarioResult</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">scenario</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">scenarios</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 仮想環境のスナップショット作成</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">baselineSnapshot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">createSnapshot</span><span class="p">();</span>

<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// シナリオ条件を適用</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">applyScenarioConditions</span><span class="p">(</span><span class="nx">scenario</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// シミュレーション実行</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">simulation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">simulationEngine</span><span class="p">.</span><span class="nx">runSimulation</span><span class="p">({</span>
<span class="w">          </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.duration</span><span class="p">,</span>
<span class="w">          </span><span class="nx">timeStep</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.timeStep</span><span class="p">,</span>
<span class="w">          </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.parameters</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="c1">// 結果分析</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">analysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeSimulationResults</span><span class="p">(</span><span class="nx">simulation</span><span class="p">);</span>

<span class="w">        </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">scenarioId</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.id</span><span class="p">,</span>
<span class="w">          </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.name</span><span class="p">,</span>
<span class="w">          </span><span class="nx">startConditions</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.initialConditions</span><span class="p">,</span>
<span class="w">          </span><span class="nx">endConditions</span><span class="o">:</span><span class="w"> </span><span class="kt">simulation.finalState</span><span class="p">,</span>
<span class="w">          </span><span class="nx">keyMetrics</span><span class="o">:</span><span class="w"> </span><span class="kt">analysis.keyMetrics</span><span class="p">,</span>
<span class="w">          </span><span class="nx">riskAssessment</span><span class="o">:</span><span class="w"> </span><span class="kt">analysis.riskAssessment</span><span class="p">,</span>
<span class="w">          </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">analysis.recommendations</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 元の状態に復元</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">restoreFromSnapshot</span><span class="p">(</span><span class="nx">baselineSnapshot</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">results</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 災害対応訓練シミュレーション</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">conductDisasterDrill</span><span class="p">(</span>
<span class="w">    </span><span class="nx">disasterType</span><span class="o">:</span><span class="w"> </span><span class="kt">DisasterType</span><span class="p">,</span>
<span class="w">    </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">,</span>
<span class="w">    </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoLocation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">participants</span><span class="o">:</span><span class="w"> </span><span class="kt">TrainingParticipant</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DrillResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 災害シナリオの生成</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">disasterScenario</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateDisasterScenario</span><span class="p">(</span>
<span class="w">      </span><span class="nx">disasterType</span><span class="p">,</span>
<span class="w">      </span><span class="nx">severity</span><span class="p">,</span>
<span class="w">      </span><span class="nx">location</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 仮想環境での災害発生</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">injectDisaster</span><span class="p">(</span><span class="nx">disasterScenario</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 参加者の対応監視</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">participantActions</span><span class="o">:</span><span class="w"> </span><span class="kt">ParticipantAction</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// リアルタイム状況更新とユーザー操作の記録</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">drillSession</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">startDrillSession</span><span class="p">(</span><span class="nx">participants</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">drillSession</span><span class="p">.</span><span class="nx">isActive</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">3600000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 1時間制限</span>
<span class="w">        </span><span class="c1">// 気象状況の進展</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">advanceTime</span><span class="p">(</span><span class="mf">300</span><span class="p">);</span><span class="w"> </span><span class="c1">// 5分進める</span>

<span class="w">        </span><span class="c1">// 参加者への情報配信</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentSituation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">getCurrentSituation</span><span class="p">();</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">broadcastSituationUpdate</span><span class="p">(</span><span class="nx">participants</span><span class="p">,</span><span class="w"> </span><span class="nx">currentSituation</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 参加者の行動記録</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">recordParticipantActions</span><span class="p">(</span><span class="nx">participants</span><span class="p">);</span>
<span class="w">        </span><span class="nx">participantActions</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nx">actions</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 状況判定</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">isDisasterResolved</span><span class="p">(</span><span class="nx">currentSituation</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">endDrillSession</span><span class="p">(</span><span class="nx">drillSession</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 結果評価</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">evaluation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evaluateDrillPerformance</span><span class="p">(</span>
<span class="w">      </span><span class="nx">disasterScenario</span><span class="p">,</span>
<span class="w">      </span><span class="nx">participantActions</span><span class="p">,</span>
<span class="w">      </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">drillId</span><span class="o">:</span><span class="w"> </span><span class="kt">drillSession.id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">scenario</span><span class="o">:</span><span class="w"> </span><span class="kt">disasterScenario</span><span class="p">,</span>
<span class="w">      </span><span class="nx">participants</span><span class="o">:</span><span class="w"> </span><span class="kt">participants.length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">Date.now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">startTime</span><span class="p">,</span>
<span class="w">      </span><span class="nx">actions</span><span class="o">:</span><span class="w"> </span><span class="kt">participantActions</span><span class="p">,</span>
<span class="w">      </span><span class="nx">evaluation</span><span class="p">,</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateDrillRecommendations</span><span class="p">(</span><span class="nx">evaluation</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 予測モデル検証・改善</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">validatePredictionModels</span><span class="p">(</span>
<span class="w">    </span><span class="nx">models</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherPredictionModel</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">historicalData</span><span class="o">:</span><span class="w"> </span><span class="kt">HistoricalWeatherData</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">validationPeriod</span><span class="o">:</span><span class="w"> </span><span class="kt">DateRange</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ModelValidationResult</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="o">:</span><span class="w"> </span><span class="kt">ModelValidationResult</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">model</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">models</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 仮想環境で過去を再現</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">loadHistoricalState</span><span class="p">(</span>
<span class="w">        </span><span class="nx">historicalData</span><span class="p">,</span>
<span class="w">        </span><span class="nx">validationPeriod</span><span class="p">.</span><span class="nx">start</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">predictions</span><span class="o">:</span><span class="w"> </span><span class="kt">ModelPrediction</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">observations</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherObservation</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">      </span><span class="c1">// 期間中の予測と観測の比較</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">currentDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">validationPeriod</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
<span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">currentDate</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">validationPeriod</span><span class="p">.</span><span class="nx">end</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// モデルによる予測実行</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">prediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">model</span><span class="p">.</span><span class="nx">predict</span><span class="p">(</span>
<span class="w">          </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">getStateAt</span><span class="p">(</span><span class="nx">currentDate</span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="nx">predictions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">prediction</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 実際の観測データ（仮想環境での再現）</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">observation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">getObservationAt</span><span class="p">(</span>
<span class="w">          </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">currentDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">prediction</span><span class="p">.</span><span class="nx">forecastHours</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3600000</span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="nx">observations</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">observation</span><span class="p">);</span>

<span class="w">        </span><span class="nx">currentDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">currentDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3600000</span><span class="p">);</span><span class="w"> </span><span class="c1">// 1日進める</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 統計的評価指標の計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">statistics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateValidationStatistics</span><span class="p">(</span>
<span class="w">        </span><span class="nx">predictions</span><span class="p">,</span>
<span class="w">        </span><span class="nx">observations</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 改善提案の生成</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">improvements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">identifyModelImprovements</span><span class="p">(</span>
<span class="w">        </span><span class="nx">model</span><span class="p">,</span>
<span class="w">        </span><span class="nx">statistics</span><span class="p">,</span>
<span class="w">        </span><span class="nx">predictions</span><span class="p">,</span>
<span class="w">        </span><span class="nx">observations</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">modelId</span><span class="o">:</span><span class="w"> </span><span class="kt">model.id</span><span class="p">,</span>
<span class="w">        </span><span class="nx">modelName</span><span class="o">:</span><span class="w"> </span><span class="kt">model.name</span><span class="p">,</span>
<span class="w">        </span><span class="nx">validationPeriod</span><span class="p">,</span>
<span class="w">        </span><span class="nx">statistics</span><span class="p">,</span>
<span class="w">        </span><span class="nx">improvements</span><span class="p">,</span>
<span class="w">        </span><span class="nx">recommendedUpdates</span><span class="o">:</span><span class="w"> </span><span class="kt">improvements.map</span><span class="p">(</span><span class="nx">imp</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">imp</span><span class="p">.</span><span class="nx">recommendation</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">results</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 長期気候変動影響分析</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">analyzeClimateChangeImpacts</span><span class="p">(</span>
<span class="w">    </span><span class="nx">climateScenarios</span><span class="o">:</span><span class="w"> </span><span class="kt">ClimateScenario</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">analysisRegion</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoRegion</span><span class="p">,</span>
<span class="w">    </span><span class="nx">timeHorizon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="c1">// years</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ClimateImpactAnalysis</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">impacts</span><span class="o">:</span><span class="w"> </span><span class="kt">ClimateImpactResult</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">scenario</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">climateScenarios</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 気候変動シナリオの適用</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">virtualEnvironment</span><span class="p">.</span><span class="nx">applyClimateScenario</span><span class="p">(</span><span class="nx">scenario</span><span class="p">,</span><span class="w"> </span><span class="nx">timeHorizon</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 長期シミュレーション実行</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">longTermSimulation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">simulationEngine</span><span class="p">.</span><span class="nx">runLongTermSimulation</span><span class="p">({</span>
<span class="w">        </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="kt">analysisRegion</span><span class="p">,</span>
<span class="w">        </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">timeHorizon</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">365</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">24</span><span class="p">,</span><span class="w"> </span><span class="c1">// hours</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="o">:</span><span class="w"> </span><span class="kt">24</span><span class="p">,</span><span class="w"> </span><span class="c1">// 1日ステップ</span>
<span class="w">        </span><span class="nx">scenario</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// 影響分析</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">sectorialImpacts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeSectorialImpacts</span><span class="p">(</span>
<span class="w">        </span><span class="nx">longTermSimulation</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="s1">&#39;agriculture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;energy&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;health&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ecosystem&#39;</span><span class="p">]</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">impacts</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">scenarioName</span><span class="o">:</span><span class="w"> </span><span class="kt">scenario.name</span><span class="p">,</span>
<span class="w">        </span><span class="nx">temperatureChange</span><span class="o">:</span><span class="w"> </span><span class="kt">longTermSimulation.avgTemperatureChange</span><span class="p">,</span>
<span class="w">        </span><span class="nx">precipitationChange</span><span class="o">:</span><span class="w"> </span><span class="kt">longTermSimulation.avgPrecipitationChange</span><span class="p">,</span>
<span class="w">        </span><span class="nx">extremeEventFrequency</span><span class="o">:</span><span class="w"> </span><span class="kt">longTermSimulation.extremeEventStats</span><span class="p">,</span>
<span class="w">        </span><span class="nx">sectorialImpacts</span><span class="p">,</span>
<span class="w">        </span><span class="nx">adaptationMeasures</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">identifyAdaptationMeasures</span><span class="p">(</span><span class="nx">sectorialImpacts</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">analysisRegion</span><span class="p">,</span>
<span class="w">      </span><span class="nx">timeHorizon</span><span class="p">,</span>
<span class="w">      </span><span class="nx">impacts</span><span class="p">,</span>
<span class="w">      </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallClimateRisk</span><span class="p">(</span><span class="nx">impacts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">priorityAdaptations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.prioritizeAdaptationMeasures</span><span class="p">(</span><span class="nx">impacts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">uncertaintyAnalysis</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeUncertainty</span><span class="p">(</span><span class="nx">impacts</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイム最適化</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">optimizeRealTimeOperations</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">OptimizationResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 現在の気象状況取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentWeather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">collectPhysicalData</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 短期予測実行</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">shortTermForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">simulationEngine</span><span class="p">.</span><span class="nx">runShortTermForecast</span><span class="p">(</span>
<span class="w">      </span><span class="nx">currentWeather</span><span class="p">,</span>
<span class="w">      </span><span class="mf">6</span><span class="w"> </span><span class="c1">// 6時間先まで</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 最適化問題の定義</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">optimizationProblem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">objective</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;minimize_risk_and_cost&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">constraints</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s1">&#39;resource_availability&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;safety_requirements&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;operational_limits&#39;</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nx">variables</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s1">&#39;emergency_response_allocation&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;traffic_control_measures&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;infrastructure_protection&#39;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// 最適化実行</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">solution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizationEngine</span><span class="p">.</span><span class="nx">solve</span><span class="p">(</span>
<span class="w">      </span><span class="nx">optimizationProblem</span><span class="p">,</span>
<span class="w">      </span><span class="nx">shortTermForecast</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">optimizedActions</span><span class="o">:</span><span class="w"> </span><span class="kt">solution.actions</span><span class="p">,</span>
<span class="w">      </span><span class="nx">expectedBenefit</span><span class="o">:</span><span class="w"> </span><span class="kt">solution.benefit</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">solution.confidence</span><span class="p">,</span>
<span class="w">      </span><span class="nx">implementation</span><span class="o">:</span><span class="w"> </span><span class="kt">solution.implementationPlan</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">WeatherScenario</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">initialConditions</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherConditions</span><span class="p">;</span>
<span class="w">  </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// hours</span>
<span class="w">  </span><span class="nx">timeStep</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// minutes</span>
<span class="w">  </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">ScenarioParameters</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">DrillResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">drillId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">scenario</span><span class="o">:</span><span class="w"> </span><span class="kt">DisasterScenario</span><span class="p">;</span>
<span class="w">  </span><span class="nx">participants</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// milliseconds</span>
<span class="w">  </span><span class="nx">actions</span><span class="o">:</span><span class="w"> </span><span class="kt">ParticipantAction</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">evaluation</span><span class="o">:</span><span class="w"> </span><span class="kt">DrillEvaluation</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ModelValidationResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">modelId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">modelName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">validationPeriod</span><span class="o">:</span><span class="w"> </span><span class="kt">DateRange</span><span class="p">;</span>
<span class="w">  </span><span class="nx">statistics</span><span class="o">:</span><span class="w"> </span><span class="kt">ValidationStatistics</span><span class="p">;</span>
<span class="w">  </span><span class="nx">improvements</span><span class="o">:</span><span class="w"> </span><span class="kt">ModelImprovement</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">recommendedUpdates</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ClimateImpactAnalysis</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">analysisRegion</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoRegion</span><span class="p">;</span>
<span class="w">  </span><span class="nx">timeHorizon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">impacts</span><span class="o">:</span><span class="w"> </span><span class="kt">ClimateImpactResult</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priorityAdaptations</span><span class="o">:</span><span class="w"> </span><span class="kt">AdaptationMeasure</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">uncertaintyAnalysis</span><span class="o">:</span><span class="w"> </span><span class="kt">UncertaintyAssessment</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="_41">実装時の考慮事項<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h2>
<h3 id="_42">データ品質管理<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<h4 id="_43">観測データの品質保証<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>品質管理項目</th>
<th>実装手法</th>
<th>技術的対策</th>
<th>効果</th>
</tr>
</thead>
<tbody>
<tr>
<td>欠測処理</td>
<td>統計的補間、機械学習予測</td>
<td>時系列解析、空間補間、類似地点参照</td>
<td>データ完全性の維持、解析精度の向上</td>
</tr>
<tr>
<td>異常値検出</td>
<td>統計的検定、機械学習モデル</td>
<td>外れ値検出アルゴリズム、アンサンブル手法</td>
<td>観測機器故障の早期発見、データ信頼性向上</td>
</tr>
<tr>
<td>一貫性チェック</td>
<td>物理法則検証、時空間整合性</td>
<td>制約条件チェック、近隣地点比較</td>
<td>データの論理的整合性確保</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// データ品質管理システム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">WeatherDataQualityManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 欠測データの補間</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">interpolateMissingData</span><span class="p">(</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDataPoint</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="kt">InterpolationMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;kriging&#39;</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WeatherDataPoint</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">missingIndices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">findMissingDataIndices</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">interpolated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">data</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">missingIndices</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">findNearbyDataPoints</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">);</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">interpolatedValue</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">method</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;linear&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">interpolatedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">linearInterpolation</span><span class="p">(</span><span class="nx">neighbors</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;spline&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">interpolatedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">splineInterpolation</span><span class="p">(</span><span class="nx">neighbors</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;kriging&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">interpolatedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">krigingInterpolation</span><span class="p">(</span><span class="nx">neighbors</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;ml_based&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">interpolatedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">mlBasedInterpolation</span><span class="p">(</span><span class="nx">neighbors</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="nx">default</span><span class="o">:</span>
<span class="w">          </span><span class="kt">interpolatedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">linearInterpolation</span><span class="p">(</span><span class="nx">neighbors</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">interpolated</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">...</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
<span class="w">        </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">interpolatedValue</span><span class="p">,</span>
<span class="w">        </span><span class="nx">quality</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;INTERPOLATED&#39;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">interpolated</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 異常値検出システム</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">detectAnomalies</span><span class="p">(</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDataPoint</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">detectionMethods</span><span class="o">:</span><span class="w"> </span><span class="kt">AnomalyDetectionMethod</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;zscore&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;isolation_forest&#39;</span><span class="p">]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">AnomalyDetectionResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="o">:</span><span class="w"> </span><span class="kt">AnomalyResult</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">method</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">detectionMethods</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">anomalies</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">method</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;zscore&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">anomalies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">zScoreAnomalyDetection</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;modified_zscore&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">anomalies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">modifiedZScoreDetection</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;iqr&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">anomalies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">iqrAnomalyDetection</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;isolation_forest&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">anomalies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">isolationForestDetection</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;lstm_autoencoder&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">anomalies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">lstmAutoencoderDetection</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">method</span><span class="p">,</span>
<span class="w">        </span><span class="nx">anomalousIndices</span><span class="o">:</span><span class="w"> </span><span class="kt">anomalies</span><span class="p">,</span>
<span class="w">        </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateAnomalyConfidence</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span><span class="w"> </span><span class="nx">anomalies</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// アンサンブル結果の統合</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">consensusAnomalies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">combineAnomalyResults</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">detectionResults</span><span class="o">:</span><span class="w"> </span><span class="kt">results</span><span class="p">,</span>
<span class="w">      </span><span class="nx">consensusAnomalies</span><span class="p">,</span>
<span class="w">      </span><span class="nx">anomalyRate</span><span class="o">:</span><span class="w"> </span><span class="kt">consensusAnomalies.length</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateAnomalyRecommendations</span><span class="p">(</span><span class="nx">consensusAnomalies</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 物理的整合性チェック</span>
<span class="w">  </span><span class="nx">validatePhysicalConsistency</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">CompleteWeatherData</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">ValidationResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">violations</span><span class="o">:</span><span class="w"> </span><span class="kt">ConstraintViolation</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">dataPoint</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 温度と湿度の関係チェック</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">dewPoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateDewPoint</span><span class="p">(</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">temperature</span><span class="p">,</span><span class="w"> </span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">humidity</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">dewPoint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">temperature</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">violations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DEWPOINT_VIOLATION&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Dew point (</span><span class="si">${</span><span class="nx">dewPoint</span><span class="si">}</span><span class="sb">°C) cannot exceed temperature (</span><span class="si">${</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">temperature</span><span class="si">}</span><span class="sb">°C)`</span><span class="p">,</span>
<span class="w">          </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">dataPoint.timestamp</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 気圧の高度補正チェック</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectedPressure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateExpectedPressure</span><span class="p">(</span>
<span class="w">        </span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">seaLevelPressure</span><span class="p">,</span>
<span class="w">        </span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">altitude</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">pressureDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">stationPressure</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">expectedPressure</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">pressureDiff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 5hPa以上の差</span>
<span class="w">        </span><span class="nx">violations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PRESSURE_INCONSISTENCY&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Station pressure inconsistent with altitude (diff: </span><span class="si">${</span><span class="nx">pressureDiff</span><span class="si">}</span><span class="sb">hPa)`</span><span class="p">,</span>
<span class="w">          </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">dataPoint.timestamp</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 風速と風向の関係チェック</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">windDirection</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">violations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;WIND_INCONSISTENCY&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;LOW&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Wind direction specified with zero wind speed&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">dataPoint.timestamp</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 降水量と雲量の関係チェック</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">precipitation</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">cloudCover</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">50</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">violations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PRECIPITATION_CLOUD_MISMATCH&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="sb">`Precipitation (</span><span class="si">${</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">precipitation</span><span class="si">}</span><span class="sb">mm) with low cloud cover (</span><span class="si">${</span><span class="nx">dataPoint</span><span class="p">.</span><span class="nx">cloudCover</span><span class="si">}</span><span class="sb">%)`</span><span class="p">,</span>
<span class="w">          </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">dataPoint.timestamp</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">isValid</span><span class="o">:</span><span class="w"> </span><span class="kt">violations.length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="w">      </span><span class="nx">violations</span><span class="p">,</span>
<span class="w">      </span><span class="nx">overallQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateOverallQuality</span><span class="p">(</span><span class="nx">violations</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateQualityRecommendations</span><span class="p">(</span><span class="nx">violations</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ダンクラノ克ルナムお検証</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">spatialConsistencyCheck</span><span class="p">(</span>
<span class="w">    </span><span class="nx">stationData</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">WeatherDataPoint</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoRegion</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SpatialConsistencyResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">inconsistencies</span><span class="o">:</span><span class="w"> </span><span class="kt">SpatialInconsistency</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">stationIds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">stationData</span><span class="p">.</span><span class="nx">keys</span><span class="p">());</span>

<span class="w">    </span><span class="c1">// 各観測所ペアの整合性チェック</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">stationIds</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">stationIds</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">station1Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stationIds</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">station2Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stationIds</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">station1Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stationData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">station1Id</span><span class="p">)</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">station2Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stationData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">station2Id</span><span class="p">)</span><span class="o">!</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// 時刻同期データのペア作成</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">synchronizedPairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createSynchronizedPairs</span><span class="p">(</span><span class="nx">station1Data</span><span class="p">,</span><span class="w"> </span><span class="nx">station2Data</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">pair</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">synchronizedPairs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// 距離に基づく期待差の計算</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateDistance</span><span class="p">(</span>
<span class="w">            </span><span class="nx">pair</span><span class="p">.</span><span class="nx">station1</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">            </span><span class="nx">pair</span><span class="p">.</span><span class="nx">station2</span><span class="p">.</span><span class="nx">location</span>
<span class="w">          </span><span class="p">);</span>

<span class="w">          </span><span class="c1">// 温度勾配チェック</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">tempDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">pair</span><span class="p">.</span><span class="nx">station1</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">temperature</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">pair</span><span class="p">.</span><span class="nx">station2</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">temperature</span><span class="p">);</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectedTempDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateExpectedTemperatureDifference</span><span class="p">(</span><span class="nx">distance</span><span class="p">,</span><span class="w"> </span><span class="nx">region</span><span class="p">);</span>

<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">tempDiff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">expectedTempDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">inconsistencies</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;TEMPERATURE_GRADIENT_ANOMALY&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">stations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">station1Id</span><span class="p">,</span><span class="w"> </span><span class="nx">station2Id</span><span class="p">],</span>
<span class="w">              </span><span class="nx">distance</span><span class="p">,</span>
<span class="w">              </span><span class="nx">observedDifference</span><span class="o">:</span><span class="w"> </span><span class="kt">tempDiff</span><span class="p">,</span>
<span class="w">              </span><span class="nx">expectedDifference</span><span class="o">:</span><span class="w"> </span><span class="kt">expectedTempDiff</span><span class="p">,</span>
<span class="w">              </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">tempDiff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">expectedTempDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">pair.timestamp</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// 気圧勾配チェック</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">pressureDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">pair</span><span class="p">.</span><span class="nx">station1</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">pressure</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">pair</span><span class="p">.</span><span class="nx">station2</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">pressure</span><span class="p">);</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectedPressureDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateExpectedPressureDifference</span><span class="p">(</span><span class="nx">distance</span><span class="p">);</span>

<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">pressureDiff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">expectedPressureDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">inconsistencies</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">              </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PRESSURE_GRADIENT_ANOMALY&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">stations</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">station1Id</span><span class="p">,</span><span class="w"> </span><span class="nx">station2Id</span><span class="p">],</span>
<span class="w">              </span><span class="nx">distance</span><span class="p">,</span>
<span class="w">              </span><span class="nx">observedDifference</span><span class="o">:</span><span class="w"> </span><span class="kt">pressureDiff</span><span class="p">,</span>
<span class="w">              </span><span class="nx">expectedDifference</span><span class="o">:</span><span class="w"> </span><span class="kt">expectedPressureDiff</span><span class="p">,</span>
<span class="w">              </span><span class="nx">severity</span><span class="o">:</span><span class="w"> </span><span class="kt">pressureDiff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">expectedPressureDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">pair.timestamp</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">region</span><span class="p">,</span>
<span class="w">      </span><span class="nx">checkedStations</span><span class="o">:</span><span class="w"> </span><span class="kt">stationIds.length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">inconsistencies</span><span class="p">,</span>
<span class="w">      </span><span class="nx">spatialQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateSpatialQuality</span><span class="p">(</span><span class="nx">inconsistencies</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateSpatialRecommendations</span><span class="p">(</span><span class="nx">inconsistencies</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 機械学習による品質評価</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">mlBasedQualityAssessment</span><span class="p">(</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherDataPoint</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="kt">QualityAssessmentModel</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">MLQualityResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractQualityFeatures</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">predictions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">model</span><span class="p">.</span><span class="nx">predict</span><span class="p">(</span><span class="nx">features</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">qualityScores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">predictions</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">pred</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">      </span><span class="nx">index</span><span class="p">,</span>
<span class="w">      </span><span class="nx">dataPoint</span><span class="o">:</span><span class="w"> </span><span class="kt">data</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
<span class="w">      </span><span class="nx">qualityScore</span><span class="o">:</span><span class="w"> </span><span class="kt">pred.qualityScore</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">pred.confidence</span><span class="p">,</span>
<span class="w">      </span><span class="nx">flaggedIssues</span><span class="o">:</span><span class="w"> </span><span class="kt">pred.flaggedIssues</span>
<span class="w">    </span><span class="p">}));</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">lowQualityPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">qualityScores</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">qs</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">qs</span><span class="p">.</span><span class="nx">qualityScore</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.7</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">overallQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">qualityScores.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">qs</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">qs</span><span class="p">.</span><span class="nx">qualityScore</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">qualityScores</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">individualScores</span><span class="o">:</span><span class="w"> </span><span class="kt">qualityScores</span><span class="p">,</span>
<span class="w">      </span><span class="nx">lowQualityPoints</span><span class="p">,</span>
<span class="w">      </span><span class="nx">modelConfidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateModelConfidence</span><span class="p">(</span><span class="nx">predictions</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateMLRecommendations</span><span class="p">(</span><span class="nx">lowQualityPoints</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AnomalyDetectionResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">detectionResults</span><span class="o">:</span><span class="w"> </span><span class="kt">AnomalyResult</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">consensusAnomalies</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">anomalyRate</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ValidationResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">isValid</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">violations</span><span class="o">:</span><span class="w"> </span><span class="kt">ConstraintViolation</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">overallQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SpatialConsistencyResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoRegion</span><span class="p">;</span>
<span class="w">  </span><span class="nx">checkedStations</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">inconsistencies</span><span class="o">:</span><span class="w"> </span><span class="kt">SpatialInconsistency</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">spatialQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">MLQualityResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">overallQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">individualScores</span><span class="o">:</span><span class="w"> </span><span class="kt">QualityScore</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">lowQualityPoints</span><span class="o">:</span><span class="w"> </span><span class="kt">QualityScore</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">modelConfidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kr">type</span><span class="w"> </span><span class="nx">InterpolationMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;linear&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;spline&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;kriging&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ml_based&#39;</span><span class="p">;</span>
<span class="kr">type</span><span class="w"> </span><span class="nx">AnomalyDetectionMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;zscore&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;modified_zscore&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;iqr&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;isolation_forest&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;lstm_autoencoder&#39;</span><span class="p">;</span>
</code></pre></div>
</details>
<h3 id="_44">セキュリティ対策<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h3>
<h4 id="_45">気象データの保護<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>セキュリティ項目</th>
<th>脅威</th>
<th>対策技術</th>
<th>実装のポイント</th>
</tr>
</thead>
<tbody>
<tr>
<td>データ暗号化</td>
<td>盗聴、漏洩</td>
<td>AES-256、TLS1.3、暗号化DB</td>
<td>エンドツーエンド暗号化、キー管理の自動化</td>
</tr>
<tr>
<td>アクセス制御</td>
<td>不正アクセス</td>
<td>OAuth2.0、RBAC、多要素認証</td>
<td>最小権限原則、定期的な権限見直し</td>
</tr>
<tr>
<td>改ざん防止</td>
<td>データ破壊</td>
<td>デジタル署名、ブロックチェーン、監査ログ</td>
<td>完全性検証、変更履歴の追跡</td>
</tr>
</tbody>
</table>
<h3 id="_46">国際標準への対応<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<h4 id="wmoiso">WMO・ISO準拠<a class="headerlink" href="#wmoiso" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>標準規格</th>
<th>内容</th>
<th>対応のメリット</th>
<th>実装例</th>
</tr>
</thead>
<tbody>
<tr>
<td>WMO-No.306 (FM-94 BUFR)</td>
<td>気象データ交換形式</td>
<td>国際的な相互運用性、データ品質向上</td>
<td>BUFR エンコーダー・デコーダーの実装</td>
</tr>
<tr>
<td>WIS 2.0</td>
<td>気象情報システム</td>
<td>グローバルなデータ共有、リアルタイム配信</td>
<td>API Gateway、メッセージブローカー連携</td>
</tr>
<tr>
<td>ISO 19115</td>
<td>地理空間メタデータ</td>
<td>データの発見可能性向上、品質表現</td>
<td>メタデータカタログ、検索システム</td>
</tr>
</tbody>
</table>
<h2 id="_47">日本の気象ソフトウェア事例<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h2>
<h3 id="_48">国内主要システム<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h3>
<h4 id="_49">気象庁次世代気象・海象・地震津波監視予測システム<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>graph TD
    A[次世代システム] --&gt; B[スーパーコンピュータ「富岳」]
    A --&gt; C[統合観測データ基盤]
    A --&gt; D[AI・機械学習基盤]

    B --&gt; B1[全球モデル（GSM）]
    B --&gt; B2[領域モデル（MSM）]
    B --&gt; B3[局地モデル（LFM）]

    C --&gt; C1[アメダス]
    C --&gt; C2[気象レーダー]
    C --&gt; C3[ひまわり8/9号]
    C --&gt; C4[ウィンドプロファイラ]

    D --&gt; D1[降水予測AI]
    D --&gt; D2[台風予測AI]
    D --&gt; D3[異常気象検知AI]



</code></pre>
<table>
<thead>
<tr>
<th>システム名</th>
<th>機能</th>
<th>技術的特徴</th>
<th>導入効果</th>
</tr>
</thead>
<tbody>
<tr>
<td>アスラ（ASRA）</td>
<td>降水短時間予報</td>
<td>機械学習による予測、5分更新</td>
<td>ゲリラ豪雨の予測精度30%向上</td>
</tr>
<tr>
<td>5分間降水予報</td>
<td>超短時間降水予測</td>
<td>レーダー・AI統合解析</td>
<td>避難判断支援の高度化</td>
</tr>
<tr>
<td>線状降水帯検出</td>
<td>危険な降水帯の自動検出</td>
<td>パターン認識AI、リアルタイム解析</td>
<td>特別警報発表の迅速化</td>
</tr>
</tbody>
</table>
<h3 id="_50">民間気象サービス<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h3>
<h4 id="_51">主要民間企業システム<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>企業</th>
<th>主力サービス</th>
<th>特徴・技術</th>
<th>対象ユーザー・導入例</th>
</tr>
</thead>
<tbody>
<tr>
<td>ウェザーニューズ</td>
<td>WxTech、PolyMap</td>
<td>独自観測網、AI予測、GPV配信</td>
<td>航空・海運・農業・エネルギー業界</td>
</tr>
<tr>
<td>日本気象協会</td>
<td>tenki.jp、JMAQS</td>
<td>気象予測、コンテンツ配信</td>
<td>一般消費者、メディア、自治体</td>
</tr>
<tr>
<td>気象計測設計</td>
<td>SYNFOS、LAWEPS</td>
<td>災害予測、早期警戒システム</td>
<td>自治体防災、建設業、インフラ</td>
</tr>
<tr>
<td>ライフビジネスウェザー</td>
<td>LiVEYE、農業気象</td>
<td>生活密着型サービス、農業支援</td>
<td>小売業、農業、個人ユーザー</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// 民間気象サービスAPI統合システム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">CommercialWeatherService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">providers</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">WeatherProvider</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setupProviders</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">setupProviders</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ウェザーニューズAPI</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;WeatherNews&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">WeatherNewsProvider</span><span class="p">({</span>
<span class="w">      </span><span class="nx">apiKey</span><span class="o">:</span><span class="w"> </span><span class="kt">process.env.WNI_API_KEY</span><span class="p">,</span>
<span class="w">      </span><span class="nx">baseUrl</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.weathernews.com/v2&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="kt">1000</span><span class="w"> </span><span class="c1">// requests per hour</span>
<span class="w">    </span><span class="p">}));</span>

<span class="w">    </span><span class="c1">// 日本気象協会API</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;JWA&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">JWAProvider</span><span class="p">({</span>
<span class="w">      </span><span class="nx">apiKey</span><span class="o">:</span><span class="w"> </span><span class="kt">process.env.JWA_API_KEY</span><span class="p">,</span>
<span class="w">      </span><span class="nx">baseUrl</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.jwa.or.jp/v1&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="kt">500</span>
<span class="w">    </span><span class="p">}));</span>

<span class="w">    </span><span class="c1">// 気象庁API（無料）</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;JMA&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">JMAProvider</span><span class="p">({</span>
<span class="w">      </span><span class="nx">baseUrl</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://www.jma.go.jp/bosai/forecast/data/forecast&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span>
<span class="w">    </span><span class="p">}));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 複数プロバイダーからの予報統合</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">getIntegratedForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">JapanLocation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">forecastType</span><span class="o">:</span><span class="w"> </span><span class="kt">ForecastType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;daily&#39;</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">IntegratedForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">providerForecasts</span><span class="o">:</span><span class="w"> </span><span class="kt">ProviderForecast</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 各プロバイダーから予報を並列取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecastPromises</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">entries</span><span class="p">()).</span><span class="nx">map</span><span class="p">(</span>
<span class="w">      </span><span class="k">async</span><span class="w"> </span><span class="p">([</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">provider</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">getForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="nx">forecastType</span><span class="p">);</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">provider</span><span class="o">:</span><span class="w"> </span><span class="kt">name</span><span class="p">,</span><span class="w"> </span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Failed to get forecast from </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">provider</span><span class="o">:</span><span class="w"> </span><span class="kt">name</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">error.message</span><span class="p">,</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">forecastPromises</span><span class="p">);</span>

<span class="w">    </span><span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;fulfilled&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">providerForecasts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// アンサンブル予報の生成</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">integratedForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateEnsembleForecast</span><span class="p">(</span><span class="nx">providerForecasts</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">location</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecastType</span><span class="p">,</span>
<span class="w">      </span><span class="nx">providers</span><span class="o">:</span><span class="w"> </span><span class="kt">providerForecasts.map</span><span class="p">(</span><span class="nx">pf</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">pf</span><span class="p">.</span><span class="nx">provider</span><span class="p">),</span>
<span class="w">      </span><span class="nx">ensembleForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">integratedForecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateEnsembleConfidence</span><span class="p">(</span><span class="nx">providerForecasts</span><span class="p">),</span>
<span class="w">      </span><span class="nx">issuedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">validUntil</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 特定用途向けカスタム予報</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">getCustomizedForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">industry</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">JapanLocation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">CustomParameters</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">CustomizedForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">industry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;agriculture&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAgriculturalForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">);</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;construction&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getConstructionForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">);</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;transportation&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getTransportationForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">);</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;energy&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getEnergyForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">);</span>
<span class="w">      </span><span class="nx">default</span><span class="o">:</span>
<span class="w">        </span><span class="kt">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Unsupported industry: </span><span class="si">${</span><span class="nx">industry</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 農業向け特化予報</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">getAgriculturalForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">JapanLocation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">AgriculturalParameters</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">AgriculturalForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">baseWeather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getIntegratedForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;hourly&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 農業特有の指標計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">AgriculturalTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">timeStep</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">baseWeather</span><span class="p">.</span><span class="nx">ensembleForecast</span><span class="p">.</span><span class="nx">timeSteps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 病害虫発生リスク</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">diseaseRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateDiseaseRisk</span><span class="p">(</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">cropType</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">growthStage</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 作業適性判定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">workSuitability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessWorkSuitability</span><span class="p">(</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">plannedActivities</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 灌水推奨度</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">irrigationRecommendation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateIrrigationNeed</span><span class="p">(</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">soilType</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">cropWaterRequirement</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">forecast</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">timeStep.timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">baseWeather</span><span class="o">:</span><span class="w"> </span><span class="kt">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">diseaseRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">workSuitability</span><span class="p">,</span>
<span class="w">        </span><span class="nx">irrigationRecommendation</span><span class="p">,</span>
<span class="w">        </span><span class="nx">cropStressIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateCropStressIndex</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">cropType</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">location</span><span class="p">,</span>
<span class="w">      </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">parameters.cropType</span><span class="p">,</span>
<span class="w">      </span><span class="nx">growthStage</span><span class="o">:</span><span class="w"> </span><span class="kt">parameters.growthStage</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">alerts</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateAgriculturalAlerts</span><span class="p">(</span><span class="nx">forecast</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateFarmingRecommendations</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 建設業向け特化予報</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">getConstructionForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">JapanLocation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">ConstructionParameters</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ConstructionForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">baseWeather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getIntegratedForecast</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;hourly&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">ConstructionTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">timeStep</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">baseWeather</span><span class="p">.</span><span class="nx">ensembleForecast</span><span class="p">.</span><span class="nx">timeSteps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 作業可否判定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">workability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessConstructionWorkability</span><span class="p">(</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">workType</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">heightRestrictions</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 材料保護必要性</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">materialProtection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessMaterialProtectionNeed</span><span class="p">(</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">exposedMaterials</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 安全度評価</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">safetyAssessment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evaluateConstructionSafety</span><span class="p">(</span>
<span class="w">        </span><span class="nx">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">workType</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">heightRestrictions</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">forecast</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">timeStep.timestamp</span><span class="p">,</span>
<span class="w">        </span><span class="nx">baseWeather</span><span class="o">:</span><span class="w"> </span><span class="kt">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">workability</span><span class="p">,</span>
<span class="w">        </span><span class="nx">materialProtection</span><span class="p">,</span>
<span class="w">        </span><span class="nx">safetyAssessment</span><span class="p">,</span>
<span class="w">        </span><span class="nx">delayRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateDelayRisk</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">.</span><span class="nx">workType</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">location</span><span class="p">,</span>
<span class="w">      </span><span class="nx">workType</span><span class="o">:</span><span class="w"> </span><span class="kt">parameters.workType</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateConstructionOverallRisk</span><span class="p">(</span><span class="nx">forecast</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateConstructionRecommendations</span><span class="p">(</span><span class="nx">forecast</span><span class="p">,</span><span class="w"> </span><span class="nx">parameters</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイム警報配信</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">setupRealTimeAlerts</span><span class="p">(</span>
<span class="w">    </span><span class="nx">subscriptions</span><span class="o">:</span><span class="w"> </span><span class="kt">AlertSubscription</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">AlertManager</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">alertManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">AlertManager</span><span class="p">();</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">subscription</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">subscriptions</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 監視ジョブの設定</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">monitoringJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">alertManager</span><span class="p">.</span><span class="nx">createMonitoringJob</span><span class="p">({</span>
<span class="w">        </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">subscription.location</span><span class="p">,</span>
<span class="w">        </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">subscription.alertParameters</span><span class="p">,</span>
<span class="w">        </span><span class="nx">callback</span><span class="o">:</span><span class="w"> </span><span class="kt">async</span><span class="w"> </span><span class="p">(</span><span class="nx">alert</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherAlert</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">deliverAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span><span class="w"> </span><span class="nx">subscription</span><span class="p">.</span><span class="nx">deliveryMethods</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">frequency</span><span class="o">:</span><span class="w"> </span><span class="kt">subscription.checkFrequency</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">300000</span><span class="w"> </span><span class="c1">// 5分間隔</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">alertManager</span><span class="p">.</span><span class="nx">startMonitoring</span><span class="p">(</span><span class="nx">monitoringJob</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">alertManager</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// アラート配信</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="nx">deliverAlert</span><span class="p">(</span>
<span class="w">    </span><span class="nx">alert</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherAlert</span><span class="p">,</span>
<span class="w">    </span><span class="nx">deliveryMethods</span><span class="o">:</span><span class="w"> </span><span class="kt">DeliveryMethod</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">deliveryPromises</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">deliveryMethods</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">method</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">method</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendEmailAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">.</span><span class="nx">config</span><span class="p">);</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;sms&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendSMSAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">.</span><span class="nx">config</span><span class="p">);</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;push&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendPushNotification</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">.</span><span class="nx">config</span><span class="p">);</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;webhook&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendWebhookAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">.</span><span class="nx">config</span><span class="p">);</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;slack&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sendSlackAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">.</span><span class="nx">config</span><span class="p">);</span>
<span class="w">        </span><span class="nx">default</span><span class="o">:</span>
<span class="w">          </span><span class="kt">console.warn</span><span class="p">(</span><span class="sb">`Unsupported delivery method: </span><span class="si">${</span><span class="nx">method</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">deliveryPromises</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">JapanLocation</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">prefecture</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">coordinates</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">jmaCode?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// 気象庁地点コード</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AgriculturalParameters</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">CustomParameters</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">cropType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">growthStage</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">soilType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cropWaterRequirement</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">plannedActivities</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ConstructionParameters</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">CustomParameters</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">workType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;excavation&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;concrete&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;steel&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;roofing&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;painting&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">heightRestrictions</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">exposedMaterials</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AlertSubscription</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">JapanLocation</span><span class="p">;</span>
<span class="w">  </span><span class="nx">alertParameters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">precipitation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="nx">wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="nx">temperature</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">min?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="nx">max?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="nx">custom?</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">deliveryMethods</span><span class="o">:</span><span class="w"> </span><span class="kt">DeliveryMethod</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">checkFrequency?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// milliseconds</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">DeliveryMethod</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;sms&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;push&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;webhook&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;slack&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="_52">防災・緊急対応システム<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h2>
<h3 id="_53">統合防災情報システム<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h3>
<h4 id="_54">災害対策本部支援システム<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム</th>
<th>機能</th>
<th>特徴・技術</th>
<th>導入効果・用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>統合災害情報システム</td>
<td>各種災害情報の一元管理</td>
<td>GIS統合、リアルタイム表示、多機関連携</td>
<td>迅速な状況把握、的確な避難指示、資源配分最適化</td>
</tr>
<tr>
<td>避難判断支援システム</td>
<td>避難勧告・指示の判断支援</td>
<td>AI意思決定支援、住民データ統合</td>
<td>避難の適切なタイミング判断、住民の安全確保</td>
</tr>
<tr>
<td>緊急時通信システム</td>
<td>災害時の情報伝達確保</td>
<td>衛星通信、メッシュネットワーク</td>
<td>通信インフラ被災時の情報伝達維持</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// 統合防災情報システム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">IntegratedDisasterManagementSystem</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">dataIntegrator</span><span class="o">:</span><span class="w"> </span><span class="kt">DisasterDataIntegrator</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">alertManager</span><span class="o">:</span><span class="w"> </span><span class="kt">EmergencyAlertManager</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">evacuationDecisionSupport</span><span class="o">:</span><span class="w"> </span><span class="kt">EvacuationDecisionSupport</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">resourceManager</span><span class="o">:</span><span class="w"> </span><span class="kt">DisasterResourceManager</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">dataIntegrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DisasterDataIntegrator</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">alertManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">EmergencyAlertManager</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">evacuationDecisionSupport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">EvacuationDecisionSupport</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">resourceManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DisasterResourceManager</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 災害対策本部ダッシュボード</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">generateSituationBoard</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SituationBoard</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 各種情報の同時取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="nx">weatherStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">riverStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">evacuationStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">resourceStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">damageReports</span>
<span class="w">    </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">dataIntegrator</span><span class="p">.</span><span class="nx">getWeatherStatus</span><span class="p">(),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">dataIntegrator</span><span class="p">.</span><span class="nx">getRiverWaterLevels</span><span class="p">(),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">evacuationDecisionSupport</span><span class="p">.</span><span class="nx">getCurrentEvacuationStatus</span><span class="p">(),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">resourceManager</span><span class="p">.</span><span class="nx">getResourceStatus</span><span class="p">(),</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">dataIntegrator</span><span class="p">.</span><span class="nx">getDamageReports</span><span class="p">()</span>
<span class="w">    </span><span class="p">]);</span>

<span class="w">    </span><span class="c1">// 総合危険度の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">overallRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateOverallRisk</span><span class="p">({</span>
<span class="w">      </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="kt">weatherStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">river</span><span class="o">:</span><span class="w"> </span><span class="kt">riverStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">evacuation</span><span class="o">:</span><span class="w"> </span><span class="kt">evacuationStatus</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 優先対応事項の特定</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">priorityActions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">identifyPriorityActions</span><span class="p">(</span><span class="nx">overallRisk</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">overallRisk</span><span class="p">,</span>
<span class="w">      </span><span class="nx">weatherStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">waterStatus</span><span class="o">:</span><span class="w"> </span><span class="kt">riverStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">evacuationStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">resourceStatus</span><span class="p">,</span>
<span class="w">      </span><span class="nx">damageReports</span><span class="p">,</span>
<span class="w">      </span><span class="nx">priorityActions</span><span class="p">,</span>
<span class="w">      </span><span class="nx">recommendedDecisions</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateRecommendedDecisions</span><span class="p">(</span><span class="nx">overallRisk</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 自動避難判断システム</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">evaluateEvacuationDecision</span><span class="p">(</span>
<span class="w">    </span><span class="nx">area</span><span class="o">:</span><span class="w"> </span><span class="kt">EvacuationArea</span><span class="p">,</span>
<span class="w">    </span><span class="nx">currentConditions</span><span class="o">:</span><span class="w"> </span><span class="kt">CurrentConditions</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">EvacuationDecision</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 複数指標による評価</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">riskAssessment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evacuationDecisionSupport</span><span class="p">.</span><span class="nx">assessRisk</span><span class="p">({</span>
<span class="w">      </span><span class="nx">rainfall</span><span class="o">:</span><span class="w"> </span><span class="kt">currentConditions.rainfall</span><span class="p">,</span>
<span class="w">      </span><span class="nx">riverLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">currentConditions.riverLevel</span><span class="p">,</span>
<span class="w">      </span><span class="nx">soilMoisture</span><span class="o">:</span><span class="w"> </span><span class="kt">currentConditions.soilMoisture</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">currentConditions.forecast</span><span class="p">,</span>
<span class="w">      </span><span class="nx">vulnerability</span><span class="o">:</span><span class="w"> </span><span class="kt">area.vulnerability</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 住民の避難能力考慮</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">evacuationCapability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEvacuationCapability</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 避難時間の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">evacuationTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateEvacuationTime</span><span class="p">(</span><span class="nx">area</span><span class="p">,</span><span class="w"> </span><span class="nx">currentConditions</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 決定ロジック</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">decision</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;NONE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;PREPARE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ADVISORY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ORDER&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;IMMEDIATE&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;NONE&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">reasoning</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">immediateRisk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">decision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;IMMEDIATE&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">reasoning</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;極めて高い危険性があり、直ちに避難が必要&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">highRisk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">decision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORDER&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">reasoning</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;高い危険性があり、避難指示を発出&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">moderateRisk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">decision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">evacuationTime</span><span class="p">.</span><span class="nx">availableTime</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">evacuationTime</span><span class="p">.</span><span class="nx">requiredTime</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;ORDER&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ADVISORY&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">reasoning</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;中程度の危険性、避難時間を考慮して判断&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">lowRisk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">decision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;PREPARE&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">reasoning</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;低い危険性だが、避難準備を推奨&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">area</span><span class="o">:</span><span class="w"> </span><span class="kt">area.id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">decision</span><span class="p">,</span>
<span class="w">      </span><span class="nx">riskLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">Math.max</span><span class="p">(</span>
<span class="w">        </span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">immediateRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">highRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">moderateRisk</span><span class="p">,</span>
<span class="w">        </span><span class="nx">riskAssessment</span><span class="p">.</span><span class="nx">lowRisk</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nx">reasoning</span><span class="p">,</span>
<span class="w">      </span><span class="nx">evacuationTime</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">riskAssessment.confidence</span><span class="p">,</span>
<span class="w">      </span><span class="nx">alternativeOptions</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateAlternativeOptions</span><span class="p">(</span><span class="nx">area</span><span class="p">,</span><span class="w"> </span><span class="nx">riskAssessment</span><span class="p">),</span>
<span class="w">      </span><span class="nx">monitoringPoints</span><span class="o">:</span><span class="w"> </span><span class="kt">this.identifyMonitoringPoints</span><span class="p">(</span><span class="nx">area</span><span class="p">,</span><span class="w"> </span><span class="nx">riskAssessment</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 多機関連携システム</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">coordinateMultiAgencyResponse</span><span class="p">(</span>
<span class="w">    </span><span class="nx">incident</span><span class="o">:</span><span class="w"> </span><span class="kt">DisasterIncident</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">CoordinationPlan</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">involvedAgencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">identifyInvolvedAgencies</span><span class="p">(</span><span class="nx">incident</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">coordinationPlan</span><span class="o">:</span><span class="w"> </span><span class="kt">CoordinationPlan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">incident</span><span class="o">:</span><span class="w"> </span><span class="kt">incident.id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">agencies</span><span class="o">:</span><span class="w"> </span><span class="kt">involvedAgencies</span><span class="p">,</span>
<span class="w">      </span><span class="nx">roles</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">communicationPlan</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">setupCommunicationPlan</span><span class="p">(</span><span class="nx">involvedAgencies</span><span class="p">),</span>
<span class="w">      </span><span class="nx">resourceSharing</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">planResourceSharing</span><span class="p">(</span><span class="nx">involvedAgencies</span><span class="p">,</span><span class="w"> </span><span class="nx">incident</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// 各機関の役割分担</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">agency</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">involvedAgencies</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assignAgencyRole</span><span class="p">(</span><span class="nx">agency</span><span class="p">,</span><span class="w"> </span><span class="nx">incident</span><span class="p">);</span>
<span class="w">      </span><span class="nx">coordinationPlan</span><span class="p">.</span><span class="nx">roles</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">agency</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">role</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 統合指揮系統の設定</span>
<span class="w">    </span><span class="nx">coordinationPlan</span><span class="p">.</span><span class="nx">commandStructure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">establishCommandStructure</span><span class="p">(</span><span class="nx">coordinationPlan</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">coordinationPlan</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 住民向け緊急情報配信</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">broadcastEmergencyInformation</span><span class="p">(</span>
<span class="w">    </span><span class="nx">information</span><span class="o">:</span><span class="w"> </span><span class="kt">EmergencyInformation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">targetAreas</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[],</span>
<span class="w">    </span><span class="nx">priorityLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">BroadcastResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">selectDistributionChannels</span><span class="p">(</span><span class="nx">priorityLevel</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">deliveryResults</span><span class="o">:</span><span class="w"> </span><span class="kt">ChannelResult</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// チャネル別配信の並列実行</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">deliveryPromises</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">channels</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="nx">channel</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">customizedContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">customizeContent</span><span class="p">(</span><span class="nx">information</span><span class="p">,</span><span class="w"> </span><span class="nx">channel</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">channel</span><span class="p">.</span><span class="nx">broadcast</span><span class="p">(</span><span class="nx">customizedContent</span><span class="p">,</span><span class="w"> </span><span class="nx">targetAreas</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">channel</span><span class="o">:</span><span class="w"> </span><span class="kt">channel.type</span><span class="p">,</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="p">};</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Broadcast failed on </span><span class="si">${</span><span class="nx">channel</span><span class="p">.</span><span class="kr">type</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">channel</span><span class="o">:</span><span class="w"> </span><span class="kt">channel.type</span><span class="p">,</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">error.message</span><span class="w"> </span><span class="p">};</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">deliveryPromises</span><span class="p">);</span>

<span class="w">    </span><span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;fulfilled&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">deliveryResults</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 到達率の計算</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">reachRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateReachRate</span><span class="p">(</span><span class="nx">deliveryResults</span><span class="p">,</span><span class="w"> </span><span class="nx">targetAreas</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 未到達地域への代替配信</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">reachRate</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">executeAlternativeDistribution</span><span class="p">(</span><span class="nx">information</span><span class="p">,</span><span class="w"> </span><span class="nx">targetAreas</span><span class="p">,</span><span class="w"> </span><span class="nx">deliveryResults</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">broadcastId</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateBroadcastId</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">information</span><span class="p">,</span>
<span class="w">      </span><span class="nx">targetAreas</span><span class="p">,</span>
<span class="w">      </span><span class="nx">channels</span><span class="o">:</span><span class="w"> </span><span class="kt">deliveryResults</span><span class="p">,</span>
<span class="w">      </span><span class="nx">reachRate</span><span class="p">,</span>
<span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">()</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// AIによる災害予測・警告</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">predictDisasterProgression</span><span class="p">(</span>
<span class="w">    </span><span class="nx">currentSituation</span><span class="o">:</span><span class="w"> </span><span class="kt">DisasterSituation</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DisasterProgression</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">aiModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">loadDisasterPredictionModel</span><span class="p">(</span><span class="nx">currentSituation</span><span class="p">.</span><span class="kr">type</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 現在状況の特徴抽出</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">extractSituationFeatures</span><span class="p">(</span><span class="nx">currentSituation</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 災害進展予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">progressionPrediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">aiModel</span><span class="p">.</span><span class="nx">predictProgression</span><span class="p">(</span><span class="nx">features</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 被害予測</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">damageEstimation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">estimatePotentialDamage</span><span class="p">(</span>
<span class="w">      </span><span class="nx">progressionPrediction</span><span class="p">,</span>
<span class="w">      </span><span class="nx">currentSituation</span><span class="p">.</span><span class="nx">affectedAreas</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 対策効果シミュレーション</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">interventionEffects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">simulateInterventionEffects</span><span class="p">(</span>
<span class="w">      </span><span class="nx">progressionPrediction</span><span class="p">,</span>
<span class="w">      </span><span class="nx">currentSituation</span><span class="p">.</span><span class="nx">availableResources</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">currentSituation</span><span class="o">:</span><span class="w"> </span><span class="kt">currentSituation.id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">progressionForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">progressionPrediction</span><span class="p">,</span>
<span class="w">      </span><span class="nx">damageEstimation</span><span class="p">,</span>
<span class="w">      </span><span class="nx">interventionOptions</span><span class="o">:</span><span class="w"> </span><span class="kt">interventionEffects</span><span class="p">,</span>
<span class="w">      </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">progressionPrediction.confidence</span><span class="p">,</span>
<span class="w">      </span><span class="nx">updateInterval</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateUpdateInterval</span><span class="p">(</span><span class="nx">currentSituation</span><span class="p">),</span>
<span class="w">      </span><span class="nx">criticalTimePoints</span><span class="o">:</span><span class="w"> </span><span class="kt">this.identifyCriticalTimePoints</span><span class="p">(</span><span class="nx">progressionPrediction</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 避難所管理システム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">EvacuationShelterManagement</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">shelters</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">EvacuationShelter</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">capacityTracker</span><span class="o">:</span><span class="w"> </span><span class="kt">CapacityTracker</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">resourceManager</span><span class="o">:</span><span class="w"> </span><span class="kt">ShelterResourceManager</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 避難所状況のリアルタイム管理</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">updateShelterStatus</span><span class="p">(</span>
<span class="w">    </span><span class="nx">shelterId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">ShelterStatusUpdate</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">shelter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">shelters</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">shelterId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">shelter</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`Shelter not found: </span><span class="si">${</span><span class="nx">shelterId</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 状況更新</span>
<span class="w">    </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">currentOccupancy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">status</span><span class="p">.</span><span class="nx">currentOccupancy</span><span class="p">;</span>
<span class="w">    </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">availableResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">status</span><span class="p">.</span><span class="nx">availableResources</span><span class="p">;</span>
<span class="w">    </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">operationalStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">status</span><span class="p">.</span><span class="nx">operationalStatus</span><span class="p">;</span>
<span class="w">    </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">healthStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">status</span><span class="p">.</span><span class="nx">healthStatus</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 容量警告チェック</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">capacityRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">currentOccupancy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">maxCapacity</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">capacityRatio</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">triggerCapacityWarning</span><span class="p">(</span><span class="nx">shelter</span><span class="p">,</span><span class="w"> </span><span class="nx">capacityRatio</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 資源不足警告チェック</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resourceShortages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">checkResourceShortages</span><span class="p">(</span><span class="nx">shelter</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">resourceShortages</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">triggerResourceAlert</span><span class="p">(</span><span class="nx">shelter</span><span class="p">,</span><span class="w"> </span><span class="nx">resourceShortages</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 健康問題警告チェック</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">status</span><span class="p">.</span><span class="nx">healthStatus</span><span class="p">.</span><span class="nx">infectionRisk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">triggerHealthAlert</span><span class="p">(</span><span class="nx">shelter</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="p">.</span><span class="nx">healthStatus</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 最適避難所推奨</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">recommendOptimalShelter</span><span class="p">(</span>
<span class="w">    </span><span class="nx">evacueeGroup</span><span class="o">:</span><span class="w"> </span><span class="kt">EvacueeGroup</span><span class="p">,</span>
<span class="w">    </span><span class="nx">availableShelters</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ShelterRecommendation</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">ShelterRecommendation</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">shelterId</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">availableShelters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">shelter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">shelters</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">shelterId</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">shelter</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 各種スコアの計算</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">accessibilityScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateAccessibilityScore</span><span class="p">(</span>
<span class="w">        </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">        </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">mobilityConstraints</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">capacityScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateCapacityScore</span><span class="p">(</span>
<span class="w">        </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">currentOccupancy</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">maxCapacity</span><span class="p">,</span>
<span class="w">        </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">size</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">suitabilityScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSuitabilityScore</span><span class="p">(</span>
<span class="w">        </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">requirements</span><span class="p">,</span>
<span class="w">        </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">facilities</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">safetyScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateSafetyScore</span><span class="p">(</span>
<span class="w">        </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">        </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">evacuationReason</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 総合スコア</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">overallScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="nx">accessibilityScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nx">capacityScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nx">suitabilityScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nx">safetyScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.2</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">recommendations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">shelter</span><span class="o">:</span><span class="w"> </span><span class="kt">shelter.id</span><span class="p">,</span>
<span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">shelter.name</span><span class="p">,</span>
<span class="w">        </span><span class="nx">overallScore</span><span class="p">,</span>
<span class="w">        </span><span class="nx">scores</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">accessibility</span><span class="o">:</span><span class="w"> </span><span class="kt">accessibilityScore</span><span class="p">,</span>
<span class="w">          </span><span class="nx">capacity</span><span class="o">:</span><span class="w"> </span><span class="kt">capacityScore</span><span class="p">,</span>
<span class="w">          </span><span class="nx">suitability</span><span class="o">:</span><span class="w"> </span><span class="kt">suitabilityScore</span><span class="p">,</span>
<span class="w">          </span><span class="nx">safety</span><span class="o">:</span><span class="w"> </span><span class="kt">safetyScore</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">estimatedTravelTime</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateTravelTime</span><span class="p">(</span>
<span class="w">          </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">          </span><span class="nx">shelter</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">          </span><span class="nx">evacueeGroup</span><span class="p">.</span><span class="nx">transportationMode</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="nx">specialNotes</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateSpecialNotes</span><span class="p">(</span><span class="nx">evacueeGroup</span><span class="p">,</span><span class="w"> </span><span class="nx">shelter</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// スコア順にソート</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">recommendations</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">overallScore</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">overallScore</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 避難所間の連携調整</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">coordinateShelterNetwork</span><span class="p">(</span>
<span class="w">    </span><span class="nx">networkShelters</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">NetworkCoordination</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">coordination</span><span class="o">:</span><span class="w"> </span><span class="kt">NetworkCoordination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">shelters</span><span class="o">:</span><span class="w"> </span><span class="kt">networkShelters</span><span class="p">,</span>
<span class="w">      </span><span class="nx">resourceDistribution</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">capacityBalancing</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">communicationPlan</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">establishShelterCommunication</span><span class="p">(</span><span class="nx">networkShelters</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// 資源分布の最適化</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">totalResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">aggregateShelterResources</span><span class="p">(</span><span class="nx">networkShelters</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">resourceNeeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessShelterNeeds</span><span class="p">(</span><span class="nx">networkShelters</span><span class="p">);</span>

<span class="w">    </span><span class="nx">coordination</span><span class="p">.</span><span class="nx">resourceDistribution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeResourceDistribution</span><span class="p">(</span>
<span class="w">      </span><span class="nx">totalResources</span><span class="p">,</span>
<span class="w">      </span><span class="nx">resourceNeeds</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 容量バランスの調整</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">occupancyData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getShelterOccupancyData</span><span class="p">(</span><span class="nx">networkShelters</span><span class="p">);</span>
<span class="w">    </span><span class="nx">coordination</span><span class="p">.</span><span class="nx">capacityBalancing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">planCapacityBalancing</span><span class="p">(</span><span class="nx">occupancyData</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">coordination</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SituationBoard</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">overallRisk</span><span class="o">:</span><span class="w"> </span><span class="kt">RiskLevel</span><span class="p">;</span>
<span class="w">  </span><span class="nx">weatherStatus</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">waterStatus</span><span class="o">:</span><span class="w"> </span><span class="kt">WaterLevelStatus</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">evacuationStatus</span><span class="o">:</span><span class="w"> </span><span class="kt">EvacuationStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">resourceStatus</span><span class="o">:</span><span class="w"> </span><span class="kt">ResourceStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">damageReports</span><span class="o">:</span><span class="w"> </span><span class="kt">DamageReport</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">priorityActions</span><span class="o">:</span><span class="w"> </span><span class="kt">PriorityAction</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">recommendedDecisions</span><span class="o">:</span><span class="w"> </span><span class="kt">Decision</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">EvacuationDecision</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">area</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">decision</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;NONE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;PREPARE&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ADVISORY&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;ORDER&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;IMMEDIATE&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">riskLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">reasoning</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">evacuationTime</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">availableTime</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// minutes</span>
<span class="w">    </span><span class="nx">requiredTime</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// minutes</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">alternativeOptions</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">monitoringPoints</span><span class="o">:</span><span class="w"> </span><span class="kt">MonitoringPoint</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">DisasterProgression</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">currentSituation</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">progressionForecast</span><span class="o">:</span><span class="w"> </span><span class="kt">ProgressionForecast</span><span class="p">;</span>
<span class="w">  </span><span class="nx">damageEstimation</span><span class="o">:</span><span class="w"> </span><span class="kt">DamageEstimation</span><span class="p">;</span>
<span class="w">  </span><span class="nx">interventionOptions</span><span class="o">:</span><span class="w"> </span><span class="kt">InterventionOption</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updateInterval</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w"> </span><span class="c1">// minutes</span>
<span class="w">  </span><span class="nx">criticalTimePoints</span><span class="o">:</span><span class="w"> </span><span class="kt">CriticalTimePoint</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="iot">IoT・センサーネットワーク<a class="headerlink" href="#iot" title="Permanent link">&para;</a></h2>
<h3 id="_55">分散センサーシステム<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h3>
<h4 id="_56">無線センサーネットワーク<a class="headerlink" href="#_56" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>システム構成</th>
<th>技術仕様</th>
<th>機能・特徴</th>
<th>導入効果・用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>LoRaWAN気象センサー</td>
<td>920MHz帯、15km通信可能</td>
<td>低消費電力、広範囲カバー、電池駆動</td>
<td>山間部・離島の観測、精密農業、環境監視</td>
</tr>
<tr>
<td>5G気象センサー</td>
<td>ミリ波対応、超低遅延</td>
<td>大容量・高速通信、エッジ処理</td>
<td>都市部高密度観測、リアルタイム制御、自動運転支援</td>
</tr>
<tr>
<td>衛星IoT</td>
<td>LEO衛星、全球カバー</td>
<td>グローバル通信、高信頼性</td>
<td>海洋・極地観測、災害時バックアップ</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// IoTセンサーネットワーク管理システム</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">IoTWeatherSensorNetwork</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">sensors</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">IoTWeatherSensor</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">gateways</span><span class="o">:</span><span class="w"> </span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">LoRaWANGateway</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">dataAggregator</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorDataAggregator</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">edgeProcessor</span><span class="o">:</span><span class="w"> </span><span class="kt">EdgeDataProcessor</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">dataAggregator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">SensorDataAggregator</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">edgeProcessor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">EdgeDataProcessor</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// センサーネットワークの展開</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">deploySensorNetwork</span><span class="p">(</span>
<span class="w">    </span><span class="nx">deploymentPlan</span><span class="o">:</span><span class="w"> </span><span class="kt">NetworkDeploymentPlan</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DeploymentResult</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">deploymentResults</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorDeploymentResult</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">sensorConfig</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">deploymentPlan</span><span class="p">.</span><span class="nx">sensors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// センサーデバイスの設定</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">sensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">configureSensor</span><span class="p">(</span><span class="nx">sensorConfig</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// ネットワークへの登録</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">registerSensorToNetwork</span><span class="p">(</span><span class="nx">sensor</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 初期データ取得テスト</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">initialData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">getInitialReading</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 正常性確認</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">healthCheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">performHealthCheck</span><span class="p">(</span><span class="nx">sensor</span><span class="p">);</span>

<span class="w">        </span><span class="nx">deploymentResults</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">sensorId</span><span class="o">:</span><span class="w"> </span><span class="kt">sensor.id</span><span class="p">,</span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;SUCCESS&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">initialData</span><span class="p">,</span>
<span class="w">          </span><span class="nx">healthCheck</span><span class="p">,</span>
<span class="w">          </span><span class="nx">signalStrength</span><span class="o">:</span><span class="w"> </span><span class="kt">sensor.getSignalStrength</span><span class="p">()</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">sensors</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">sensor</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">sensor</span><span class="p">);</span>

<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">deploymentResults</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">sensorId</span><span class="o">:</span><span class="w"> </span><span class="kt">sensorConfig.id</span><span class="p">,</span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;FAILED&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">error.message</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// ネットワーク最適化</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeNetworkTopology</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">planId</span><span class="o">:</span><span class="w"> </span><span class="kt">deploymentPlan.id</span><span class="p">,</span>
<span class="w">      </span><span class="nx">totalSensors</span><span class="o">:</span><span class="w"> </span><span class="kt">deploymentPlan.sensors.length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">successfulDeployments</span><span class="o">:</span><span class="w"> </span><span class="kt">deploymentResults.filter</span><span class="p">(</span><span class="nx">r</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">r</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;SUCCESS&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">deploymentResults</span><span class="p">,</span>
<span class="w">      </span><span class="nx">networkCoverage</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">calculateNetworkCoverage</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">estimatedBatteryLife</span><span class="o">:</span><span class="w"> </span><span class="kt">this.estimateNetworkBatteryLife</span><span class="p">()</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// リアルタイムデータ処理パイプライン</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">setupDataProcessingPipeline</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// センサーからのデータストリーム監視</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">sensors</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">sensor</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">onDataReceived</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// 1. データ品質チェック</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">qualityCheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">validateSensorData</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">qualityCheck</span><span class="p">.</span><span class="nx">isValid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="sb">`Invalid data from sensor </span><span class="si">${</span><span class="nx">sensor</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">qualityCheck</span><span class="p">.</span><span class="nx">issues</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// 2. エッジでの前処理</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">processedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">edgeProcessor</span><span class="p">.</span><span class="nx">preprocess</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="w">          </span><span class="c1">// 3. 異常検知</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">detectDataAnomaly</span><span class="p">(</span><span class="nx">processedData</span><span class="p">);</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">anomaly</span><span class="p">.</span><span class="nx">detected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleAnomalousData</span><span class="p">(</span><span class="nx">sensor</span><span class="p">,</span><span class="w"> </span><span class="nx">anomaly</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// 4. リアルタイム分析</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">realtimeAnalysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">performRealtimeAnalysis</span><span class="p">(</span><span class="nx">processedData</span><span class="p">);</span>

<span class="w">          </span><span class="c1">// 5. アラート評価</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">alerts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">evaluateAlerts</span><span class="p">(</span><span class="nx">realtimeAnalysis</span><span class="p">);</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">alerts</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">processAlerts</span><span class="p">(</span><span class="nx">alerts</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// 6. データ集約・保存</span>
<span class="w">          </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">dataAggregator</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span><span class="nx">processedData</span><span class="p">);</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Error processing data from sensor </span><span class="si">${</span><span class="nx">sensor</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">:`</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">          </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">reportProcessingError</span><span class="p">(</span><span class="nx">sensor</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 適応型センサー制御</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">implementAdaptiveSensorControl</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 気象状況に応じた測定頻度の動的調整</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherConditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getCurrentWeatherConditions</span><span class="p">();</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sensorId</span><span class="p">,</span><span class="w"> </span><span class="nx">sensor</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sensors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">getConfiguration</span><span class="p">();</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">newConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">currentConfig</span><span class="w"> </span><span class="p">};</span>

<span class="w">      </span><span class="c1">// 激しい気象現象時は測定頻度を上げる</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">weatherConditions</span><span class="p">.</span><span class="nx">severity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">measurementInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span>
<span class="w">          </span><span class="nx">currentConfig</span><span class="p">.</span><span class="nx">measurementInterval</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">          </span><span class="mf">60</span><span class="w"> </span><span class="c1">// 最低1分間隔</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">transmissionPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span>
<span class="w">          </span><span class="nx">currentConfig</span><span class="p">.</span><span class="nx">transmissionPower</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span>
<span class="w">          </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">maxTransmissionPower</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="c1">// 通常時は電力節約モード</span>
<span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">weatherConditions</span><span class="p">.</span><span class="nx">severity</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">measurementInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span>
<span class="w">          </span><span class="nx">currentConfig</span><span class="p">.</span><span class="nx">measurementInterval</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span>
<span class="w">          </span><span class="mf">1800</span><span class="w"> </span><span class="c1">// 最大30分間隔</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">transmissionPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span>
<span class="w">          </span><span class="nx">currentConfig</span><span class="p">.</span><span class="nx">transmissionPower</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span>
<span class="w">          </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">minTransmissionPower</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// バッテリー残量に応じた調整</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">batteryLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">getBatteryLevel</span><span class="p">();</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">batteryLevel</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">20</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">measurementInterval</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w"> </span><span class="c1">// 測定間隔を倍に</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">transmissionPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">minTransmissionPower</span><span class="p">;</span><span class="w"> </span><span class="c1">// 最小出力</span>
<span class="w">        </span><span class="nx">newConfig</span><span class="p">.</span><span class="nx">sleepMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// スリープモード有効</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 設定の更新</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">currentConfig</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">newConfig</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">updateConfiguration</span><span class="p">(</span><span class="nx">newConfig</span><span class="p">);</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Updated configuration for sensor </span><span class="si">${</span><span class="nx">sensorId</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">old</span><span class="o">:</span><span class="w"> </span><span class="kt">currentConfig</span><span class="p">,</span>
<span class="w">          </span><span class="nx">new</span><span class="o">:</span><span class="w"> </span><span class="kt">newConfig</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// メッシュネットワーク自己修復</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">enableSelfHealingMesh</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ネットワーク接続状況の定期チェック</span>
<span class="w">    </span><span class="nx">setInterval</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">networkHealth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessNetworkHealth</span><span class="p">();</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">networkHealth</span><span class="p">.</span><span class="nx">overall</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Network degradation detected, initiating self-healing...&#39;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 接続断のノードを特定</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">disconnectedNodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">networkHealth</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="nx">n</span><span class="p">.</span><span class="nx">connected</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">disconnectedNodes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">recoveryOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">findRecoveryOptions</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>

<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">option</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">recoveryOptions</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">attemptRecovery</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span><span class="w"> </span><span class="nx">option</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Successfully recovered node </span><span class="si">${</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb"> using </span><span class="si">${</span><span class="nx">option</span><span class="p">.</span><span class="nx">method</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">              </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// ネットワークトポロジーの再最適化</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeNetworkTopology</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">300000</span><span class="p">);</span><span class="w"> </span><span class="c1">// 5分間隔</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Edge AI による局地予測</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">deployEdgeAI</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">EdgeAIDeployment</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">edgeModels</span><span class="o">:</span><span class="w"> </span><span class="kt">EdgeAIModel</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">gatewayId</span><span class="p">,</span><span class="w"> </span><span class="nx">gateway</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">gateways</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// ゲートウェイに適した軽量AIモデルの選択</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">modelSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">selectOptimalEdgeModel</span><span class="p">(</span><span class="nx">gateway</span><span class="p">.</span><span class="nx">specifications</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// モデルの展開</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">deployedModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">gateway</span><span class="p">.</span><span class="nx">deployAIModel</span><span class="p">(</span><span class="nx">modelSpec</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 初期訓練データの転送</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">initialTrainingData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">prepareInitialTrainingData</span><span class="p">(</span><span class="nx">gatewayId</span><span class="p">);</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">deployedModel</span><span class="p">.</span><span class="nx">initialTrain</span><span class="p">(</span><span class="nx">initialTrainingData</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 継続学習の設定</span>
<span class="w">      </span><span class="nx">deployedModel</span><span class="p">.</span><span class="nx">onNewData</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">newData</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// フェデレーテッドラーニングによる改善</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">deployedModel</span><span class="p">.</span><span class="nx">incrementalTrain</span><span class="p">(</span><span class="nx">newData</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 予測精度の評価</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">accuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">deployedModel</span><span class="p">.</span><span class="nx">evaluateAccuracy</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 精度が低下した場合はモデル更新を要求</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">accuracy</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.85</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">requestModelUpdate</span><span class="p">(</span><span class="nx">gatewayId</span><span class="p">,</span><span class="w"> </span><span class="nx">deployedModel</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="nx">edgeModels</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">gatewayId</span><span class="p">,</span>
<span class="w">        </span><span class="nx">model</span><span class="o">:</span><span class="w"> </span><span class="kt">deployedModel</span><span class="p">,</span>
<span class="w">        </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="kt">modelSpec.capabilities</span><span class="p">,</span>
<span class="w">        </span><span class="nx">performanceMetrics</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="nx">deployedModel</span><span class="p">.</span><span class="nx">getPerformanceMetrics</span><span class="p">()</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">deployedModels</span><span class="o">:</span><span class="w"> </span><span class="kt">edgeModels</span><span class="p">,</span>
<span class="w">      </span><span class="nx">totalCapabilities</span><span class="o">:</span><span class="w"> </span><span class="kt">this.aggregateEdgeCapabilities</span><span class="p">(</span><span class="nx">edgeModels</span><span class="p">),</span>
<span class="w">      </span><span class="nx">expectedLatencyReduction</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateLatencyReduction</span><span class="p">(</span><span class="nx">edgeModels</span><span class="p">),</span>
<span class="w">      </span><span class="nx">estimatedAccuracyImprovement</span><span class="o">:</span><span class="w"> </span><span class="kt">this.estimateAccuracyImprovement</span><span class="p">(</span><span class="nx">edgeModels</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// センサー故障予測・予防保全</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">implementPredictiveMaintenance</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">MaintenanceSchedule</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">maintenanceSchedule</span><span class="o">:</span><span class="w"> </span><span class="kt">MaintenanceTask</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">sensorId</span><span class="p">,</span><span class="w"> </span><span class="nx">sensor</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">sensors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// センサーの健康状態データ収集</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">healthData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">sensor</span><span class="p">.</span><span class="nx">getHealthDiagnostics</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 故障予測モデルによる分析</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">failurePrediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictSensorFailure</span><span class="p">(</span><span class="nx">healthData</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">failurePrediction</span><span class="p">.</span><span class="nx">riskLevel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">maintenanceSchedule</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">sensorId</span><span class="p">,</span>
<span class="w">          </span><span class="nx">taskType</span><span class="o">:</span><span class="w"> </span><span class="kt">failurePrediction.riskLevel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.8</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;REPLACEMENT&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MAINTENANCE&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">predictedFailureDate</span><span class="o">:</span><span class="w"> </span><span class="kt">failurePrediction.estimatedFailureDate</span><span class="p">,</span>
<span class="w">          </span><span class="nx">recommendedActionDate</span><span class="o">:</span><span class="w"> </span><span class="kt">failurePrediction.recommendedActionDate</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateMaintenancePriority</span><span class="p">(</span><span class="nx">sensor</span><span class="p">,</span><span class="w"> </span><span class="nx">failurePrediction</span><span class="p">),</span>
<span class="w">          </span><span class="nx">estimatedCost</span><span class="o">:</span><span class="w"> </span><span class="kt">this.estimateMaintenanceCost</span><span class="p">(</span><span class="nx">sensor</span><span class="p">,</span><span class="w"> </span><span class="nx">failurePrediction</span><span class="p">.</span><span class="nx">riskLevel</span><span class="p">),</span>
<span class="w">          </span><span class="nx">requiredParts</span><span class="o">:</span><span class="w"> </span><span class="kt">this.identifyRequiredParts</span><span class="p">(</span><span class="nx">sensor</span><span class="p">,</span><span class="w"> </span><span class="nx">failurePrediction</span><span class="p">)</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// バッテリー交換予測</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">batteryPrediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictBatteryReplacement</span><span class="p">(</span><span class="nx">sensor</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">batteryPrediction</span><span class="p">.</span><span class="nx">daysRemaining</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">30</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">maintenanceSchedule</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">          </span><span class="nx">sensorId</span><span class="p">,</span>
<span class="w">          </span><span class="nx">taskType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;BATTERY_REPLACEMENT&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">predictedFailureDate</span><span class="o">:</span><span class="w"> </span><span class="kt">batteryPrediction.estimatedDepletionDate</span><span class="p">,</span>
<span class="w">          </span><span class="nx">recommendedActionDate</span><span class="o">:</span><span class="w"> </span><span class="kt">batteryPrediction.recommendedReplacementDate</span><span class="p">,</span>
<span class="w">          </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">estimatedCost</span><span class="o">:</span><span class="w"> </span><span class="kt">this.getBatteryCost</span><span class="p">(</span><span class="nx">sensor</span><span class="p">.</span><span class="nx">batteryType</span><span class="p">),</span>
<span class="w">          </span><span class="nx">requiredParts</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">sensor</span><span class="p">.</span><span class="nx">batteryType</span><span class="p">]</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// メンテナンススケジュールの最適化</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">optimizedSchedule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeMaintenanceSchedule</span><span class="p">(</span><span class="nx">maintenanceSchedule</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">schedule</span><span class="o">:</span><span class="w"> </span><span class="kt">optimizedSchedule</span><span class="p">,</span>
<span class="w">      </span><span class="nx">totalCost</span><span class="o">:</span><span class="w"> </span><span class="kt">optimizedSchedule.reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span><span class="w"> </span><span class="nx">task</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">estimatedCost</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">),</span>
<span class="w">      </span><span class="nx">criticalTasks</span><span class="o">:</span><span class="w"> </span><span class="kt">optimizedSchedule.filter</span><span class="p">(</span><span class="nx">task</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">task</span><span class="p">.</span><span class="nx">priority</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nx">resourceRequirements</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateResourceRequirements</span><span class="p">(</span><span class="nx">optimizedSchedule</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">IoTWeatherSensor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">SensorType</span><span class="p">;</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoLocation</span><span class="p">;</span>
<span class="w">  </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorCapability</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">configuration</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorConfiguration</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batteryType</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxTransmissionPower</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">minTransmissionPower</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>

<span class="w">  </span><span class="nx">getInitialReading</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SensorReading</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getBatteryLevel</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">number</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getSignalStrength</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getConfiguration</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">SensorConfiguration</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updateConfiguration</span><span class="p">(</span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorConfiguration</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getHealthDiagnostics</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SensorHealthData</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onDataReceived</span><span class="p">(</span><span class="nx">callback</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">NetworkDeploymentPlan</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sensors</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorDeploymentConfig</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">gateways</span><span class="o">:</span><span class="w"> </span><span class="kt">GatewayDeploymentConfig</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">coverage</span><span class="o">:</span><span class="w"> </span><span class="kt">CoverageRequirement</span><span class="p">;</span>
<span class="w">  </span><span class="nx">redundancy</span><span class="o">:</span><span class="w"> </span><span class="kt">RedundancyLevel</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">EdgeAIModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">capabilities</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">initialTrain</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">incrementalTrain</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">predict</span><span class="p">(</span><span class="nx">input</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">PredictionResult</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">evaluateAccuracy</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">number</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">getPerformanceMetrics</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ModelMetrics</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">onNewData</span><span class="p">(</span><span class="nx">callback</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="kt">SensorReading</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">void</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="_57">モバイル・個人向けアプリケーション<a class="headerlink" href="#_57" title="Permanent link">&para;</a></h2>
<h3 id="_58">次世代気象アプリ<a class="headerlink" href="#_58" title="Permanent link">&para;</a></h3>
<h4 id="_59">パーソナライズド気象情報<a class="headerlink" href="#_59" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>技術・機能</th>
<th>特徴</th>
<th>ユーザー体験向上</th>
<th>実装技術例</th>
</tr>
</thead>
<tbody>
<tr>
<td>位置ベース超局地予報</td>
<td>100m単位の詳細予報</td>
<td>行動に直結する情報提供</td>
<td>GPS、機械学習、高解像度モデル</td>
</tr>
<tr>
<td>AI個人アシスタント</td>
<td>文脈理解・対話型UI</td>
<td>自然な質問・相談が可能</td>
<td>NLP、対話AI、パーソナライゼーション</td>
</tr>
<tr>
<td>AR現実重畳表示</td>
<td>カメラ越しの気象情報</td>
<td>直感的な状況把握</td>
<td>ARCore/ARKit、3D可視化</td>
</tr>
</tbody>
</table>
<details class="typescript実装例">
<summary>Typescript実装例</summary>
<div class="highlight"><pre><span></span><code><span class="c1">// パーソナライズ気象アプリ</span>
<span class="kd">class</span><span class="w"> </span><span class="nx">PersonalizedWeatherApp</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">userProfile</span><span class="o">:</span><span class="w"> </span><span class="kt">UserProfile</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">locationService</span><span class="o">:</span><span class="w"> </span><span class="kt">LocationService</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">aiAssistant</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherAI</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">arRenderer</span><span class="o">:</span><span class="w"> </span><span class="kt">ARWeatherRenderer</span><span class="p">;</span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">notificationManager</span><span class="o">:</span><span class="w"> </span><span class="kt">SmartNotificationManager</span><span class="p">;</span>

<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">locationService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">LocationService</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">aiAssistant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">WeatherAI</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ARWeatherRenderer</span><span class="p">();</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">notificationManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">SmartNotificationManager</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ユーザープロファイルベース予報</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">getPersonalizedForecast</span><span class="p">(</span>
<span class="w">    </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">PersonalizedForecast</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getUserProfile</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">locationService</span><span class="p">.</span><span class="nx">getCurrentLocation</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 基本予報の取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">baseForecast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getBaseForecast</span><span class="p">(</span><span class="nx">currentLocation</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// ユーザーの活動予定との照合</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">upcomingActivities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getUpcomingActivities</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 個人設定に基づく詳細化</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">personalizedSteps</span><span class="o">:</span><span class="w"> </span><span class="kt">PersonalizedTimeStep</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">timeStep</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">baseForecast</span><span class="p">.</span><span class="nx">timeSteps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">personalInfo</span><span class="o">:</span><span class="w"> </span><span class="kt">PersonalizedInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">comfortLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateComfortLevel</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">preferences</span><span class="p">),</span>
<span class="w">        </span><span class="nx">clothingRecommendation</span><span class="o">:</span><span class="w"> </span><span class="kt">this.recommendClothing</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">profile</span><span class="p">),</span>
<span class="w">        </span><span class="nx">activitySuitability</span><span class="o">:</span><span class="w"> </span><span class="kt">this.assessActivitySuitability</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">upcomingActivities</span><span class="p">),</span>
<span class="w">        </span><span class="nx">healthAlerts</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateHealthAlerts</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">healthConditions</span><span class="p">),</span>
<span class="w">        </span><span class="nx">transportationAdvice</span><span class="o">:</span><span class="w"> </span><span class="kt">this.provideTransportationAdvice</span><span class="p">(</span><span class="nx">timeStep</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">transportationModes</span><span class="p">)</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="nx">personalizedSteps</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">baseTimeStep</span><span class="o">:</span><span class="w"> </span><span class="kt">timeStep</span><span class="p">,</span>
<span class="w">        </span><span class="nx">personalizedInfo</span><span class="o">:</span><span class="w"> </span><span class="kt">personalInfo</span><span class="p">,</span>
<span class="w">        </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculatePersonalizationConfidence</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">timeStep</span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">userId</span><span class="p">,</span>
<span class="w">      </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">currentLocation</span><span class="p">,</span>
<span class="w">      </span><span class="nx">forecast</span><span class="o">:</span><span class="w"> </span><span class="kt">personalizedSteps</span><span class="p">,</span>
<span class="w">      </span><span class="nx">summary</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generatePersonalSummary</span><span class="p">(</span><span class="nx">personalizedSteps</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">),</span>
<span class="w">      </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generatePersonalRecommendations</span><span class="p">(</span><span class="nx">personalizedSteps</span><span class="p">,</span><span class="w"> </span><span class="nx">upcomingActivities</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// AI対話型アシスタント</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processNaturalLanguageQuery</span><span class="p">(</span>
<span class="w">    </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">context?</span><span class="o">:</span><span class="w"> </span><span class="kt">ConversationContext</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">AIResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getUserProfile</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">locationService</span><span class="p">.</span><span class="nx">getCurrentLocation</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 意図解析</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">aiAssistant</span><span class="p">.</span><span class="nx">analyzeIntent</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 応答生成</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">response</span><span class="o">:</span><span class="w"> </span><span class="kt">AIResponse</span><span class="p">;</span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">intent</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;weather_inquiry&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleWeatherInquiry</span><span class="p">(</span><span class="nx">intent</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;activity_planning&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleActivityPlanning</span><span class="p">(</span><span class="nx">intent</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;clothing_advice&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleClothingAdvice</span><span class="p">(</span><span class="nx">intent</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;travel_advice&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleTravelAdvice</span><span class="p">(</span><span class="nx">intent</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;alert_inquiry&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleAlertInquiry</span><span class="p">(</span><span class="nx">intent</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="p">);</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="nx">default</span><span class="o">:</span>
<span class="w">        </span><span class="kt">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">handleGeneralInquiry</span><span class="p">(</span><span class="nx">intent</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">location</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 学習データとしての蓄積</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">aiAssistant</span><span class="p">.</span><span class="nx">recordInteraction</span><span class="p">({</span>
<span class="w">      </span><span class="nx">userId</span><span class="p">,</span>
<span class="w">      </span><span class="nx">query</span><span class="p">,</span>
<span class="w">      </span><span class="nx">intent</span><span class="p">,</span>
<span class="w">      </span><span class="nx">response</span><span class="p">,</span>
<span class="w">      </span><span class="nx">context</span><span class="p">,</span>
<span class="w">      </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">()</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// AR現実重畳表示</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">renderARWeatherOverlay</span><span class="p">(</span>
<span class="w">    </span><span class="nx">cameraFrame</span><span class="o">:</span><span class="w"> </span><span class="kt">CameraFrame</span><span class="p">,</span>
<span class="w">    </span><span class="nx">deviceOrientation</span><span class="o">:</span><span class="w"> </span><span class="kt">DeviceOrientation</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ARWeatherOverlay</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">locationService</span><span class="p">.</span><span class="nx">getCurrentLocation</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentWeather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getCurrentWeather</span><span class="p">(</span><span class="nx">location</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// カメラ映像の解析</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">sceneAnalysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="p">.</span><span class="nx">analyzeScene</span><span class="p">(</span><span class="nx">cameraFrame</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3D空間での気象情報配置</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherElements</span><span class="o">:</span><span class="w"> </span><span class="kt">AR3DElement</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 1. 雲の可視化</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">currentWeather</span><span class="p">.</span><span class="nx">cloudCover</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">cloudLayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="p">.</span><span class="nx">renderClouds</span><span class="p">({</span>
<span class="w">        </span><span class="nx">coverage</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.cloudCover</span><span class="p">,</span>
<span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.cloudBase</span><span class="p">,</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">currentWeather</span><span class="p">.</span><span class="nx">cloudType</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="nx">weatherElements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cloudLayer</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 2. 降水の可視化</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">currentWeather</span><span class="p">.</span><span class="nx">precipitation</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">precipitationEffect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="p">.</span><span class="nx">renderPrecipitation</span><span class="p">({</span>
<span class="w">        </span><span class="nx">intensity</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.precipitation</span><span class="p">,</span>
<span class="w">        </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="nx">currentWeather</span><span class="p">.</span><span class="nx">precipitationType</span><span class="p">,</span>
<span class="w">        </span><span class="nx">windSpeed</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.windSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nx">windDirection</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.windDirection</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="nx">weatherElements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">precipitationEffect</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 3. 風の可視化</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">currentWeather</span><span class="p">.</span><span class="nx">windSpeed</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">windParticles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="p">.</span><span class="nx">renderWindFlow</span><span class="p">({</span>
<span class="w">        </span><span class="nx">speed</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.windSpeed</span><span class="p">,</span>
<span class="w">        </span><span class="nx">direction</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.windDirection</span><span class="p">,</span>
<span class="w">        </span><span class="nx">gustiness</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.windGust</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="nx">weatherElements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">windParticles</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 4. 温度・湿度の表示</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">comfortInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="p">.</span><span class="nx">renderComfortIndicators</span><span class="p">({</span>
<span class="w">      </span><span class="nx">temperature</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.temperature</span><span class="p">,</span>
<span class="w">      </span><span class="nx">humidity</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.humidity</span><span class="p">,</span>
<span class="w">      </span><span class="nx">uvIndex</span><span class="o">:</span><span class="w"> </span><span class="kt">currentWeather.uvIndex</span><span class="p">,</span>
<span class="w">      </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">sceneAnalysis.groundPlane</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="nx">weatherElements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">comfortInfo</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 5. 警報・注意事項の表示</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">alerts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getActiveAlerts</span><span class="p">(</span><span class="nx">location</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">alerts</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">alertOverlays</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">arRenderer</span><span class="p">.</span><span class="nx">renderAlerts</span><span class="p">(</span>
<span class="w">        </span><span class="nx">alerts</span><span class="p">,</span>
<span class="w">        </span><span class="nx">sceneAnalysis</span><span class="p">.</span><span class="nx">freeSpace</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="nx">weatherElements</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nx">alertOverlays</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">elements</span><span class="o">:</span><span class="w"> </span><span class="kt">weatherElements</span><span class="p">,</span>
<span class="w">      </span><span class="nx">trackingQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">this.arRenderer.getTrackingQuality</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">renderingStats</span><span class="o">:</span><span class="w"> </span><span class="kt">this.arRenderer.getRenderingStats</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">interactionPoints</span><span class="o">:</span><span class="w"> </span><span class="kt">this.identifyInteractionPoints</span><span class="p">(</span><span class="nx">weatherElements</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// スマート通知システム</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">configureSmartNotifications</span><span class="p">(</span>
<span class="w">    </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">preferences</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationPreferences</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">NotificationConfiguration</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getUserProfile</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">configuration</span><span class="o">:</span><span class="w"> </span><span class="kt">NotificationConfiguration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">userId</span><span class="p">,</span>
<span class="w">      </span><span class="nx">preferences</span><span class="p">,</span>
<span class="w">      </span><span class="nx">triggers</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">(),</span>
<span class="w">      </span><span class="nx">deliveryMethods</span><span class="o">:</span><span class="w"> </span><span class="kt">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeDeliveryMethods</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">preferences</span><span class="p">),</span>
<span class="w">      </span><span class="nx">schedulingRules</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateSchedulingRules</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">preferences</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// カスタム通知トリガーの設定</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">trigger</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">preferences</span><span class="p">.</span><span class="nx">customTriggers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">smartTrigger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createSmartTrigger</span><span class="p">(</span><span class="nx">trigger</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">);</span>
<span class="w">      </span><span class="nx">configuration</span><span class="p">.</span><span class="nx">triggers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">smartTrigger</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 機械学習による最適化</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mlOptimization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">optimizeNotificationsWithML</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
<span class="w">    </span><span class="nx">configuration</span><span class="p">.</span><span class="nx">mlOptimization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mlOptimization</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">configuration</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 位置予測による先読み情報</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">providePredictiveWeatherInfo</span><span class="p">(</span>
<span class="w">    </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">PredictiveWeatherInfo</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getUserProfile</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">locationService</span><span class="p">.</span><span class="nx">getCurrentLocation</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 移動パターンの分析</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">movementPrediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">predictUserMovement</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 予測経路に沿った気象情報</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">routeWeather</span><span class="o">:</span><span class="w"> </span><span class="kt">RouteWeatherInfo</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">waypoint</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">movementPrediction</span><span class="p">.</span><span class="nx">predictedRoute</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">waypointWeather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getWeatherAtLocation</span><span class="p">(</span>
<span class="w">        </span><span class="nx">waypoint</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span>
<span class="w">        </span><span class="nx">waypoint</span><span class="p">.</span><span class="nx">estimatedTime</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="nx">routeWeather</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="nx">waypoint</span><span class="p">,</span>
<span class="w">        </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="kt">waypointWeather</span><span class="p">,</span>
<span class="w">        </span><span class="nx">recommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateLocationRecommendations</span><span class="p">(</span>
<span class="w">          </span><span class="nx">waypointWeather</span><span class="p">,</span>
<span class="w">          </span><span class="nx">waypoint</span><span class="p">,</span>
<span class="w">          </span><span class="nx">user</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// タイムラインベースの情報整理</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createWeatherTimeline</span><span class="p">(</span><span class="nx">routeWeather</span><span class="p">,</span><span class="w"> </span><span class="nx">user</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">movementPrediction</span><span class="p">,</span>
<span class="w">      </span><span class="nx">routeWeather</span><span class="p">,</span>
<span class="w">      </span><span class="nx">timeline</span><span class="p">,</span>
<span class="w">      </span><span class="nx">proactiveAlerts</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateProactiveAlerts</span><span class="p">(</span><span class="nx">routeWeather</span><span class="p">),</span>
<span class="w">      </span><span class="nx">confidenceLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">movementPrediction.confidence</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ソーシャル天気情報</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">integrateUserGeneratedContent</span><span class="p">(</span>
<span class="w">    </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoLocation</span><span class="p">,</span>
<span class="w">    </span><span class="nx">radius</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10</span><span class="w"> </span><span class="c1">// km</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">SocialWeatherInfo</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 周辺ユーザーからの投稿取得</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">userReports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getUserReportsInArea</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span><span class="w"> </span><span class="nx">radius</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 写真・動画の解析</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mediaAnalysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeUserMedia</span><span class="p">(</span><span class="nx">userReports</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// テキスト投稿の感情・意図分析</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">sentimentAnalysis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">analyzeSentiment</span><span class="p">(</span><span class="nx">userReports</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 信頼度スコアリング</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">scoredReports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">scoreReportReliability</span><span class="p">(</span><span class="nx">userReports</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 統計的集約</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">aggregatedInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">aggregateUserReports</span><span class="p">(</span><span class="nx">scoredReports</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">location</span><span class="p">,</span>
<span class="w">      </span><span class="nx">reportCount</span><span class="o">:</span><span class="w"> </span><span class="kt">userReports.length</span><span class="p">,</span>
<span class="w">      </span><span class="nx">aggregatedInfo</span><span class="p">,</span>
<span class="w">      </span><span class="nx">topReliableReports</span><span class="o">:</span><span class="w"> </span><span class="kt">scoredReports.slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">),</span>
<span class="w">      </span><span class="nx">trendAnalysis</span><span class="o">:</span><span class="w"> </span><span class="kt">this.analyzeTrends</span><span class="p">(</span><span class="nx">scoredReports</span><span class="p">),</span>
<span class="w">      </span><span class="nx">confidenceMetrics</span><span class="o">:</span><span class="w"> </span><span class="kt">this.calculateSocialConfidence</span><span class="p">(</span><span class="nx">scoredReports</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ヘルスケア統合</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">integrateHealthcareAdvice</span><span class="p">(</span>
<span class="w">    </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">healthData</span><span class="o">:</span><span class="w"> </span><span class="kt">HealthData</span>
<span class="w">  </span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">HealthWeatherAdvice</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">weather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getCurrentWeather</span><span class="p">(</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">locationService</span><span class="p">.</span><span class="nx">getCurrentLocation</span><span class="p">()</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">advice</span><span class="o">:</span><span class="w"> </span><span class="kt">HealthAdviceItem</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="c1">// 気象関連健康リスク評価</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">healthRisks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">assessWeatherHealthRisks</span><span class="p">(</span><span class="nx">weather</span><span class="p">,</span><span class="w"> </span><span class="nx">healthData</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">risk</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">healthRisks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">risk</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;heat_stress&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">advice</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">generateHeatStressAdvice</span><span class="p">(</span><span class="nx">risk</span><span class="p">,</span><span class="w"> </span><span class="nx">healthData</span><span class="p">));</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;cold_stress&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">advice</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">generateColdStressAdvice</span><span class="p">(</span><span class="nx">risk</span><span class="p">,</span><span class="w"> </span><span class="nx">healthData</span><span class="p">));</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;air_quality&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">advice</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">generateAirQualityAdvice</span><span class="p">(</span><span class="nx">risk</span><span class="p">,</span><span class="w"> </span><span class="nx">healthData</span><span class="p">));</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;uv_exposure&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">advice</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">generateUVAdvice</span><span class="p">(</span><span class="nx">risk</span><span class="p">,</span><span class="w"> </span><span class="nx">healthData</span><span class="p">));</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;barometric_pressure&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">advice</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">generatePressureAdvice</span><span class="p">(</span><span class="nx">risk</span><span class="p">,</span><span class="w"> </span><span class="nx">healthData</span><span class="p">));</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 運動・アクティビティ推奨</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">activityRecommendations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateActivityRecommendations</span><span class="p">(</span>
<span class="w">      </span><span class="nx">weather</span><span class="p">,</span>
<span class="w">      </span><span class="nx">healthData</span><span class="p">,</span>
<span class="w">      </span><span class="nx">advice</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">userId</span><span class="p">,</span>
<span class="w">      </span><span class="nx">weather</span><span class="p">,</span>
<span class="w">      </span><span class="nx">healthRisks</span><span class="p">,</span>
<span class="w">      </span><span class="nx">advice</span><span class="p">,</span>
<span class="w">      </span><span class="nx">activityRecommendations</span><span class="p">,</span>
<span class="w">      </span><span class="nx">emergencyContacts</span><span class="o">:</span><span class="w"> </span><span class="kt">healthData.emergencyContacts</span><span class="p">,</span>
<span class="w">      </span><span class="nx">monitoringRecommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">this.generateMonitoringRecommendations</span><span class="p">(</span><span class="nx">healthRisks</span><span class="p">)</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">preferences</span><span class="o">:</span><span class="w"> </span><span class="kt">UserPreferences</span><span class="p">;</span>
<span class="w">  </span><span class="nx">profile</span><span class="o">:</span><span class="w"> </span><span class="kt">PersonalProfile</span><span class="p">;</span>
<span class="w">  </span><span class="nx">healthConditions</span><span class="o">:</span><span class="w"> </span><span class="kt">HealthCondition</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">transportationModes</span><span class="o">:</span><span class="w"> </span><span class="kt">TransportationMode</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">activities</span><span class="o">:</span><span class="w"> </span><span class="kt">ScheduledActivity</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">PersonalizedTimeStep</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">baseTimeStep</span><span class="o">:</span><span class="w"> </span><span class="kt">WeatherTimeStep</span><span class="p">;</span>
<span class="w">  </span><span class="nx">personalizedInfo</span><span class="o">:</span><span class="w"> </span><span class="kt">PersonalizedInfo</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">PersonalizedInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">comfortLevel</span><span class="o">:</span><span class="w"> </span><span class="kt">ComfortLevel</span><span class="p">;</span>
<span class="w">  </span><span class="nx">clothingRecommendation</span><span class="o">:</span><span class="w"> </span><span class="kt">ClothingRecommendation</span><span class="p">;</span>
<span class="w">  </span><span class="nx">activitySuitability</span><span class="o">:</span><span class="w"> </span><span class="kt">ActivitySuitability</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">healthAlerts</span><span class="o">:</span><span class="w"> </span><span class="kt">HealthAlert</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">transportationAdvice</span><span class="o">:</span><span class="w"> </span><span class="kt">TransportationAdvice</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">AIResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">voiceOutput?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">visualElements</span><span class="o">:</span><span class="w"> </span><span class="kt">VisualElement</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">actions</span><span class="o">:</span><span class="w"> </span><span class="kt">SuggestedAction</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">followUpQuestions</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">ARWeatherOverlay</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">elements</span><span class="o">:</span><span class="w"> </span><span class="kt">AR3DElement</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">trackingQuality</span><span class="o">:</span><span class="w"> </span><span class="kt">TrackingQuality</span><span class="p">;</span>
<span class="w">  </span><span class="nx">renderingStats</span><span class="o">:</span><span class="w"> </span><span class="kt">RenderingStats</span><span class="p">;</span>
<span class="w">  </span><span class="nx">interactionPoints</span><span class="o">:</span><span class="w"> </span><span class="kt">InteractionPoint</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">SocialWeatherInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="kt">GeoLocation</span><span class="p">;</span>
<span class="w">  </span><span class="nx">reportCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">aggregatedInfo</span><span class="o">:</span><span class="w"> </span><span class="kt">AggregatedWeatherInfo</span><span class="p">;</span>
<span class="w">  </span><span class="nx">topReliableReports</span><span class="o">:</span><span class="w"> </span><span class="kt">UserWeatherReport</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">trendAnalysis</span><span class="o">:</span><span class="w"> </span><span class="kt">TrendAnalysis</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidenceMetrics</span><span class="o">:</span><span class="w"> </span><span class="kt">SocialConfidenceMetrics</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">interface</span><span class="w"> </span><span class="nx">HealthWeatherAdvice</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">userId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="kt">CurrentWeather</span><span class="p">;</span>
<span class="w">  </span><span class="nx">healthRisks</span><span class="o">:</span><span class="w"> </span><span class="kt">HealthRisk</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">advice</span><span class="o">:</span><span class="w"> </span><span class="kt">HealthAdviceItem</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">activityRecommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">ActivityRecommendation</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">emergencyContacts</span><span class="o">:</span><span class="w"> </span><span class="kt">EmergencyContact</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">monitoringRecommendations</span><span class="o">:</span><span class="w"> </span><span class="kt">MonitoringRecommendation</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><em>本ドキュメントは、状況認識と意思決定の観点から気象関連ソフトウェアを整理したものです。各システムの詳細や最新情報については、各開発機関・提供者にお問い合わせください。</em></p>
<h2 id="_60">まとめ<a class="headerlink" href="#_60" title="Permanent link">&para;</a></h2>
<p>気象関連ソフトウェアは、現代社会の安全と持続可能性を支える重要な基盤技術です。数値予報モデルから観測システム、AI予測まで幅広い技術分野にわたって急速に発展しています。</p>
<h3 id="_61">開発時の重要ポイント<a class="headerlink" href="#_61" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>精度と速度の両立</strong>: 高精度予測と実用的な処理速度の最適化</li>
<li><strong>多様なデータ統合</strong>: 観測・衛星・レーダーデータの効果的な融合</li>
<li><strong>リアルタイム処理</strong>: 迅速な警報発出と意思決定支援</li>
<li><strong>ユーザビリティ</strong>: 専門家から一般市民まで使いやすいインターフェース</li>
<li><strong>可用性・冗長性</strong>: 災害時にも動作する堅牢なシステム設計</li>
</ul>
<h3 id="_62">今後の展望<a class="headerlink" href="#_62" title="Permanent link">&para;</a></h3>
<p>気象ソフトウェアは、AI・機械学習の進歩、5G/6G通信、量子コンピューティングなどの新技術との融合により、さらなる発展が期待されます。特に、説明可能AI、デジタルツイン、エッジコンピューティングの活用により、より正確で信頼性の高い予測システムの実現が見込まれています。</p>
<p>気候変動による極端気象の増加に対応するため、これらの技術の社会実装を進め、防災・減災に貢献することが重要な課題です。</p>
<h2 id="_63">関連リンク<a class="headerlink" href="#_63" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.jma.go.jp/">気象庁</a></li>
<li><a href="https://wmo.int/">世界気象機関（WMO）</a></li>
<li><a href="https://www.ecmwf.int/">ECMWF</a></li>
<li><a href="https://www.ucar.edu/">UCAR/NCAR</a></li>
<li><a href="https://community.wmo.int/activity-areas/wis">WMO Information System (WIS)</a></li>
</ul>
<h2 id="_64">参考文献<a class="headerlink" href="#_64" title="Permanent link">&para;</a></h2>
<ul>
<li>WMO. (2021). Guide to Meteorological Instruments and Methods of Observation. World Meteorological Organization.</li>
<li>ECMWF. (2020). IFS Documentation. European Centre for Medium-Range Weather Forecasts.</li>
<li>Skamarock, W. C., et al. (2019). A Description of the Advanced Research WRF Model Version 4. NCAR Technical Note.</li>
<li>気象庁. (2021). 数値予報課報告・別冊第67号. 気象庁予報部.</li>
<li>国土交通省気象庁. (2020). 防災気象情報の改善に関する検討会報告書.</li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最終更新日">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年10月1日 15:35:04 JST">2025年10月1日</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="フッター" >
        
          
          <a href="../maritime-sa-software/" class="md-footer__link md-footer__link--prev" aria-label="前: 船舶関連">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                前
              </span>
              <div class="md-ellipsis">
                船舶関連
              </div>
            </div>
          </a>
        
        
          
          <a href="../medical-sa-software/" class="md-footer__link md-footer__link--next" aria-label="次: 医療関連">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                次
              </span>
              <div class="md-ellipsis">
                医療関連
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 shuji-bonji | <a href='https://creativecommons.org/licenses/by/4.0/deed.ja'>CC-BY-4.0ライセンス</a>に基づく
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/shuji-bonji/Situational-Awareness-and-Decision-Making" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.tabs", "search.suggest"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../assets/javascripts/mermaid-zoom.js"></script>
      
    
  </body>
</html>